const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FacetedDialog-B7MoHH5K.js","assets/index-CYW4W05g.js","assets/index-CGGwK_PF.css","assets/Clear-BMD7HF0c.js","assets/CloseConnectionDialog-_jbq44uu.js","assets/DeleteConnectionDialog-BMDEE0Vi.js","assets/ManageConnectionsDialog-Cp0ww_YG.js","assets/ToggleConnectionsDialog-Kn2k2Kzj.js"])))=>i.map(i=>d[i]);
import{a as C,m as L,o as w,u as E,R as d,c8 as Ke,bn as Ge,c9 as Xe,M as pe,ca as ie,cb as W,cc as Ye,cd as Me,ce as Ze,ao as F,ap as H,aq as P,T as Je,cf as Qe,cg as et,aa as we,ch as tt,ci as U,l as Oe,$ as ne,e as it,C as nt,bp as Re,_ as q,cj as rt,ck as re,a7 as at,d as st,bj as ot}from"./index-CYW4W05g.js";import{d as lt}from"./Clear-BMD7HF0c.js";let x;typeof window<"u"?x=window:typeof self<"u"?x=self:x=global;let Q=null,ee=null;const ve=20,G=x.clearTimeout,_e=x.setTimeout,X=x.cancelAnimationFrame||x.mozCancelAnimationFrame||x.webkitCancelAnimationFrame,Se=x.requestAnimationFrame||x.mozRequestAnimationFrame||x.webkitRequestAnimationFrame;X==null||Se==null?(Q=G,ee=function(e){return _e(e,ve)}):(Q=function([e,t]){X(e),G(t)},ee=function(e){const t=Se(function(){G(n),e()}),n=_e(function(){X(t),e()},ve);return[t,n]});function ct(i){let e,t,n,a,s,o,l;const h=typeof document<"u"&&document.attachEvent;if(!h){o=function(u){const m=u.__resizeTriggers__,g=m.firstElementChild,T=m.lastElementChild,b=g.firstElementChild;T.scrollLeft=T.scrollWidth,T.scrollTop=T.scrollHeight,b.style.width=g.offsetWidth+1+"px",b.style.height=g.offsetHeight+1+"px",g.scrollLeft=g.scrollWidth,g.scrollTop=g.scrollHeight},s=function(u){return u.offsetWidth!==u.__resizeLast__.width||u.offsetHeight!==u.__resizeLast__.height},l=function(u){if(u.target.className&&typeof u.target.className.indexOf=="function"&&u.target.className.indexOf("contract-trigger")<0&&u.target.className.indexOf("expand-trigger")<0)return;const m=this;o(this),this.__resizeRAF__&&Q(this.__resizeRAF__),this.__resizeRAF__=ee(function(){s(m)&&(m.__resizeLast__.width=m.offsetWidth,m.__resizeLast__.height=m.offsetHeight,m.__resizeListeners__.forEach(function(b){b.call(m,u)}))})};let c=!1,v="";n="animationstart";const y="Webkit Moz O ms".split(" ");let r="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),f="";{const u=document.createElement("fakeelement");if(u.style.animationName!==void 0&&(c=!0),c===!1){for(let m=0;m<y.length;m++)if(u.style[y[m]+"AnimationName"]!==void 0){f=y[m],v="-"+f.toLowerCase()+"-",n=r[m],c=!0;break}}}t="resizeanim",e="@"+v+"keyframes "+t+" { from { opacity: 0; } to { opacity: 0; } } ",a=v+"animation: 1ms "+t+"; "}const p=function(c){if(!c.getElementById("detectElementResize")){const v=(e||"")+".resize-triggers { "+(a||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',y=c.head||c.getElementsByTagName("head")[0],r=c.createElement("style");r.id="detectElementResize",r.type="text/css",i!=null&&r.setAttribute("nonce",i),r.styleSheet?r.styleSheet.cssText=v:r.appendChild(c.createTextNode(v)),y.appendChild(r)}};return{addResizeListener:function(c,v){if(h)c.attachEvent("onresize",v);else{if(!c.__resizeTriggers__){const y=c.ownerDocument,r=x.getComputedStyle(c);r&&r.position==="static"&&(c.style.position="relative"),p(y),c.__resizeLast__={},c.__resizeListeners__=[],(c.__resizeTriggers__=y.createElement("div")).className="resize-triggers";const f=y.createElement("div");f.className="expand-trigger",f.appendChild(y.createElement("div"));const u=y.createElement("div");u.className="contract-trigger",c.__resizeTriggers__.appendChild(f),c.__resizeTriggers__.appendChild(u),c.appendChild(c.__resizeTriggers__),o(c),c.addEventListener("scroll",l,!0),n&&(c.__resizeTriggers__.__animationListener__=function(g){g.animationName===t&&o(c)},c.__resizeTriggers__.addEventListener(n,c.__resizeTriggers__.__animationListener__))}c.__resizeListeners__.push(v)}},removeResizeListener:function(c,v){if(h)c.detachEvent("onresize",v);else if(c.__resizeListeners__.splice(c.__resizeListeners__.indexOf(v),1),!c.__resizeListeners__.length){c.removeEventListener("scroll",l,!0),c.__resizeTriggers__.__animationListener__&&(c.__resizeTriggers__.removeEventListener(n,c.__resizeTriggers__.__animationListener__),c.__resizeTriggers__.__animationListener__=null);try{c.__resizeTriggers__=!c.removeChild(c.__resizeTriggers__)}catch{}}}}}class dt extends C.Component{constructor(...e){super(...e),this.state={height:this.props.defaultHeight||0,scaledHeight:this.props.defaultHeight||0,scaledWidth:this.props.defaultWidth||0,width:this.props.defaultWidth||0},this._autoSizer=null,this._detectElementResize=null,this._parentNode=null,this._resizeObserver=null,this._timeoutId=null,this._onResize=()=>{this._timeoutId=null;const{disableHeight:t,disableWidth:n,onResize:a}=this.props;if(this._parentNode){const s=window.getComputedStyle(this._parentNode)||{},o=parseFloat(s.paddingLeft||"0"),l=parseFloat(s.paddingRight||"0"),h=parseFloat(s.paddingTop||"0"),p=parseFloat(s.paddingBottom||"0"),_=this._parentNode.getBoundingClientRect(),S=_.height-h-p,c=_.width-o-l,v=this._parentNode.offsetHeight-h-p,y=this._parentNode.offsetWidth-o-l;(!t&&(this.state.height!==v||this.state.scaledHeight!==S)||!n&&(this.state.width!==y||this.state.scaledWidth!==c))&&(this.setState({height:v,width:y,scaledHeight:S,scaledWidth:c}),typeof a=="function"&&a({height:v,scaledHeight:S,scaledWidth:c,width:y}))}},this._setRef=t=>{this._autoSizer=t}}componentDidMount(){const{nonce:e}=this.props,t=this._autoSizer?this._autoSizer.parentNode:null;if(t!=null&&t.ownerDocument&&t.ownerDocument.defaultView&&t instanceof t.ownerDocument.defaultView.HTMLElement){this._parentNode=t;const n=t.ownerDocument.defaultView.ResizeObserver;n!=null?(this._resizeObserver=new n(()=>{this._timeoutId=setTimeout(this._onResize,0)}),this._resizeObserver.observe(t)):(this._detectElementResize=ct(e),this._detectElementResize.addResizeListener(t,this._onResize)),this._onResize()}}componentWillUnmount(){this._parentNode&&(this._detectElementResize&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize),this._timeoutId!==null&&clearTimeout(this._timeoutId),this._resizeObserver&&this._resizeObserver.disconnect())}render(){const{children:e,defaultHeight:t,defaultWidth:n,disableHeight:a=!1,disableWidth:s=!1,doNotBailOutOnEmptyChildren:o=!1,nonce:l,onResize:h,style:p={},tagName:_="div",...S}=this.props,{height:c,scaledHeight:v,scaledWidth:y,width:r}=this.state,f={overflow:"visible"},u={};let m=!1;return a||(c===0&&(m=!0),f.height=0,u.height=c,u.scaledHeight=v),s||(r===0&&(m=!0),f.width=0,u.width=r,u.scaledWidth=y),o&&(m=!1),C.createElement(_,{ref:this._setRef,style:{...f,...p},...S},!m&&e(u))}}const ut=L()(i=>({fab:{position:"absolute",bottom:i.spacing(6),right:i.spacing(6)}})),ft=w(function({model:i}){const{classes:e}=ut(),t=E.getSession(i),[n,a]=C.useState(null);function s(){a(null)}const o=E.isSessionModelWithConnections(t),l=E.isSessionWithAddTracks(t);return l||o?d.createElement(d.Fragment,null,d.createElement(Ke,{color:"secondary",className:e.fab,onClick:h=>{a(h.currentTarget)}},d.createElement(Ge,null)),d.createElement(Xe,{anchorEl:n,open:!!n,onClose:()=>{a(null)}},o?d.createElement(pe,{onClick:()=>{s(),E.isSessionModelWithWidgets(t)&&t.showWidget(t.addWidget("AddConnectionWidget","addConnectionWidget"))}},"Add connection"):null,l?d.createElement(pe,{onClick:()=>{s(),E.isSessionModelWithWidgets(t)&&t.showWidget(t.addWidget("AddTrackWidget","addTrackWidget",{view:i.view.id}))}},"Add track"):null)):null});var be=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function ht(i,e){return!!(i===e||be(i)&&be(e))}function mt(i,e){if(i.length!==e.length)return!1;for(var t=0;t<i.length;t++)if(!ht(i[t],e[t]))return!1;return!0}function Y(i,e){e===void 0&&(e=mt);var t,n=[],a,s=!1;function o(){for(var l=[],h=0;h<arguments.length;h++)l[h]=arguments[h];return s&&t===this&&e(l,n)||(a=i.apply(this,l),s=!0,t=this,n=l),a}return o}var gt=typeof performance=="object"&&typeof performance.now=="function",Te=gt?function(){return performance.now()}:function(){return Date.now()};function ye(i){cancelAnimationFrame(i.id)}function pt(i,e){var t=Te();function n(){Te()-t>=e?i.call(null):a.id=requestAnimationFrame(n)}var a={id:requestAnimationFrame(n)};return a}var Z=-1;function Ie(i){if(i===void 0&&(i=!1),Z===-1||i){var e=document.createElement("div"),t=e.style;t.width="50px",t.height="50px",t.overflow="scroll",document.body.appendChild(e),Z=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return Z}var A=null;function Ce(i){if(i===void 0&&(i=!1),A===null||i){var e=document.createElement("div"),t=e.style;t.width="50px",t.height="50px",t.overflow="scroll",t.direction="rtl";var n=document.createElement("div"),a=n.style;return a.width="100px",a.height="100px",e.appendChild(n),document.body.appendChild(e),e.scrollLeft>0?A="positive-descending":(e.scrollLeft=1,e.scrollLeft===0?A="negative":A="positive-ascending"),document.body.removeChild(e),A}return A}var vt=150,_t=function(e,t){return e};function St(i){var e,t=i.getItemOffset,n=i.getEstimatedTotalSize,a=i.getItemSize,s=i.getOffsetForIndexAndAlignment,o=i.getStartIndexForOffset,l=i.getStopIndexForStartIndex,h=i.initInstanceProps,p=i.shouldResetStyleCacheOnItemSizeChange,_=i.validateProps;return e=function(S){ie(c,S);function c(y){var r;return r=S.call(this,y)||this,r._instanceProps=h(r.props,W(r)),r._outerRef=void 0,r._resetIsScrollingTimeoutId=null,r.state={instance:W(r),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof r.props.initialScrollOffset=="number"?r.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},r._callOnItemsRendered=void 0,r._callOnItemsRendered=Y(function(f,u,m,g){return r.props.onItemsRendered({overscanStartIndex:f,overscanStopIndex:u,visibleStartIndex:m,visibleStopIndex:g})}),r._callOnScroll=void 0,r._callOnScroll=Y(function(f,u,m){return r.props.onScroll({scrollDirection:f,scrollOffset:u,scrollUpdateWasRequested:m})}),r._getItemStyle=void 0,r._getItemStyle=function(f){var u=r.props,m=u.direction,g=u.itemSize,T=u.layout,b=r._getItemStyleCache(p&&g,p&&T,p&&m),I;if(b.hasOwnProperty(f))I=b[f];else{var k=t(r.props,f,r._instanceProps),M=a(r.props,f,r._instanceProps),z=m==="horizontal"||T==="horizontal",O=m==="rtl",D=z?k:0;b[f]=I={position:"absolute",left:O?void 0:D,right:O?D:void 0,top:z?0:k,height:z?"100%":M,width:z?M:"100%"}}return I},r._getItemStyleCache=void 0,r._getItemStyleCache=Y(function(f,u,m){return{}}),r._onScrollHorizontal=function(f){var u=f.currentTarget,m=u.clientWidth,g=u.scrollLeft,T=u.scrollWidth;r.setState(function(b){if(b.scrollOffset===g)return null;var I=r.props.direction,k=g;if(I==="rtl")switch(Ce()){case"negative":k=-g;break;case"positive-descending":k=T-m-g;break}return k=Math.max(0,Math.min(k,T-m)),{isScrolling:!0,scrollDirection:b.scrollOffset<k?"forward":"backward",scrollOffset:k,scrollUpdateWasRequested:!1}},r._resetIsScrollingDebounced)},r._onScrollVertical=function(f){var u=f.currentTarget,m=u.clientHeight,g=u.scrollHeight,T=u.scrollTop;r.setState(function(b){if(b.scrollOffset===T)return null;var I=Math.max(0,Math.min(T,g-m));return{isScrolling:!0,scrollDirection:b.scrollOffset<I?"forward":"backward",scrollOffset:I,scrollUpdateWasRequested:!1}},r._resetIsScrollingDebounced)},r._outerRefSetter=function(f){var u=r.props.outerRef;r._outerRef=f,typeof u=="function"?u(f):u!=null&&typeof u=="object"&&u.hasOwnProperty("current")&&(u.current=f)},r._resetIsScrollingDebounced=function(){r._resetIsScrollingTimeoutId!==null&&ye(r._resetIsScrollingTimeoutId),r._resetIsScrollingTimeoutId=pt(r._resetIsScrolling,vt)},r._resetIsScrolling=function(){r._resetIsScrollingTimeoutId=null,r.setState({isScrolling:!1},function(){r._getItemStyleCache(-1,null)})},r}c.getDerivedStateFromProps=function(r,f){return bt(r,f),_(r),null};var v=c.prototype;return v.scrollTo=function(r){r=Math.max(0,r),this.setState(function(f){return f.scrollOffset===r?null:{scrollDirection:f.scrollOffset<r?"forward":"backward",scrollOffset:r,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},v.scrollToItem=function(r,f){f===void 0&&(f="auto");var u=this.props,m=u.itemCount,g=u.layout,T=this.state.scrollOffset;r=Math.max(0,Math.min(r,m-1));var b=0;if(this._outerRef){var I=this._outerRef;g==="vertical"?b=I.scrollWidth>I.clientWidth?Ie():0:b=I.scrollHeight>I.clientHeight?Ie():0}this.scrollTo(s(this.props,r,f,T,this._instanceProps,b))},v.componentDidMount=function(){var r=this.props,f=r.direction,u=r.initialScrollOffset,m=r.layout;if(typeof u=="number"&&this._outerRef!=null){var g=this._outerRef;f==="horizontal"||m==="horizontal"?g.scrollLeft=u:g.scrollTop=u}this._callPropsCallbacks()},v.componentDidUpdate=function(){var r=this.props,f=r.direction,u=r.layout,m=this.state,g=m.scrollOffset,T=m.scrollUpdateWasRequested;if(T&&this._outerRef!=null){var b=this._outerRef;if(f==="horizontal"||u==="horizontal")if(f==="rtl")switch(Ce()){case"negative":b.scrollLeft=-g;break;case"positive-ascending":b.scrollLeft=g;break;default:var I=b.clientWidth,k=b.scrollWidth;b.scrollLeft=k-I-g;break}else b.scrollLeft=g;else b.scrollTop=g}this._callPropsCallbacks()},v.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&ye(this._resetIsScrollingTimeoutId)},v.render=function(){var r=this.props,f=r.children,u=r.className,m=r.direction,g=r.height,T=r.innerRef,b=r.innerElementType,I=r.innerTagName,k=r.itemCount,M=r.itemData,z=r.itemKey,O=z===void 0?_t:z,D=r.layout,V=r.outerElementType,N=r.outerTagName,R=r.style,je=r.useIsScrolling,Be=r.width,fe=this.state.isScrolling,K=m==="horizontal"||D==="horizontal",qe=K?this._onScrollHorizontal:this._onScrollVertical,he=this._getRangeToRender(),Ue=he[0],Ve=he[1],me=[];if(k>0)for(var j=Ue;j<=Ve;j++)me.push(C.createElement(f,{data:M,key:O(j,M),index:j,isScrolling:je?fe:void 0,style:this._getItemStyle(j)}));var ge=n(this.props,this._instanceProps);return C.createElement(V||N||"div",{className:u,onScroll:qe,ref:this._outerRefSetter,style:Ye({position:"relative",height:g,width:Be,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:m},R)},C.createElement(b||I||"div",{children:me,ref:T,style:{height:K?"100%":ge,pointerEvents:fe?"none":void 0,width:K?ge:"100%"}}))},v._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var r=this.props.itemCount;if(r>0){var f=this._getRangeToRender(),u=f[0],m=f[1],g=f[2],T=f[3];this._callOnItemsRendered(u,m,g,T)}}if(typeof this.props.onScroll=="function"){var b=this.state,I=b.scrollDirection,k=b.scrollOffset,M=b.scrollUpdateWasRequested;this._callOnScroll(I,k,M)}},v._getRangeToRender=function(){var r=this.props,f=r.itemCount,u=r.overscanCount,m=this.state,g=m.isScrolling,T=m.scrollDirection,b=m.scrollOffset;if(f===0)return[0,0,0,0];var I=o(this.props,b,this._instanceProps),k=l(this.props,I,b,this._instanceProps),M=!g||T==="backward"?Math.max(1,u):1,z=!g||T==="forward"?Math.max(1,u):1;return[Math.max(0,I-M),Math.max(0,Math.min(f-1,k+z)),I,k]},c}(C.PureComponent),e.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},e}var bt=function(e,t){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,t.instance},Tt=50,$=function(e,t,n){var a=e,s=a.itemSize,o=n.itemMetadataMap,l=n.lastMeasuredIndex;if(t>l){var h=0;if(l>=0){var p=o[l];h=p.offset+p.size}for(var _=l+1;_<=t;_++){var S=s(_);o[_]={offset:h,size:S},h+=S}n.lastMeasuredIndex=t}return o[t]},yt=function(e,t,n){var a=t.itemMetadataMap,s=t.lastMeasuredIndex,o=s>0?a[s].offset:0;return o>=n?Le(e,t,s,0,n):It(e,t,Math.max(0,s),n)},Le=function(e,t,n,a,s){for(;a<=n;){var o=a+Math.floor((n-a)/2),l=$(e,o,t).offset;if(l===s)return o;l<s?a=o+1:l>s&&(n=o-1)}return a>0?a-1:0},It=function(e,t,n,a){for(var s=e.itemCount,o=1;n<s&&$(e,n,t).offset<a;)n+=o,o*=2;return Le(e,t,Math.min(n,s-1),Math.floor(n/2),a)},ke=function(e,t){var n=e.itemCount,a=t.itemMetadataMap,s=t.estimatedItemSize,o=t.lastMeasuredIndex,l=0;if(o>=n&&(o=n-1),o>=0){var h=a[o];l=h.offset+h.size}var p=n-o-1,_=p*s;return l+_},Ct=St({getItemOffset:function(e,t,n){return $(e,t,n).offset},getItemSize:function(e,t,n){return n.itemMetadataMap[t].size},getEstimatedTotalSize:ke,getOffsetForIndexAndAlignment:function(e,t,n,a,s,o){var l=e.direction,h=e.height,p=e.layout,_=e.width,S=l==="horizontal"||p==="horizontal",c=S?_:h,v=$(e,t,s),y=ke(e,s),r=Math.max(0,Math.min(y-c,v.offset)),f=Math.max(0,v.offset-c+v.size+o);switch(n==="smart"&&(a>=f-c&&a<=r+c?n="auto":n="center"),n){case"start":return r;case"end":return f;case"center":return Math.round(f+(r-f)/2);case"auto":default:return a>=f&&a<=r?a:a<f?f:r}},getStartIndexForOffset:function(e,t,n){return yt(e,n,t)},getStopIndexForStartIndex:function(e,t,n,a){for(var s=e.direction,o=e.height,l=e.itemCount,h=e.layout,p=e.width,_=s==="horizontal"||h==="horizontal",S=_?p:o,c=$(e,t,a),v=n+S,y=c.offset+c.size,r=t;r<l-1&&y<v;)r++,y+=$(e,r,a).size;return r},initInstanceProps:function(e,t){var n=e,a=n.estimatedItemSize,s={itemMetadataMap:{},estimatedItemSize:a||Tt,lastMeasuredIndex:-1};return t.resetAfterIndex=function(o,l){l===void 0&&(l=!0),s.lastMeasuredIndex=Math.min(s.lastMeasuredIndex,o-1),t._getItemStyleCache(-1),l&&t.forceUpdate()},s},shouldResetStyleCacheOnItemSizeChange:!1,validateProps:function(e){e.itemSize}});function kt(i){return function(e){i.forEach(function(t){typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var J=function(){},Et=function(e,t){return t===void 0&&(t=null),{child:null,isShown:t?t.public.isOpen&&t.isShown:!0,parent:t,public:e,sibling:null,visited:!1}},zt=function(e,t){var n=t.getRecordData,a=n(e),s=a.data.id;return s},xt=function(e){var t=e.index,n=e.data,a=n.component,s=n.getRecordData,o=n.treeData,l=e.style,h=e.isScrolling,p=s(t);return d.createElement(a,Object.assign({isScrolling:h,style:l,treeData:o},p))},Mt=function(e,t,n){var a=e.createRecord,s=t.buildingTaskTimeout,o=t.placeholder,l=t.async,h=l===void 0?!1:l,p=t.treeWalker,_=h&&n.records!==void 0,S=n.records,c=[],v=new Map,y=s?{timeout:s}:void 0,r=new WeakMap,f=p(),u=f.next(),m=u.value,g=a(m.data,n,void 0,_?S.get(m.data.id):void 0);v.set(g.public.data.id,g),r.set(g,m);var T=g,b=!0,I=g,k=o!==void 0&&!(o===null&&!n.order),M=k?function(O){return O.timeRemaining()>0}:function(){return!0},z=function O(D){for(;T!==null;){if(!M(D)){requestIdleCallback(O,y);return}if(T.visited)T.visited=!1,T=T.sibling!==null?T.sibling:T.parent,I=T;else{var V=f.next(r.get(T)),N=V.value;if(N===void 0){b?b=!1:(T.isShown&&c.push(T.public.data.id),T.visited=T.child!==null,T=T.child!==null?T.child:T.sibling!==null?T.sibling:T.parent),I=T;continue}var R=a(N.data,n,b?void 0:T,_?S.get(N.data.id):void 0);v.set(R.public.data.id,R),r.set(R,N),!b&&I===T?I.child=R:I.sibling=R,I=R}}k&&n.setState({order:c,records:v,updateRequest:{}})};return k?requestIdleCallback(z,y):z(),o!==void 0&&h&&n.order?n:{order:c,records:v}},Ee=32768,wt=2,Ot=function(e,t){var n=e.order,a=e.records,s=t.opennessState;if(typeof s!="object")return null;for(var o in s)if(a.has(o)){var l=s[o],h=a.get(o),p=typeof l=="boolean"?{open:l}:l,_=p.open,S=p.subtreeCallback,c=S===void 0?J:S,v=J,y=J;h.isShown&&(_?function(){for(var f=n.indexOf(o),u=h;u!==null;){if(u.sibling!==null){u=u.sibling;break}u=u.parent}var m=u===null?n.length-1-f:n.indexOf(u.public.data.id)-1-f,g=[[f+1,m]];v=function(b){if(b.isShown=b.parent?b.parent.public.isOpen&&b.parent.isShown:!0,b.isShown){var I=g[g.length-1];I.push(b.public.data.id),I.length===Ee+wt&&g.push([f+1+Ee*g.length,0])}},y=function(){for(var b=0;b<g.length;b++){var I;(I=n).splice.apply(I,g[b])}}}():h.public.isOpen&&function(){var f=n.indexOf(o),u=0;v=function(g){g.isShown&&(u+=1),g.isShown=g.parent?g.parent.public.isOpen&&g.parent.isShown:!0},y=function(){n.splice(f+1,u)}}());for(var r=h;r!==null;)r.visited?(r.visited=!1,r=r===h?null:r.sibling!==null?r.sibling:r.parent):(r.public.isOpen=r===h?_:r.public.isOpen,c(r.public,h.public),r!==h&&v(r),r.visited=r.child!==null,r=r.child!==null?r.child:r===h?null:r.sibling!==null?r.sibling:r.parent);y()}return{order:n,records:a,updateRequest:{}}},Rt=function(e){return function(t,n,a){return a.refresh?Mt(e,t,n):Ot(n,a)}},We=function(i){ie(e,i),e.getDerivedStateFromProps=function(a,s){var o=a.listRef,l=o===void 0?null:o,h=a.treeWalker,p=s.computeTree,_=s.list,S=s.order,c=s.treeWalker;return Me({attachRefs:kt([_,l])},h!==c||!S?p(a,s,{refresh:!0}):null,{treeWalker:h})};function e(n,a){var s;return s=i.call(this,n,a)||this,s.getRecordData=s.getRecordData.bind(W(s)),s.state={list:C.createRef(),recomputeTree:s.recomputeTree.bind(W(s)),setState:s.setState.bind(W(s))},s}var t=e.prototype;return t.getItemData=function(){var a=this.props,s=a.children,o=a.itemData;return{component:s,getRecordData:this.getRecordData,treeData:o}},t.getRecordData=function(a){var s=this.state,o=s.order,l=s.records;return l.get(o[a]).public},t.recomputeTree=function(a){var s=this;return new Promise(function(o){s.setState(function(l){return l.computeTree(s.props,l,{opennessState:a})},o)})},t.scrollTo=function(a){var s;(s=this.state.list.current)==null||s.scrollTo(a)},t.scrollToItem=function(a,s){var o;(o=this.state.list.current)==null||o.scrollToItem(this.state.order.indexOf(a),s)},e}(C.PureComponent);We.defaultProps={rowComponent:xt};var Lt=Rt({createRecord:function(e,t,n,a){var s=t.recomputeTree,o=t.resetAfterId,l=Et({data:e,height:a?a.public.height:e.defaultHeight,isOpen:a?a.public.isOpen:e.isOpenByDefault,resize:function(p,_){l.public.height=p,o(l.public.data.id,_)},setOpen:function(p){var _;return s((_={},_[e.id]=p,_))}},n);return l}}),Wt=function(i){ie(e,i);function e(n,a){var s;return s=i.call(this,n,a)||this,s.getItemSize=s.getItemSize.bind(W(s)),s.state=Me({},s.state,{computeTree:Lt,resetAfterId:s.resetAfterId.bind(W(s))}),s}var t=e.prototype;return t.resetAfterId=function(a,s){var o;s===void 0&&(s=!1);var l=this.state,h=l.list,p=l.order;(o=h.current)==null||o.resetAfterIndex(p.indexOf(a),s)},t.recomputeTree=function(a){var s=this;return i.prototype.recomputeTree.call(this,a).then(function(){var o;(o=s.state.list.current)==null||o.resetAfterIndex(0,!0)})},t.render=function(){var a=this.props;a.children;var s=a.placeholder,o=a.itemSize,l=a.rowComponent;a.treeWalker;var h=Ze(a,["children","placeholder","itemSize","rowComponent","treeWalker"]),p=this.state,_=p.attachRefs,S=p.order;return s&&S.length===0?s:d.createElement(Ct,Object.assign({},h,{itemCount:S.length,itemData:this.getItemData(),itemKey:zt,itemSize:o??this.getItemSize,ref:_}),l)},t.getItemSize=function(a){return this.getRecordData(a).height},e}(We),ae={},Dt=H;Object.defineProperty(ae,"__esModule",{value:!0});var se=ae.default=void 0,Nt=Dt(F()),At=P;se=ae.default=(0,Nt.default)((0,At.jsx)("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreHoriz");function te(i){return(i==null?void 0:i.type)==="category"?i.children.map(e=>e.type==="category"?te(e):e.conf).flat(Number.POSITIVE_INFINITY):[]}function B(i,e=new Map){i.id&&i.children.length&&e.set(i.id,i);for(const t of i.children)B(t,e);return e}function $t(i=""){return i.endsWith("(Unsupported)")||i.endsWith("(Unknown)")}const Ft=L()(i=>({contrastColor:{color:i.palette.tertiary.contrastText},accordionText:{margin:"auto 0",width:"100%"}}));function Ht({isOpen:i,setOpen:e,data:t}){const{classes:n}=Ft(),[a,s]=C.useState(null),{menuItems:o=[],name:l,model:h,id:p,tree:_}=t;return d.createElement("div",{className:n.accordionText,onClick:()=>{a||(t.toggleCollapse(p),e(!i))}},d.createElement(Je,{"data-testid":`htsCategory-${l}`},i?d.createElement(Qe,null):d.createElement(et,null),l,d.createElement(we,{onClick:S=>{s(S.currentTarget),S.stopPropagation()},className:n.contrastColor},d.createElement(se,null))),a?d.createElement(tt,{anchorEl:a,menuItems:[{label:"Add to selection",onClick:()=>{const S=B(_).get(p);h.addToSelection(te(S))}},{label:"Remove from selection",onClick:()=>{const S=B(_).get(p);h.removeFromSelection(te(S))}},{label:"Show all tracks",onClick:()=>{var S;for(const c of((S=B(_).get(p))===null||S===void 0?void 0:S.children)||[])c.type==="track"&&h.view.showTrack(c.trackId)}},{label:"Hide all tracks",onClick:()=>{var S;for(const c of((S=B(_).get(p))===null||S===void 0?void 0:S.children)||[])c.type==="track"&&h.view.hideTrack(c.trackId)}},...o],onMenuItemClick:(S,c)=>{c(),s(null)},open:!!a,onClose:()=>{s(null)}}):null)}var oe={},Pt=H;Object.defineProperty(oe,"__esModule",{value:!0});var De=oe.default=void 0,jt=Pt(F()),Bt=P;De=oe.default=(0,jt.default)((0,Bt.jsx)("path",{d:"m22 9.24-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28z"}),"StarBorderOutlined");var le={},qt=H;Object.defineProperty(le,"__esModule",{value:!0});var Ne=le.default=void 0,Ut=qt(F()),Vt=P;Ne=le.default=(0,Ut.default)((0,Vt.jsx)("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}),"Star");const Kt=L()({cascadingStyle:{padding:0}}),Ae=function({id:i,trackId:e,stopPropagation:t,model:n,setOpen:a,conf:s}){var o,l;const{classes:h}=Kt();return d.createElement(U,{className:h.cascadingStyle,stopPropagation:t,setOpen:a,"data-testid":`htsTrackEntryMenu-${i}`,menuItems:[...((l=(o=E.getSession(n)).getTrackActionMenuItems)===null||l===void 0?void 0:l.call(o,s))||[],n.isFavorite(e)?{label:"Remove from favorites",onClick:()=>{n.removeFromFavorites(e)},icon:De}:{label:"Add to favorites",onClick:()=>{n.addToFavorites(e)},icon:Ne},{label:"Add to selection",onClick:()=>{n.addToSelection([s])}},...n.isSelected(s)?[{label:"Remove from selection",onClick:()=>{n.removeFromSelection([s])}}]:[]]},d.createElement(se,null))},Gt=L()(i=>({compactCheckbox:{padding:0},checkboxLabel:{marginRight:0,"&:hover":{backgroundColor:i.palette.action.selected}},selected:{background:"#cccc"}}));function Xt({data:i}){const{classes:e}=Gt(),{checked:t,conf:n,model:a,drawerPosition:s,id:o,trackId:l,name:h,onChange:p,selected:_}=i,S=Oe.readConfObject(n,"description");return d.createElement(d.Fragment,null,d.createElement(ne,{title:S+(_?" (in selection)":""),placement:s==="left"?"right":"left"},d.createElement(it,{className:e.checkboxLabel,control:d.createElement(nt,{className:e.compactCheckbox,checked:t,onChange:()=>{p(l)},disabled:$t(h),inputProps:{"data-testid":`htsTrackEntry-${o}`}}),label:d.createElement("div",{"data-testid":`htsTrackLabel-${o}`,style:{background:_?"#cccc":void 0}},d.createElement(Re,{html:h}))})),d.createElement(Ae,{model:a,trackId:l,id:o,conf:n}))}const Yt=L()(i=>({accordionBase:{display:"flex"},accordionCard:{padding:3,cursor:"pointer",display:"flex"},nestingLevelMarker:{position:"absolute",borderLeft:"1.5px solid #555"},accordionColor:{background:i.palette.tertiary.main,color:i.palette.tertiary.contrastText,width:"100%",display:"flex",paddingLeft:5}}));function Zt({data:i,isOpen:e,style:t,setOpen:n}){const{isLeaf:a,nestingLevel:s}=i,{classes:o}=Yt(),l=10,h=s*l+(a?l:0);return d.createElement("div",{style:t,className:a?void 0:o.accordionBase},new Array(s).fill(0).map((p,_)=>d.createElement("div",{key:`mark-${_}`,style:{left:_*l+4,height:t==null?void 0:t.height},className:o.nestingLevelMarker})),d.createElement("div",{className:a?void 0:o.accordionCard,style:{marginLeft:h,whiteSpace:"nowrap",width:"100%"}},d.createElement("div",{className:a?void 0:o.accordionColor},a?d.createElement(Xt,{data:i}):d.createElement(Ht,{isOpen:e,data:i,setOpen:n}))))}function ze(i,e,t,n){const a=i.type==="track",s=a?n[i.trackId]:!1;return{data:{defaultHeight:a?22:40,isLeaf:a,isOpenByDefault:!0,nestingLevel:e,selected:s,...i,...t},nestingLevel:e,node:i}}const xe=w(function({height:e,tree:t,model:n}){const{filterText:a,selection:s,view:o}=n,l=C.useRef(null),h=E.getSession(n),{drawerPosition:p}=h,_=C.useMemo(()=>Object.fromEntries(s.map(v=>[v.trackId,v])),[s]),S=C.useMemo(()=>({onChange:v=>{o.toggleTrack(v)&&n.addToRecentlyUsed(v)},toggleCollapse:v=>{n.toggleCategory(v)},tree:t,model:n,drawerPosition:p}),[o,n,p,t]),c=C.useCallback(function*(){for(const y of t.children)yield ze(y,0,S,_);for(;;){const y=yield;for(const r of y.node.children)yield ze(r,y.nestingLevel+1,S,_)}},[t,S,_]);return C.useEffect(()=>{l.current.recomputeTree({refreshNodes:!0,useDefaultHeight:!0})},[t,a]),d.createElement(d.Fragment,null,d.createElement(Wt,{ref:l,treeWalker:c,height:e},Zt))}),Jt=C.lazy(()=>q(()=>import("./FacetedDialog-B7MoHH5K.js"),__vite__mapDeps([0,1,2,3]))),Qt=C.lazy(()=>q(()=>import("./CloseConnectionDialog-_jbq44uu.js"),__vite__mapDeps([4,1,2]))),ei=C.lazy(()=>q(()=>import("./DeleteConnectionDialog-BMDEE0Vi.js"),__vite__mapDeps([5,1,2]))),ti=C.lazy(()=>q(()=>import("./ManageConnectionsDialog-Cp0ww_YG.js"),__vite__mapDeps([6,1,2]))),ii=C.lazy(()=>q(()=>import("./ToggleConnectionsDialog-Kn2k2Kzj.js"),__vite__mapDeps([7,1,2]))),ni=w(function({model:i}){const e=E.getSession(i),[t,n]=C.useState(),[a,s]=C.useState(),[o,l]=C.useState(!1),[h,p]=C.useState(!1),[_,S]=C.useState(!1);function c(v,y){var r;const f=Oe.readConfObject(v,"name"),u=(r=e.prepareToBreakConnection)===null||r===void 0?void 0:r.call(e,v);if(u){const[m,g]=u;Object.keys(g).length>0?n({connectionConf:v,safelyBreakConnection:m,dereferenceTypeCount:g,name:f}):m()}y&&s({name:f,connectionConf:v})}return d.createElement(d.Fragment,null,d.createElement(U,{menuItems:[{label:"Open faceted track selector",onClick:()=>{S(!0)}},...E.isSessionWithAddTracks(e)?[{label:"Add track...",onClick:()=>{E.isSessionModelWithWidgets(e)&&e.showWidget(e.addWidget("AddTrackWidget","addTrackWidget",{view:i.view.id}))}}]:[],{label:"Connections...",subMenu:[...E.isSessionModelWithConnections(e)?[{label:"Turn on/off connections...",onClick:()=>{l(!0)}}]:[],...E.isSessionModelWithConnectionEditing(e)?[{label:"Add connection...",onClick:()=>{E.isSessionModelWithWidgets(e)&&e.showWidget(e.addWidget("AddConnectionWidget","addConnectionWidget"))}},{label:"Delete connections...",onClick:()=>{p(!0)}}]:[]]},{label:"Sort...",type:"subMenu",subMenu:[{label:"Sort tracks by name",type:"checkbox",checked:i.activeSortTrackNames,onClick:()=>{i.setSortTrackNames(!i.activeSortTrackNames)}},{label:"Sort categories by name",type:"checkbox",checked:i.activeSortCategories,onClick:()=>{i.setSortCategories(!i.activeSortCategories)}}]},{label:"Collapse...",type:"subMenu",subMenu:[...i.hasAnySubcategories?[{label:"Collapse subcategories",onClick:()=>{i.collapseSubCategories()}}]:[],{label:"Collapse top-level categories",onClick:()=>{i.collapseTopLevelCategories()}},{label:"Expand all categories",onClick:()=>{i.expandAllCategories()}}]}]},d.createElement(rt,null)),d.createElement(C.Suspense,{fallback:null},t?d.createElement(Qt,{modalInfo:t,onClose:()=>{n(void 0)}}):null,a?d.createElement(ei,{handleClose:()=>{s(void 0)},deleteDialogDetails:a,session:e}):null,h?d.createElement(ti,{handleClose:()=>{p(!1)},breakConnection:c,session:e}):null,o?d.createElement(ii,{handleClose:()=>{l(!1)},session:e,breakConnection:c}):null,_?d.createElement(Jt,{handleClose:()=>{S(!1)},model:i}):null))});var ce={},ri=H;Object.defineProperty(ce,"__esModule",{value:!0});var $e=ce.default=void 0,ai=ri(F()),si=P;$e=ce.default=(0,ai.default)((0,si.jsx)("path",{d:"M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2M1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2"}),"ShoppingCart");const oi=w(function({model:i}){const{selection:e}=i,{pluginManager:t}=E.getEnv(i),n=E.getSession(i),a=t.evaluateExtensionPoint("TrackSelector-multiTrackMenuItems",[],{session:n});return e.length?d.createElement(U,{menuItems:[{label:"Clear",onClick:()=>{i.clearSelection()}},...a.map(s=>({...s,..."onClick"in s?{onClick:()=>{s.onClick(i)}}:{}}))]},d.createElement(re,{badgeContent:e.length,color:"primary"},d.createElement($e,null))):null});var de={},li=H;Object.defineProperty(de,"__esModule",{value:!0});var Fe=de.default=void 0,ci=li(F()),di=P;Fe=de.default=(0,ci.default)((0,di.jsx)("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}),"Grade");const He=w(function({model:i,tracks:e,extraMenuItems:t,children:n,onClick:a}){const{view:s}=i,[o,l]=C.useState(!1),h=E.getSession(i);return s?d.createElement(U,{closeAfterItemClick:!1,onClick:a,menuItems:[...e.map(p=>({type:"checkbox",label:d.createElement(d.Fragment,null,d.createElement(Re,{html:at.getTrackName(p,h)})," ",d.createElement(Ae,{id:p.trackId,trackId:p.trackId,model:i,conf:p,setOpen:l,stopPropagation:!0})),checked:s.tracks.some(_=>_.configuration===p),onClick:()=>{o||i.view.toggleTrack(p.trackId)&&i.addToRecentlyUsed(p.trackId)}})),...t]},n):null}),ui=L()({smallBadge:{height:14},margin:{marginRight:10}}),fi=w(function({model:i}){const{classes:e}=ui(),{view:t,favoriteTracks:n}=i;return t?d.createElement(He,{onClick:()=>{i.setFavoritesCounter(0)},tracks:n,model:i,extraMenuItems:n.length?[{type:"divider"},{label:"Clear favorites",onClick:()=>{i.clearFavorites()}}]:[{label:"No favorite tracks yet",onClick:()=>{}}]},d.createElement(ne,{title:"Favorite tracks"},d.createElement(re,{classes:{badge:e.smallBadge},color:"secondary",anchorOrigin:{vertical:"bottom",horizontal:"right"},className:e.margin,badgeContent:i.favoritesCounter},d.createElement(Fe,null)))):null});var ue={},hi=H;Object.defineProperty(ue,"__esModule",{value:!0});var Pe=ue.default=void 0,mi=hi(F()),gi=P;Pe=ue.default=(0,mi.default)((0,gi.jsx)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"}),"History");const pi=L()({smallBadge:{height:14}}),vi=w(function({model:i}){const{classes:e}=pi(),{view:t,recentlyUsedCounter:n,recentlyUsedTracks:a}=i;return t?d.createElement(He,{onClick:()=>{i.setRecentlyUsedCounter(0)},model:i,tracks:a,extraMenuItems:a.length?[{type:"divider"},{label:"Clear recently used",onClick:()=>{i.clearRecentlyUsed()}}]:[{label:"No recently used",onClick:()=>{}}]},d.createElement(ne,{title:"Recently used tracks"},d.createElement(re,{classes:{badge:e.smallBadge},anchorOrigin:{vertical:"bottom",horizontal:"right"},color:"secondary",badgeContent:n},d.createElement(Pe,null)))):null}),_i=L()(i=>({searchBox:{margin:i.spacing(2)}})),Si=w(function({model:i}){const{filterText:e}=i,{classes:t}=_i();return d.createElement(st,{className:t.searchBox,label:"Filter tracks",value:e,onChange:n=>{i.setFilterText(n.target.value)},fullWidth:!0,InputProps:{endAdornment:d.createElement(ot,{position:"end"},d.createElement(we,{onClick:()=>{i.clearFilterText()}},d.createElement(lt,null)))}})}),bi=w(function({model:i,setHeaderHeight:e}){return d.createElement("div",{ref:t=>{e((t==null?void 0:t.getBoundingClientRect().height)||0)},"data-testid":"hierarchical_track_selector"},d.createElement("div",{style:{display:"flex"}},d.createElement(ni,{model:i}),d.createElement(oi,{model:i}),d.createElement(Si,{model:i}),d.createElement(vi,{model:i}),d.createElement(fi,{model:i})))}),Ti=({tree:i,model:e,offset:t})=>typeof jest>"u"?d.createElement(dt,{disableWidth:!0},n=>d.createElement(xe,{height:(n.height||t)-t,model:e,tree:i})):d.createElement(xe,{height:9e3,model:e,tree:i}),yi=({overrideDimensions:i,children:e})=>i?d.createElement("div",{style:{...i}},e):e,Ii=w(function({model:i,toolbarHeight:e,overrideDimensions:t}){return d.createElement(yi,{overrideDimensions:t},d.createElement(Ci,{model:i,toolbarHeight:e}),d.createElement(ft,{model:i}))}),Ci=w(function({model:i,toolbarHeight:e=0}){const[t,n]=C.useState(0);return d.createElement(d.Fragment,null,d.createElement(bi,{model:i,setHeaderHeight:n}),d.createElement(Ti,{tree:i.hierarchy,model:i,offset:e+t}))}),zi=Object.freeze(Object.defineProperty({__proto__:null,default:Ii},Symbol.toStringTag,{value:"Module"}));export{zi as H,oi as S,Ae as T};
//# sourceMappingURL=HierarchicalTrackSelector-CSsoPFbs.js.map
