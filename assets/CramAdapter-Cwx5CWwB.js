var IA=Object.defineProperty;var CA=(r,e,t)=>e in r?IA(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Le=(r,e,t)=>CA(r,typeof e!="symbol"?e+"":e,t);import{z as it,aT as uA,ay as P,cl as BA,bs as It,bt as QA,aN as EA,aJ as wA,I as vA,Q as Ct,K as mA,N as yA,u as W,O as pA}from"./index-Do-r7xR6.js";import{c as SA}from"./crc32-DkJB1gsa.js";import{r as DA}from"./___vite-browser-external_commonjs-proxy-Dg81o1zy.js";const M={CRAM_FLAG_PRESERVE_QUAL_SCORES:1,CRAM_FLAG_DETACHED:2,CRAM_FLAG_MATE_DOWNSTREAM:4,CRAM_FLAG_NO_SEQ:8,CRAM_FLAG_MASK:15,CRAM_M_REVERSE:1,CRAM_M_UNMAP:2,BAM_FPAIRED:1,BAM_FPROPER_PAIR:2,BAM_FUNMAP:4,BAM_FMUNMAP:8,BAM_FREVERSE:16,BAM_FMREVERSE:32,BAM_FREAD1:64,BAM_FREAD2:128,BAM_FSECONDARY:256,BAM_FQCFAIL:512,BAM_FDUP:1024,BAM_FSUPPLEMENTARY:2048,BAM_CMATCH:0,BAM_CINS:1,BAM_CDEL:2,BAM_CREF_SKIP:3,BAM_CSOFT_CLIP:4,BAM_CHARD_CLIP:5,BAM_CPAD:6,BAM_CEQUAL:7,BAM_CDIFF:8,BAM_CBACK:9,BAM_CIGAR_STR:"MIDNSHP:XB",BAM_CIGAR_SHIFT:4,BAM_CIGAR_MASK:15,BAM_CIGAR_TYPE:246183};function _A(r,e){if(!r.lengthOnRef&&!r.readLength||r.isUnknownBases())return null;const t=r.alignmentStart-e.start;if(!r.readFeatures)return e.seq.slice(t,t+(r.lengthOnRef||0)).toUpperCase();let A="",n=t,a=0;for(;A.length<r.readLength;)if(a<r.readFeatures.length){const o=r.readFeatures[a];if(o.code==="Q"||o.code==="q")a+=1;else if(o.pos===A.length+1)if(a+=1,o.code==="b"){const i=o.data;A+=i,n+=i.length}else o.code==="B"?(A+=o.data[0],n+=1):o.code==="X"?(A+=o.sub,n+=1):o.code==="I"?A+=o.data:o.code==="D"?n+=o.data:o.code==="i"?A+=o.data:o.code==="N"?n+=o.data:o.code==="S"?A+=o.data:o.code==="P"||o.code;else if(a<r.readFeatures.length){const i=e.seq.slice(n,n+o.pos-A.length-1);A+=i,n+=i.length}}else{const o=e.seq.slice(n,n+r.readLength-A.length);A+=o,n+=o.length}return A.toUpperCase()}const RA={a:0,A:0,c:1,C:1,g:2,G:2,t:3,T:3,n:4,N:4};function NA(r,e,t,A){const n=A.refPos-e.start,a=e.seq.charAt(n);a&&(A.ref=a);let o=RA[a];o===void 0&&(o=4);const g=t.substitutionMatrix[o][A.data];g&&(A.sub=g)}const kA=[[1,"Paired"],[2,"ProperlyPaired"],[4,"SegmentUnmapped"],[8,"MateUnmapped"],[16,"ReverseComplemented"],[32,"MateReverseComplemented"],[64,"Read1"],[128,"Read2"],[256,"Secondary"],[512,"FailedQc"],[1024,"Duplicate"],[2048,"Supplementary"]],FA=[[1,"PreservingQualityScores"],[2,"Detached"],[4,"WithMateDownstream"],[8,"DecodeSequenceAsStar"]],MA=[[1,"OnNegativeStrand"],[2,"Unmapped"]];function ot(r){const e={};for(const[t,A]of r)e[`is${A}`]=n=>!!(n&t),e[`set${A}`]=n=>n|t;return e}const Ue=ot(kA),ae=ot(FA),ut=ot(MA);class qA{constructor({flags:e,cramFlags:t,readLength:A,mappingQuality:n,lengthOnRef:a,qualityScores:o,mateRecordNumber:i,readBases:g,readFeatures:c,mateToUse:s,readGroupId:f,readName:l,sequenceId:d,uniqueId:C,templateSize:h,alignmentStart:I,tags:u}){this.flags=e,this.cramFlags=t,this.readLength=A,this.mappingQuality=n,this.lengthOnRef=a,this.qualityScores=o,g&&(this.readBases=g),this.readGroupId=f,this.readName=l,this.sequenceId=d,this.uniqueId=C,this.templateSize=h,this.alignmentStart=I,this.tags=u,c&&(this.readFeatures=c),s&&(this.mate={flags:s.mateFlags,readName:s.mateReadName,sequenceId:s.mateSequenceId,alignmentStart:s.mateAlignmentStart}),i&&(this.mateRecordNumber=i)}isPaired(){return!!(this.flags&M.BAM_FPAIRED)}isProperlyPaired(){return!!(this.flags&M.BAM_FPROPER_PAIR)}isSegmentUnmapped(){return!!(this.flags&M.BAM_FUNMAP)}isMateUnmapped(){return!!(this.flags&M.BAM_FMUNMAP)}isReverseComplemented(){return!!(this.flags&M.BAM_FREVERSE)}isMateReverseComplemented(){return!!(this.flags&M.BAM_FMREVERSE)}isRead1(){return!!(this.flags&M.BAM_FREAD1)}isRead2(){return!!(this.flags&M.BAM_FREAD2)}isSecondary(){return!!(this.flags&M.BAM_FSECONDARY)}isFailedQc(){return!!(this.flags&M.BAM_FQCFAIL)}isDuplicate(){return!!(this.flags&M.BAM_FDUP)}isSupplementary(){return!!(this.flags&M.BAM_FSUPPLEMENTARY)}isDetached(){return!!(this.cramFlags&M.CRAM_FLAG_DETACHED)}hasMateDownStream(){return!!(this.cramFlags&M.CRAM_FLAG_MATE_DOWNSTREAM)}isPreservingQualityScores(){return!!(this.cramFlags&M.CRAM_FLAG_PRESERVE_QUAL_SCORES)}isUnknownBases(){return!!(this.cramFlags&M.CRAM_FLAG_NO_SEQ)}getReadBases(){if(!this.readBases&&this._refRegion){const e=_A(this,this._refRegion);e&&(this.readBases=e)}return this.readBases}getPairOrientation(){if(!this.isSegmentUnmapped()&&this.isPaired()&&!this.isMateUnmapped()&&this.mate&&this.sequenceId===this.mate.sequenceId){const e=this.isReverseComplemented()?"R":"F",t=this.isMateReverseComplemented()?"R":"F";let A=" ",n=" ";this.isRead1()?(A="1",n="2"):this.isRead2()&&(A="2",n="1");const a=[];let o=this.templateLength||this.templateSize;if(o===void 0)throw new Error("One of templateSize and templateLength must be set");return this.alignmentStart>this.mate.alignmentStart&&o>0&&(o=-o),o>0?(a[0]=e,a[1]=A,a[2]=t,a[3]=n):(a[2]=e,a[3]=A,a[0]=t,a[1]=n),a.join("")}return null}addReferenceSequence(e,t){this.readFeatures&&this.readFeatures.forEach(A=>{A.code==="X"&&NA(this,e,t,A)}),!this.readBases&&e.start<=this.alignmentStart&&e.end>=this.alignmentStart+(this.lengthOnRef||this.readLength)-1&&(this._refRegion=e)}toJSON(){const e={};return Object.keys(this).forEach(t=>{t.startsWith("_")||(e[t]=this[t])}),e.readBases=this.getReadBases(),e}}var ue=class{constructor(e,t=0,A=0){A!=0?(this.buf=Buffer.allocUnsafe(A),this.length=A):(this.buf=e,this.length=e.length),this.pos=t}EOF(){return this.pos>=this.length}ReadData(e){var t=this.buf.slice(this.pos,this.pos+e);return this.pos+=e,t}ReadByte(){const e=this.buf[this.pos];return this.pos++,e}ReadChar(){const e=this.buf[this.pos];return this.pos++,String.fromCharCode(e)}ReadUint16(){var e=this.ReadByte();return e|=this.ReadByte()<<8,e}ReadUint32(){const e=this.buf.readInt32LE(this.pos);return this.pos+=4,e}ReadString(){var e="";do{var t=this.buf[this.pos++];t&&(e+=String.fromCharCode(t))}while(t);return e}ReadUint7(){var e=0;do{var t=this.ReadByte();e=e<<7|t&127}while(t&128);return e}ReadITF8(){var e=this.buf[this.pos];return this.pos++,e>=240?(e=(e&15)<<28,e+=(this.buf[this.pos+0]<<20)+(this.buf[this.pos+1]<<12)+(this.buf[this.pos+2]<<4)+(this.buf[this.pos+3]>>4),this.pos+=4):e>=224?(e=(e&15)<<24,e+=(this.buf[this.pos+0]<<16)+(this.buf[this.pos+1]<<8)+(this.buf[this.pos+2]<<0),this.pos+=3):e>=192?(e=(e&31)<<16,e+=(this.buf[this.pos+0]<<8)+(this.buf[this.pos+1]<<0),this.pos+=2):e>=128&&(e=(e&63)<<8,e+=this.buf[this.pos],this.pos++),e}WriteByte(e){this.buf[this.pos++]=e}WriteChar(e){this.buf[this.pos++]=e.charCodeAt(0)}WriteString(e){for(var t=0;t<e.length;t++)this.buf[this.pos++]=e.charCodeAt(t);this.buf[this.pos++]=0}WriteData(e,t){for(var A=0;A<t;A++)this.buf[this.pos++]=e[A]}WriteStream(e){this.WriteData(e.buf,e.pos)}WriteUint16(e){this.WriteByte(e&255),this.WriteByte(e>>8&255)}WriteUint32(e){this.buf.writeInt32LE(e,this.pos),this.pos+=4}WriteUint7(e){var t=0,A=e;do t+=7,A>>=7;while(A>0);do t-=7,this.WriteByte((e>>t&127)+((t>0)<<7));while(t>0)}WriteITF8(e){e<0&&(e=1+e),e<=127?this.buf[this.pos++]=e:e<=16383?(this.buf[this.pos++]=128|Math.floor(e/256),this.buf[this.pos++]=e&255):e<131071?(this.buf[this.pos++]=192|Math.floor(e/65536),this.buf[this.pos++]=Math.floor(e/256)&255,this.buf[this.pos++]=e&255):e<268435455?(this.buf[this.pos++]=224|Math.floor(e/16777216),this.buf[this.pos++]=Math.floor(e/65536)&255,this.buf[this.pos++]=Math.floor(e/256)&255,this.buf[this.pos++]=e&255):(this.buf[this.pos++]=240|Math.floor(e/268435456),this.buf[this.pos++]=Math.floor(e/1048576)&255,this.buf[this.pos++]=Math.floor(e/4096)&255,this.buf[this.pos++]=Math.floor(e/4)&255,this.buf[this.pos++]=e&15)}WriteByteNeg(e){this.buf[--this.pos]=e}};const ge=ue;function Ge(r){return r&4095}function bA(r,e){for(var t=0;e>=r[t+1];)t++;return t}function Rt(r){for(var e=new Array(4096),t=0,A=0;A<4096;A++){for(;A>=r[t+1];)t++;e[A]=t}return e}function Je(r,e,t){return t*(r>>12)+(r&4095)-e}function We(r,e){for(;e<1<<23;)e=(e<<8)+r.ReadByte();return e}function Nt(){return 1<<23}function kt(r,e){e.WriteByteNeg(r>>24&255),e.WriteByteNeg(r>>16&255),e.WriteByteNeg(r>>8&255),e.WriteByteNeg(r>>0&255)}function xA(r,e,t,A){for(var n=(8388608>>A<<8)*t;r>=n;)e.WriteByteNeg(r&255),r>>=8;return r}function ye(r,e,t,A,n){return r=xA(r,e,A,n),r=(Math.floor(r/A)<<n)+r%A+t,r}function LA(r){var e=new ge(r),t=e.ReadByte();e.ReadUint32();var A=e.ReadUint32();return t==0?HA(e,A):JA(e,A)}function UA(r,e){return e==0?OA(r):KA(r)}function Ft(r,e,t){for(var A=0;A<256;A++)e[A]=0;var n=r.ReadByte(),a=n,o=0;do{var i=r.ReadITF8();e[n]=i,o>0?(o--,n++):(n=r.ReadByte(),n==a+1&&(o=r.ReadByte())),a=n}while(n!=0);t[0]=0;for(var A=0;A<=255;A++)t[A+1]=t[A]+e[A]}function HA(r,e){var t=new Array(256),A=new Array(256);Ft(r,t,A);for(var n=Rt(A),a=new Array(4),o=0;o<4;o++)a[o]=r.ReadUint32();for(var i=new Buffer.allocUnsafe(e),o=0;o<e;o++){var g=o%4,c=Ge(a[g]),s=n[c];i[o]=s,a[g]=Je(a[g],A[s],t[s]),a[g]=We(r,a[g])}return i}function PA(r,e){for(var t=0;t<256;t++)e[t]=0;for(var t=0;t<r.length;t++)e[r[t]]++}function Mt(r){for(var e=0,t=0;t<256;t++)e+=r[t];const A=4096;var n=A/e;do{var a=0,o=0,i=0;e=0;for(var t=0;t<256;t++)r[t]!=0&&(a<r[t]&&(a=r[t],o=t),r[t]=Math.floor(r[t]*n),r[t]==0&&(r[t]=1),e+=r[t]);e<A?r[o]+=A-e:e-A<r[o]/2&&r[o]>2?r[o]-=e-A:e!=A&&(n=n*.99,i=1)}while(i)}function qt(r,e){for(var t=0,A=0;A<256;A++)if(e[A]){if(t>0)t--;else if(r.WriteByte(A),A>0&&e[A-1]>0){for(t=A+1;t<256&&e[t];t++);t-=A+1,r.WriteByte(t)}r.WriteITF8(e[A])}r.WriteByte(0)}function OA(r){const e=r.length;var t=new ge("",0,257*3+9);t.WriteByte(0),t.WriteUint32(0),t.WriteUint32(0);var A=new Array(256);PA(r,A),Mt(A),qt(t,A);var n=new Array(256);n[0]=0;for(var a=1;a<256;a++)n[a]=n[a-1]+A[a-1];for(var o=new Array(4),a=0;a<4;a++)o[a]=Nt();for(var i=Math.floor(e*1.05+100),g=new ge("",i,i),a=e-1;a>=0;a--)o[a%4]=ye(o[a%4],g,n[r[a]],A[r[a]],12);for(var a=3;a>=0;a--)kt(o[a],g);var c=t.pos;return t.buf.writeInt32LE(c-9+(g.length-g.pos),1),t.buf.writeInt32LE(e,5),Buffer.concat([t.buf.slice(0,t.pos),g.buf.slice(g.pos,g.length)],t.pos+g.length-g.pos)}function GA(r,e,t){for(var A=0;A<256;A++){e[A]=new Array(256),t[A]=new Array(256);for(var n=0;n<256;n++)e[A][n]=0}var a=r.ReadByte(),o=a,i=0;do Ft(r,e[a],t[a]),i>0?(i--,a++):(a=r.ReadByte(),a==o+1&&(i=r.ReadByte())),o=a;while(a!=0)}function JA(r,e){var t=new Array(256),A=new Array(256);GA(r,t,A);for(var n=new Array(256),a=0;a<256;a++)n[a]=Rt(A[a]);for(var o=new Array(4),i=new Array(4),g=0;g<4;g++)o[g]=r.ReadUint32(),i[g]=0;for(var c=new Buffer.allocUnsafe(e),s=Math.floor(e/4),a=0;a<s;a++)for(var g=0;g<4;g++){var f=Ge(o[g]),l=n[i[g]][f];c[a+g*s]=l,o[g]=Je(o[g],A[i[g]][l],t[i[g]][l]),o[g]=We(r,o[g]),i[g]=l}for(a=4*a;a<e;){var f=Ge(o[3]),l=bA(A[i[3]],f);c[a++]=l,o[3]=Je(o[3],A[i[3]][l],t[i[3]][l]),o[3]=We(r,o[3]),i[3]=l}return c}function WA(r,e,t){for(var A=0;A<256;A++){t[A]=0;for(var n=0;n<256;n++)e[A][n]=0}for(var a=0,A=0;A<r.length;A++)t[r[A]]++,e[a][r[A]]++,a=r[A];e[0][r[1*(r.length>>2)]]++,e[0][r[2*(r.length>>2)]]++,e[0][r[3*(r.length>>2)]]++,t[0]+=3}function TA(r,e){for(var t=0;t<256;t++)e[t]&&Mt(r[t])}function YA(r,e,t){for(var A=0,n=0;n<256;n++)if(t[n]){if(A>0)A--;else if(r.WriteByte(n),n>0&&t[n-1]>0){for(A=n+1;A<256&&t[A];A++);A-=n+1,r.WriteByte(A)}qt(r,e[n])}r.WriteByte(0)}function KA(r){const e=r.length;var t=new ge("",0,257*257*3+9);t.WriteByte(1),t.WriteUint32(0),t.WriteUint32(0);for(var A=new Array(256),n=new Array(256),a=new Array(256),o=0;o<256;o++)n[o]=new Array(256),a[o]=new Array(256);WA(r,n,A),TA(n,A),YA(t,n,A);for(var o=0;o<256;o++)if(A[o]){a[o][0]=0;for(var i=1;i<256;i++)a[o][i]=a[o][i-1]+n[o][i-1]}for(var g=new Array(4),c=new Array(4),i=0;i<4;i++)g[i]=Nt(),c[i]=0;for(var s=new ge("",e,e),f=Math.floor(e/4),l=new Array(4),d=new Array(4),i=0;i<4;i++)l[i]=(i+1)*f-2,d[i]=r[l[i]+1];d[3]=r[e-1];for(var o=e-2;o>4*f-2;o--)g[3]=ye(g[3],s,a[r[o]][d[3]],n[r[o]][d[3]],12),d[3]=r[o];for(;l[0]>=0;)for(var i=3;i>=0;i--){var C=r[l[i]];g[i]=ye(g[i],s,a[C][d[i]],n[C][d[i]],12),d[i]=C,l[i]--}for(var i=3;i>=0;i--)g[i]=ye(g[i],s,a[0][d[i]],n[0][d[i]],12);for(var o=3;o>=0;o--)kt(g[o],s);var h=t.pos;return t.buf.writeInt32LE(h-9+(s.length-s.pos),1),t.buf.writeInt32LE(e,5),Buffer.concat([t.buf.slice(0,t.pos),s.buf.slice(s.pos,s.length)],t.pos+s.length-s.pos)}var zA={decode:LA,encode:UA};const x=ue;function Te(r,e){return r&(1<<e)-1}function $A(r,e){for(var t=0;e>=r[t+1];)t++;return t}function bt(r,e){for(var t=1<<e,A=new Array(t),n=0,a=0;a<t;a++){for(;a>=r[n+1];)n++;A[a]=n}return A}function Ye(r,e,t,A){return t*(r>>A)+(r&(1<<A)-1)-e}function Ke(r,e){return e<32768&&(e=(e<<16)+r.ReadUint16()),e}function xt(){return 32768}function Lt(r,e){e.WriteByteNeg(r>>24&255),e.WriteByteNeg(r>>16&255),e.WriteByteNeg(r>>8&255),e.WriteByteNeg(r>>0&255)}function VA(r,e,t,A){for(var n=(1<<31-A)*t;r>=n;)e.WriteByteNeg(r>>8&255),e.WriteByteNeg(r&255),r>>=16;return r}function pe(r,e,t,A,n){return r=VA(r,e,A,n),r=(Math.floor(r/A)<<n)+r%A+t,r}function XA(r){for(var e=new Array(256),t=0;t<256;t++)e[t]=0;for(var A=-1,t=0;t<r.length;t++)e[r[t]]+=r[t]==A?1:-1,A=r[t];for(var n=0,t=0;t<256;t++)e[t]>0&&n++;n||(n=1,e[0]=1);var s=new x("",0,n+1+r.length);s.WriteByte(n);for(var t=0;t<256;t++)e[t]>0&&s.WriteByte(t);for(var a=new Buffer.allocUnsafe(r.length),o=0,t=0;t<r.length;t++)if(a[o++]=r[t],e[r[t]]>0){A=r[t];for(var i=0;t+i+1<r.length&&r[t+i+1]==A;)i++;s.WriteUint7(i),t+=i}var g=ct(s.buf.slice(0,s.pos)),c=new x("",0,16);c.WriteUint7(s.pos*2),c.WriteUint7(o),c.WriteUint7(g.length);var s=Buffer.concat([c.buf.slice(0,c.pos),g]);return[s,a.slice(0,o)]}function ZA(r){var e=r.ReadUint7(),t=r.ReadUint7();if(e&1)var n=r.ReadData((e-1)/2);else{var A=r.ReadUint7(),n=r.ReadData(A);n=st(new x(n),e/2)}var n=new x(n),a=new Array(256),o=n.ReadByte();o==0&&(o=256);for(var i=0;i<o;i++)a[n.ReadByte()]=1;return[a,n,t]}function jA(r,e,t,A){new x(r);for(var n=new Buffer.allocUnsafe(A),a=0,o=0;a<A;o++){var i=r[o];if(e[i])for(var g=t.ReadUint7(),c=0;c<=g;c++)n[a++]=i;else n[a++]=i}return n}function er(r){for(var e=new Array(256),t=0;t<256;t++)e[t]=0;for(var t=0;t<r.length;t++)e[r[t]]++;for(var A=new Array(256),n=0,t=0;t<256;t++)e[t]>0&&(A[t]=n++);if(!(n>16)){if(n<=1)var a=new Buffer.allocUnsafe(0);else if(n<=2){var a=new Buffer.allocUnsafe(Math.ceil(r.length/8)),i=-1;for(t=0;t<r.length;t++)t%8==0&&(a[++i]=0),a[i]+=A[r[t]]<<t%8}else if(n<=4){var a=new Buffer.allocUnsafe(Math.ceil(r.length/4)),i=-1;for(t=0;t<r.length;t++)t%4==0&&(a[++i]=0),a[i]+=A[r[t]]<<t%4*2}else{var a=new Buffer.allocUnsafe(Math.ceil(r.length/2)),i=-1;for(t=0;t<r.length;t++)t%2==0&&(a[++i]=0),a[i]+=A[r[t]]<<t%2*4}var o=new x("",0,n+5);o.WriteByte(n);for(var i=0,t=0;t<256;t++)e[t]>0&&(e[t]=i++,o.WriteByte(t));return o.WriteUint7(a.length),[o.buf.slice(0,o.pos),a]}}function tr(r){for(var e=r.ReadByte(),t=new Array(e),A=0;A<e;A++)t[A]=r.ReadByte();var n=r.ReadUint7();return[t,e,n]}function Ar(r,e,t,A){var n=new Buffer.allocUnsafe(A),a=0;if(t<=1)for(var o=0;o<A;o++)n[o]=e[0];else if(t<=2)for(o=0;o<A;o++){if(o%8==0)var i=r[a++];n[o]=e[i&1],i>>=1}else if(t<=4)for(o=0;o<A;o++){if(o%4==0)var i=r[a++];n[o]=e[i&3],i>>=2}else if(t<=16)for(o=0;o<A;o++){if(o%2==0)var i=r[a++];n[o]=e[i&15],i>>=4}return n}function rr(r,e,t){t==0&&(t=4);for(var A=new Array(t),n=new Array(t),a=0;a<t;a++)n[a]=Math.floor(e.length/t)+(e.length%t>a),A[a]=new Array(n[a]);for(var o=0,i=0;i<e.length;i+=t,o++)for(var g=0;g<t;g++)o<A[g].length&&(A[g][o]=e[i+g]);for(var c=new Array(t),s=0,a=0;a<t;a++){var f=ze(A[a],0),l=ze(A[a],1);c[a]=l.length<f.length?l:f,s+=c[a].length}var d=new x("",0,s+5*t+1);d.WriteByte(t);for(var a=0;a<t;a++)d.WriteUint7(c[a].length);for(var a=0;a<t;a++)d.WriteData(c[a],c[a].length);return d.buf.slice(0,d.buf.pos)}function nr(r,e){for(var t=r.ReadByte(),A=new Array(t),n=new Array(t),a=0;a<t;a++)A[a]=r.ReadUint7();for(var o=new Array(t),a=0;a<t;a++)n[a]=Math.floor(e/t)+(e%t>a),o[a]=Ut(r,n[a]);for(var i=new Buffer.allocUnsafe(e),a=0;a<t;a++)for(var g=0;g<n[a];g++)i[g*t+a]=o[a][g];return i}function ar(r){var e=new x(r);return Ut(e,0)}function Ut(r,e){var t=r.ReadByte(),A=t&1,n=t&8,a=t&16,o=t&32,i=t&64,g=t&128;if(a||(e=r.ReadUint7()),n)return nr(r,e);if(g)var c=e,[s,f,e]=tr(r);if(i)var l=e,[d,C,e]=ZA(r);if(o)var h=r.ReadData(e);else if(A==0)var h=st(r,e);else var h=cr(r,e);return i&&(h=jA(h,d,C,l)),g&&(h=Ar(h,s,f,c)),h}function ze(r,e){var t=new x("",0,10);t.WriteByte(e);var A=e&1,n=e&8,a=e&16,o=e&32,i=e&64,g=e&128,c=e>>8;if(a||t.WriteUint7(r.length),n)return Buffer.concat([t.buf.slice(0,t.pos),rr(t,r,c)]);var s=new Buffer.alloc(0);g&&([s,r]=er(r));var f=new Buffer.alloc(0);if(i&&([f,r]=XA(r)),r.length<4&&A==1&&(A=0,t.buf[0]&=-2),o)var l=r;else if(A==0)var l=ct(r);else var l=Ir(r);return Buffer.concat([t.buf.slice(0,t.pos),s,f,l])}function Ht(r){for(var e=new Array(256),t=0;t<256;t++)e[t]=0;var A=0,n=r.ReadByte(),a=n;do e[n]=1,A>0?(A--,n++):(n=r.ReadByte(),n==a+1&&(A=r.ReadByte())),a=n;while(n!=0);return e}function ir(r,e,t){for(var A=0;A<256;A++)e[A]=0;for(var n=Ht(r),A=0;A<256;A++)n[A]>0&&(e[A]=r.ReadUint7());gt(e,12),t[0]=0;for(var A=0;A<=255;A++)t[A+1]=t[A]+e[A]}function st(r,e){var t=new Array(256),A=new Array(256);ir(r,t,A);for(var n=bt(A,12),a=new Array(4),o=0;o<4;o++)a[o]=r.ReadUint32();for(var i=new Buffer.allocUnsafe(e),o=0;o<e;o++){var g=o%4,c=Te(a[g],12),s=n[c];i[o]=s,a[g]=Ye(a[g],A[s],t[s],12),a[g]=Ke(r,a[g])}return i}function or(r,e){for(var t=0;t<256;t++)e[t]=0;for(var t=0;t<r.length;t++)e[r[t]]++}function $e(r,e){for(var t=0,A=0;A<256;A++)t+=r[A];const n=1<<e;var a=n/t;do{var o=0,i=0,g=0;t=0;for(var A=0;A<256;A++)r[A]!=0&&(o<r[A]&&(o=r[A],i=A),r[A]=Math.floor(r[A]*a),r[A]==0&&(r[A]=1),t+=r[A]);t<n?r[i]+=n-t:t-n<r[i]/2&&r[i]>2?r[i]-=t-n:t!=n&&(a=n/t,g=1)}while(g)}function gt(r,e){for(var t=0,A=0;A<256;A++)t+=r[A];if(!(t==0||t==1<<e)){for(var n=0;t<1<<e;)t*=2,n++;for(var A=0;A<256;A++)r[A]<<=n}}function Pt(r,e){for(var t=0,A=0;A<256;A++)if(e[A]){if(t>0)t--;else if(r.WriteByte(A),A>0&&e[A-1]>0){for(t=A+1;t<256&&e[t];t++);t-=A+1,r.WriteByte(t)}}r.WriteByte(0)}function sr(r,e){Pt(r,e);for(var t=0;t<256;t++)e[t]&&r.WriteUint7(e[t])}function ct(r){const e=r.length;var t=new x("",0,257*3+9),A=new Array(256);or(r,A);var n=Math.ceil(Math.log2(e));n>12&&(n=12),$e(A,n),sr(t,A),$e(A,12);var a=new Array(256);a[0]=0;for(var o=1;o<256;o++)a[o]=a[o-1]+A[o-1];for(var i=new Array(4),o=0;o<4;o++)i[o]=xt();for(var g=new x("",e*1.05+100>>0,e*1.05+100>>0),o=e-1;o>=0;o--)i[o%4]=pe(i[o%4],g,a[r[o]],A[r[o]],12);for(var o=3;o>=0;o--)Lt(i[o],g);return Buffer.concat([t.buf.slice(0,t.pos),g.buf.slice(g.pos,g.length)],t.pos+g.length-g.pos)}function gr(r,e,t,A){for(var n=0;n<256;n++){e[n]=new Array(256),t[n]=new Array(256);for(var a=0;a<256;a++)e[n][a]=0}for(var o=Ht(r),n=0;n<256;n++)if(o[n]){for(var i=0,a=0;a<256;a++)o[a]&&(i>0?i--:(e[n][a]=r.ReadUint7(),e[n][a]==0&&(i=r.ReadByte())));gt(e[n],A),t[n][0]=0;for(var a=0;a<256;a++)t[n][a+1]=t[n][a]+e[n][a]}}function cr(r,e){var t=r.ReadByte(),A=t>>4,n=r;if(t&1)var a=r.ReadUint7(),o=r.ReadUint7(),t=new x(r.ReadData(o)),n=new x(st(t,a));var i=new Array(256),g=new Array(256);gr(n,i,g,A);for(var c=new Array(256),s=0;s<256;s++)c[s]=bt(g[s],A);for(var f=new Array(4),l=new Array(4),d=0;d<4;d++)f[d]=r.ReadUint32(),l[d]=0;for(var C=new Buffer.allocUnsafe(e),h=Math.floor(e/4),s=0;s<h;s++)for(var d=0;d<4;d++){var I=Te(f[d],A),u=c[l[d]][I];C[s+d*h]=u,f[d]=Ye(f[d],g[l[d]][u],i[l[d]][u],A),f[d]=Ke(r,f[d]),l[d]=u}for(s=4*s;s<e;){var I=Te(f[3],A),u=$A(g[l[3]],I);C[s++]=u,f[3]=Ye(f[3],g[l[3]][u],i[l[3]][u],A),f[3]=Ke(r,f[3]),l[3]=u}return C}function fr(r,e,t){for(var A=0;A<256;A++){t[A]=0;for(var n=0;n<256;n++)e[A][n]=0}for(var a=0,A=0;A<r.length;A++)t[a]++,e[a][r[A]]++,a=r[A];t[a]++,e[0][r[1*(r.length>>2)]]++,e[0][r[2*(r.length>>2)]]++,e[0][r[3*(r.length>>2)]]++,t[0]+=3}function lr(r,e,t){for(var A=0;A<256;A++)if(e[A]){var n=Math.ceil(Math.log2(e[A]));n>t&&(n=t),$e(r[A],n)}}function dr(r,e,t){for(var A=0;A<256;A++)e[A]&&gt(r[A],t)}function hr(r,e,t){Pt(r,t);for(var A=0;A<256;A++)if(t[A]){for(var n=0,a=0;a<256;a++)if(t[a]){if(n)n--;else if(r.WriteUint7(e[A][a]),!e[A][a]){for(var o=a+1;o<256;o++)if(t[o])if(e[A][o]==0)n++;else break;r.WriteByte(n)}}}}function Ir(r){const e=r.length;for(var t=new x("",0,257*257*3+9),A=new Array(256),n=new Array(256),a=new Array(256),o=0;o<256;o++)n[o]=new Array(256),a[o]=new Array(256);var i=12;fr(r,n,A),lr(n,A,i);var g=new x("",0,257*257*3+9);hr(g,n,A);var c=ct(g.buf.slice(0,g.pos));c.length<g.pos?(t.WriteByte(1|i<<4),t.WriteUint7(g.pos),t.WriteUint7(c.length),t.WriteData(c,c.length)):(t.WriteByte(0|i<<4),t.WriteData(g.buf,g.pos)),dr(n,A,i);for(var o=0;o<256;o++)if(A[o]){a[o][0]=0;for(var s=1;s<256;s++)a[o][s]=a[o][s-1]+n[o][s-1]}for(var f=new Array(4),l=new Array(4),s=0;s<4;s++)f[s]=xt(),l[s]=0;for(var d=new x("",e*1.05+100>>0,e*1.05+100>>0),C=Math.floor(e/4),h=new Array(4),I=new Array(4),s=0;s<4;s++)h[s]=(s+1)*C-2,I[s]=r[h[s]+1];I[3]=r[e-1];for(var o=e-2;o>4*C-2;o--)f[3]=pe(f[3],d,a[r[o]][I[3]],n[r[o]][I[3]],i),I[3]=r[o];for(;h[0]>=0;)for(var s=3;s>=0;s--){var u=r[h[s]];f[s]=pe(f[s],d,a[u][I[s]],n[u][I[s]],i),I[s]=u,h[s]--}for(var s=3;s>=0;s--)f[s]=pe(f[s],d,a[0][I[s]],n[0][I[s]],i);for(var o=3;o>=0;o--)Lt(f[o],d);return Buffer.concat([t.buf.slice(0,t.pos),d.buf.slice(d.pos,d.length)],t.pos+d.length-d.pos)}var Ot={decode:ar,encode:ze},Gt=class{constructor(e){this.low=0,this.range=4294967295,this.code=0,this.FFnum=0,this.carry=0,this.cache=0}RangeStartDecode(e){for(var t=0;t<5;t++)this.code=(this.code<<8)+e.ReadByte();this.code&=4294967295,this.code>>>=0}RangeGetFrequency(e){return this.range=Math.floor(this.range/e),Math.floor(this.code/this.range)}RangeDecode(e,t,A,n){for(this.code-=t*this.range,this.range*=A;this.range<1<<24;)this.range*=256,this.code=this.code*256+e.ReadByte()}RangeShiftLow(e){if(this.low<4278190080|this.carry){for(e.WriteByte(this.cache+this.carry);this.FFnum;)e.WriteByte(this.carry-1),this.FFnum--;this.cache=this.low>>>24,this.carry=0}else this.FFnum++;this.low<<=8,this.low>>>=0}RangeEncode(e,t,A,n){var a=this.low;for(this.range=Math.floor(this.range/n),this.low+=t*this.range,this.low>>>=0,this.range*=A,this.low<a&&(this.carry!=0&&console.log("ERROR: Multiple carry"),this.carry=1);this.range<1<<24;)this.range*=256,this.RangeShiftLow(e)}RangeFinishEncode(e){for(var t=0;t<5;t++)this.RangeShiftLow(e)}};const Bt=65519,Qe=16;var Jt=class{constructor(e=256){this.total_freq=e,this.max_sym=e-1,this.S=new Array,this.F=new Array;for(var t=0;t<=this.max_sym;t++)this.S[t]=t,this.F[t]=1}ModelDecode(e,t){for(var A=t.RangeGetFrequency(this.total_freq),n=0,a=0;n+this.F[a]<=A;)n+=this.F[a++];t.RangeDecode(e,n,this.F[a],this.total_freq),this.F[a]+=Qe,this.total_freq+=Qe,this.total_freq>Bt&&this.ModelRenormalise();var o=this.S[a];if(a>0&&this.F[a]>this.F[a-1]){var i=this.F[a];this.F[a]=this.F[a-1],this.F[a-1]=i,i=this.S[a],this.S[a]=this.S[a-1],this.S[a-1]=i}return o}ModelRenormalise(){this.total_freq=0;for(var e=0;e<=this.max_sym;e++)this.F[e]-=Math.floor(this.F[e]/2),this.total_freq+=this.F[e]}ModelEncode(e,t,o){for(var n=0,a=0;this.S[a]!=o;a++)n+=this.F[a];t.RangeEncode(e,n,this.F[a],this.total_freq),this.F[a]+=Qe,this.total_freq+=Qe,this.total_freq>Bt&&this.ModelRenormalise();var o=this.S[a];if(a>0&&this.F[a]>this.F[a-1]){var i=this.F[a];this.F[a]=this.F[a-1],this.F[a-1]=i,i=this.S[a],this.S[a]=this.S[a-1],this.S[a-1]=i}}},V={};V.array=function(r){var e=0,t=0,A=[0,1,3,7,15,31,63,127,255];return function(n){for(var a=0;n>0;){var o=8-e;n>=o?(a<<=o,a|=A[o]&r[t++],e=0,n-=o):(a<<=n,a|=(r[t]&A[n]<<8-n-e)>>8-n-e,e+=n,n=0)}return a}};V.simple=function(r){var e=V.header(r),t,A,n=[],a=0;do A=V.decompress(r,e),A!=-1&&(n.push(A),a+=A.byteLength);while(A!=-1);t=new Uint8Array(a),a=0;for(var o=0;o<n.length;++o)A=n[o],t.set(A,a),a+=A.byteLength;return t};V.header=function(r){if(r(8*3)!=4348520)throw"No magic number found";var e=r(8)-48;if(e<1||e>9)throw"Not a BZIP archive";return e};V.decompress=function(r,e,t){for(var A=20,n=258,a=0,o=1,i=50,g=1e5*9,c="",s=0;s<6;s++)c+=r(8).toString(16);if(c=="177245385090")return-1;if(c!="314159265359")throw"eek not valid bzip data";if(r(32),r(1))throw"unsupported obsolete version";var f=r(24);if(f>g)throw"Initial position larger than buffer size";var l=r(16),d=new Uint8Array(256),C=0;for(s=0;s<16;s++)if(l&1<<15-s){var h=r(16);for(F=0;F<16;F++)h&1<<15-F&&(d[C++]=16*s+F)}var I=r(3);if(I<2||I>6)throw"another error";var u=r(15);if(u==0)throw"meh";for(var B=[],s=0;s<I;s++)B[s]=s;for(var v=new Uint8Array(32768),s=0;s<u;s++){for(var F=0;r(1);F++)if(F>=I)throw"whoops another error";var w=B[F];B.splice(F,1),B.splice(0,0,w),v[s]=w}for(var J=C+2,Q=[],F=0;F<I;F++){var y=new Uint8Array(n),k=new Uint8Array(A+1);l=r(5);for(var s=0;s<J;s++){for(;;){if(l<1||l>A)throw"I gave up a while ago on writing error messages";if(!r(1))break;r(1)?l--:l++}y[s]=l}var _,q;_=q=y[0];for(var s=1;s<J;s++)y[s]>q?q=y[s]:y[s]<_&&(_=y[s]);var N;N=Q[F]={},N.permute=new Uint32Array(n),N.limit=new Uint32Array(A+1),N.base=new Uint32Array(A+1),N.minLen=_,N.maxLen=q;for(var O=N.base.subarray(1),R=N.limit.subarray(1),p=0,s=_;s<=q;s++)for(var l=0;l<J;l++)y[l]==s&&(N.permute[p++]=l);for(s=_;s<=q;s++)k[s]=R[s]=0;for(s=0;s<J;s++)k[y[s]]++;for(p=l=0,s=_;s<q;s++)p+=k[s],R[s]=p-1,p<<=1,O[s+1]=p-(l+=k[s]);R[q]=p+k[q]-1,O[_]=0}for(var L=new Uint32Array(256),s=0;s<256;s++)B[s]=s;var U,b,J,ke;U=b=J=ke=0;for(var ee=new Uint32Array(g);;){if(!J--){if(J=i-1,ke>=u)throw"meow i'm a kitty, that's an error";N=Q[v[ke++]],O=N.base.subarray(1),R=N.limit.subarray(1)}for(s=N.minLen,F=r(s);;){if(s>N.maxLen)throw"rawr i'm a dinosaur";if(F<=R[s])break;s++,F=F<<1|r(1)}if(F-=O[s],F<0||F>=n)throw"moo i'm a cow";var ne=N.permute[F];if(ne==a||ne==o){U||(U=1,l=0),ne==a?l+=U:l+=2*U,U<<=1;continue}if(U){if(U=0,b+l>=g)throw"Boom.";for(w=d[B[0]],L[w]+=l;l--;)ee[b++]=w}if(ne>C)break;if(b>=g)throw"I can't think of anything. Error";s=ne-1,w=B[s],B.splice(s,1),B.splice(0,0,w),w=d[w],L[w]++,ee[b++]=w}if(f<0||f>=b)throw"I'm a monkey and I'm throwing something at someone, namely you";for(var F=0,s=0;s<256;s++)h=F+L[s],L[s]=F,F=h;for(var s=0;s<b;s++)w=ee[s]&255,ee[L[w]]|=s<<8,L[w]++;var K=0,z=0,Fe=0;b&&(K=ee[f],z=K&255,K>>=8,Fe=-1),b=b;var Me=new Uint8Array(g),qe,be,xe,ht=0;for(t||(t=1/0);b;){for(b--,be=z,K=ee[K],z=K&255,K>>=8,Fe++==3?(qe=z,xe=be,z=-1):(qe=1,xe=z);qe--;)if(Me[ht++]=xe,!--t)return Me;z!=be&&(Fe=0)}return Me.subarray(0,ht)};var Wt=V;const He=it(Wt),T=Gt,Ee=ue,H=Jt,Pe=Wt,Qt=1,Cr=4,Et=8,wt=16,ur=32,vt=64,we=128;var Tt=class{decode(e){return this.stream=new Ee(e),this.decodeStream(this.stream)}decodeStream(e,t=0){var A=this.stream.ReadByte();A&wt||(t=this.stream.ReadUint7());var n=t,a=A&Qt;if(A&Et)return this.decodeStripe(this.stream,t);if(A&we){var o;[o,n]=this.decodePackMeta(this.stream)}if(A&ur)var i=this.decodeCat(this.stream,n);else if(A&Cr)var i=this.decodeExt(this.stream,n);else if(A&vt)var i=a?this.decodeRLE1(this.stream,n):this.decodeRLE0(this.stream,n);else var i=a?this.decode1(this.stream,n):this.decode0(this.stream,n);return A&we&&(i=this.decodePack(i,o,t)),i}encode(e,t){if(this.stream=new Ee("",0,e.length*1.1+100),this.stream.WriteByte(t),t&wt||this.stream.WriteUint7(e.length),t&Et)return Buffer.concat([this.stream.buf.slice(0,this.stream.pos),this.encodeStripe(this.stream,e,t>>8)]);var A=t&Qt,n=e.length,a;return t&we&&([a,e,n]=this.encodePack(e)),t&we&&this.stream.WriteStream(a),t&vt?A?this.encodeRLE1(e,n,this.stream):this.encodeRLE0(e,n,this.stream):A?this.encode1(e,n,this.stream):this.encode0(e,n,this.stream)}decode0(e,t){var A=new Buffer.allocUnsafe(t),n=e.ReadByte();n==0&&(n=256);var a=new H(n),o=new T(e);o.RangeStartDecode(e);for(var i=0;i<t;i++)A[i]=a.ModelDecode(e,o);return A}encode0(e,t,A){for(var n=0,a=0;a<t;a++)n<e[a]&&(n=e[a]);n++;var o=new H(n);A.WriteByte(n);for(var i=new T(A),a=0;a<t;a++)o.ModelEncode(A,i,e[a]);return i.RangeFinishEncode(A),A.buf.slice(0,A.pos)}decode1(e,t){var A=new Buffer.allocUnsafe(t),n=e.ReadByte();n==0&&(n=256);for(var a=new Array(n),o=0;o<n;o++)a[o]=new H(n);var i=new T(e);i.RangeStartDecode(e);for(var g=0,o=0;o<t;o++)A[o]=a[g].ModelDecode(e,i),g=A[o];return A}encode1(e,t,A){for(var n=0,a=0;a<t;a++)n<e[a]&&(n=e[a]);n++;for(var o=new Array(n),a=0;a<n;a++)o[a]=new H(n);A.WriteByte(n);for(var i=new T(A),g=0,a=0;a<t;a++)o[g].ModelEncode(A,i,e[a]),g=e[a];return i.RangeFinishEncode(A),A.buf.slice(0,A.pos)}decodeExt(e,t){var A=new Buffer.allocUnsafe(t),n=Pe.array(e.buf.slice(e.pos)),a=Pe.header(n),o=0;do{var i=Pe.decompress(n,a);i!=-1&&(Buffer.from(i).copy(A,o),o+=i.length,a-=i.length)}while(i!=-1);return A}encodeExt(e,t){}decodeRLE0(e,t){var A=new Buffer.allocUnsafe(t),n=e.ReadByte();n==0&&(n=256);for(var a=new H(n),o=new Array(258),g=0;g<=257;g++)o[g]=new H(4);var i=new T(e);i.RangeStartDecode(e);for(var g=0;g<t;){A[g]=a.ModelDecode(e,i);for(var c=o[A[g]].ModelDecode(e,i),s=c,f=256;c==3;)c=o[f].ModelDecode(e,i),f=257,s+=c;for(var l=1;l<=s;l++)A[g+l]=A[g];g+=s+1}return A}encodeRLE0(e,t,A){for(var n=0,g=0;g<t;g++)n<e[g]&&(n=e[g]);n++;for(var a=new H(n),o=new Array(258),g=0;g<=257;g++)o[g]=new H(4);A.WriteByte(n);for(var i=new T(A),g=0;g<t;){a.ModelEncode(A,i,e[g]);for(var c=1;g+c<t&&e[g+c]==e[g];)c++;c--;var s=e[g];e[g],g+=c+1;var f=c>=3?3:c;for(o[s].ModelEncode(A,i,f),c-=f,s=256;f==3;)f=c>=3?3:c,o[s].ModelEncode(A,i,f),s=257,c-=f}return i.RangeFinishEncode(A),A.buf.slice(0,A.pos)}decodeRLE1(e,t){var A=new Buffer.allocUnsafe(t),n=e.ReadByte();n==0&&(n=256);for(var a=new Array(n),c=0;c<n;c++)a[c]=new H(n);for(var o=new Array(258),c=0;c<=257;c++)o[c]=new H(4);var i=new T(e);i.RangeStartDecode(e);for(var g=0,c=0;c<t;){A[c]=a[g].ModelDecode(e,i),g=A[c];for(var s=o[A[c]].ModelDecode(e,i),f=s,l=256;s==3;)s=o[l].ModelDecode(e,i),l=257,f+=s;for(var d=1;d<=f;d++)A[c+d]=A[c];c+=f+1}return A}encodeRLE1(e,t,A){for(var n=0,g=0;g<t;g++)n<e[g]&&(n=e[g]);n++;for(var a=new Array(n),g=0;g<n;g++)a[g]=new H(n);for(var o=new Array(258),g=0;g<=257;g++)o[g]=new H(4);A.WriteByte(n);for(var i=new T(A),g=0,c=0;g<t;){a[c].ModelEncode(A,i,e[g]);for(var s=1;g+s<t&&e[g+s]==e[g];)s++;s--;var f=e[g];c=e[g],g+=s+1;var l=s>=3?3:s;for(o[f].ModelEncode(A,i,l),s-=l,f=256;l==3;)l=s>=3?3:s,o[f].ModelEncode(A,i,l),f=257,s-=l}return i.RangeFinishEncode(A),A.buf.slice(0,A.pos)}decodePackMeta(e){this.nsym=e.ReadByte();for(var t=new Array(this.nsym),A=0;A<this.nsym;A++)t[A]=e.ReadByte();var n=e.ReadUint7();return[t,n]}decodePack(e,t,A){var n=new Buffer.allocUnsafe(A);if(this.nsym<=1)for(var a=0;a<A;a++)n[a]=t[0];else if(this.nsym<=2)for(var a=0,o=0;a<A;a++){if(a%8==0)var i=e[o++];n[a]=t[i&1],i>>=1}else if(this.nsym<=4)for(var a=0,o=0;a<A;a++){if(a%4==0)var i=e[o++];n[a]=t[i&3],i>>=2}else if(this.nsym<=16)for(var a=0,o=0;a<A;a++){if(a%2==0)var i=e[o++];n[a]=t[i&15],i>>=4}else return e;return n}packMeta(e){for(var t=new Ee("",0,1024),A=new Array(256),n=0;n<e.length;n++)A[e[n]]=1;for(var a=0,n=0;n<256;n++)A[n]&&(A[n]=++a);t.WriteByte(a);for(var n=0;n<256;n++)A[n]&&(t.WriteByte(n),A[n]--);return[t,A,a]}encodePack(e){var t,A,n;[t,A,n]=this.packMeta(e);var a=e.length,o=0;if(n<=1)return t.WriteUint7(0),[t,new Buffer.allocUnsafe(0),0];if(n<=2){for(var i=new Buffer.allocUnsafe(Math.floor((a+7)/8)),o=0,g=0;o<(a&-8);o+=8,g++)i[g]=(A[e[o+0]]<<0)+(A[e[o+1]]<<1)+(A[e[o+2]]<<2)+(A[e[o+3]]<<3)+(A[e[o+4]]<<4)+(A[e[o+5]]<<5)+(A[e[o+6]]<<6)+(A[e[o+7]]<<7);if(o<a){i[g]=0;for(var c=0;o<a;)i[g]|=A[e[o++]]<<c,c++;g++}return t.WriteUint7(g),[t,i,i.length]}if(n<=4){for(var i=new Buffer.allocUnsafe(Math.floor((a+3)/4)),o=0,g=0;o<(a&-4);o+=4,g++)i[g]=(A[e[o+0]]<<0)+(A[e[o+1]]<<2)+(A[e[o+2]]<<4)+(A[e[o+3]]<<6);if(o<a){i[g]=0;for(var c=0;o<a;)i[g]|=A[e[o++]]<<c,c+=2;g++}return t.WriteUint7(g),[t,i,i.length]}if(n<=16){for(var i=new Buffer.allocUnsafe(Math.floor((a+1)/2)),o=0,g=0;o<(a&-2);o+=2,g++)i[g]=(A[e[o+0]]<<0)+(A[e[o+1]]<<4);return o<a&&(i[g++]=A[e[o++]]),t.WriteUint7(g),[t,i,i.length]}return t.WriteUint7(e.length),[t,e,e.length]}encodeStripe(e,t,A){A==0&&(A=4);for(var n=new Array(A),a=new Array(A),o=0;o<A;o++)a[o]=Math.floor(t.length/A)+(t.length%A>o),n[o]=new Array(a[o]);for(var i=0,g=0;g<t.length;g+=A,i++)for(var c=0;c<A;c++)i<n[c].length&&(n[c][i]=t[g+c]);for(var s=new Array(A),f=0,o=0;o<A;o++){var l=this.encode(n[o],0),d=this.encode(n[o],1);s[o]=d.length<l.length?d:l,f+=s[o].length}var C=new Ee("",0,f+5*A+1);C.WriteByte(A);for(var o=0;o<A;o++)C.WriteUint7(s[o].length);for(var o=0;o<A;o++)C.WriteData(s[o],s[o].length);return C.buf.slice(0,C.buf.pos)}decodeStripe(e,t){for(var A=e.ReadByte(),n=new Array(A),a=new Array(A),o=0;o<A;o++)n[o]=e.ReadUint7();for(var i=new Array(A),o=0;o<A;o++)a[o]=Math.floor(t/A)+(t%A>o),i[o]=this.decodeStream(e,a[o]);for(var g=new Buffer.allocUnsafe(t),o=0;o<A;o++)for(var c=0;c<a[o];c++)g[c*A+o]=i[o][c];return g}decodeCat(e,t){for(var A=new Buffer.allocUnsafe(t),n=0;n<t;n++)A[n]=e.ReadByte();return A}};const Yt=ue,G=Jt,Kt=Gt;function Se(r,e,t){for(var A=0,n=0,a=-1,o=new Array(1024);n<t;){var i=r.ReadByte();if(o[A++]=i,n+=i,i==a){var g=r.ReadByte();for(n+=i*g;g--;)o[A++]=i}a=i}var c=0;for(A=0,n=0;n<t;){var s=0;do{var f=o[A++];s+=f}while(f==255);for(;s--;)e[n++]=c;c++}}const ft=2,zt=4,$t=8,Ve=16,Xe=32,Ze=64,je=128,et=1,tt=2,Br=4;function Qr(r,e,t){var A=r.context;return e.qctx=(e.qctx<<r.qshift)+r.qtab[t],A+=(e.qctx&(1<<r.qbits)-1)<<r.qloc,r.do_pos&&(A+=r.ptab[Math.min(e.p,1023)]<<r.ploc),r.do_delta&&(A+=r.dtab[Math.min(e.delta,255)]<<r.dloc,e.delta+=e.prevq!=t?1:0,e.prevq=t),r.do_sel&&(A+=e.s<<r.sloc),e.p--,A&65535}function Er(r){var e={};e.context=r.ReadUint16(),e.pflags=r.ReadByte(),e.do_dedup=e.pflags&ft,e.fixed_len=e.pflags&zt,e.do_sel=e.pflags&$t,e.do_qmap=e.pflags&Ve,e.do_pos=e.pflags&Xe,e.do_delta=e.pflags&Ze,e.do_qtab=e.pflags&je,e.max_sym=r.ReadByte();var t=r.ReadByte();if(e.qbits=t>>4,e.qshift=t&15,t=r.ReadByte(),e.qloc=t>>4,e.sloc=t&15,t=r.ReadByte(),e.ploc=t>>4,e.dloc=t&15,e.qmap=new Array(256),e.pflags&Ve)for(var A=0;A<e.max_sym;A++)e.qmap[A]=r.ReadByte();else for(var A=0;A<256;A++)e.qmap[A]=A;if(e.qtab=new Array(1024),e.qbits>0&&e.pflags&je)Se(r,e.qtab,256);else for(var A=0;A<256;A++)e.qtab[A]=A;return e.ptab=new Array(1024),e.pflags&Xe&&Se(r,e.ptab,1024),e.dtab=new Array(256),e.pflags&Ze&&Se(r,e.dtab,256),e}function wr(r){var e={max_sym:0},t=r.ReadByte();if(t!=5){console.error("Invalid FQZComp version number");return}var A=r.ReadByte(),n=A&et?r.ReadByte():1,a=A.nparam>1?A.nparam-1:0,o=new Array(256);if(A&tt)a=r.ReadByte(),Se(r,o,256);else{for(var i=0;i<n;i++)o[i]=i;for(;i<256;i++)o[i]=n-1}e.do_rev=A&Br,e.stab=o,e.max_sel=a,e.params=new Array(e.nparam);for(var g=0;g<n;g++)e.params[g]=Er(r),e.max_sym<e.params[g].max_sym&&(e.max_sym=e.params[g].max_sym);return e}function vr(r){var e={};e.qual=new Array(65536);for(var t=0;t<65536;t++)e.qual[t]=new G(r.max_sym+1);e.len=new Array(4);for(var t=0;t<4;t++)e.len[t]=new G(256);return e.rev=new G(2),e.dup=new G(2),r.max_sel>0&&(e.sel=new G(r.max_sel+1)),e}function mr(r,e,t,A,n,a){t.max_sel>0?n.s=A.sel.ModelDecode(r,e):n.s=0,n.x=t.stab[n.s];var o=t.params[n.x];if(o.fixed_len>=0){var i=A.len[0].ModelDecode(r,e);i|=A.len[1].ModelDecode(r,e)<<8,i|=A.len[2].ModelDecode(r,e)<<16,i|=A.len[3].ModelDecode(r,e)<<24,o.fixed_len>0&&(o.fixed_len=-i)}else i=-o.fixed_len;n.len=i,t.do_rev&&(a[n.rec]=A.rev.ModelDecode(r,e)),n.is_dup=0,o.pflags&ft&&A.dup.ModelDecode(r,e)&&(n.is_dup=1),n.p=i,n.delta=0,n.qctx=0,n.prevq=0,n.rec++}function yr(r,e){var t=r.ReadUint7(),A=wr(r);if(A){var n=A.params,a=new Array(e.length),o=vr(A),i=new Kt(r);i.RangeStartDecode(r);for(var g=new Buffer.allocUnsafe(t),c={qctx:0,prevq:0,delta:0,p:0,s:0,x:0,len:0,is_dup:0,rec:0},s=0;s<t;){if(c.p==0){if(mr(r,i,A,o,c,a),c.is_dup>0&&o.dup.ModelDecode(r,i)){for(var f=0;f<len;f++)g[s+f]=g[s+f-c.len];s+=c.len,c.p=0;continue}e.push(c.len);var n=A.params[c.x],l=n.context}var d=o.qual[l].ModelDecode(r,i);g[s++]=n.qmap[d],l=Qr(n,c,d)}return A.do_rev&&pr(g,t,a,e),g}}function pr(r,e,t,A){for(var n=0,a=0;a<e;){if(t[n])for(var o=0,i=A[n]-1;o<i;){var g=r[a+o];r[a+o]=r[a+i],r[a+i]=g,o++,i--}a+=A[n++]}}function Sr(r,e){var t=new Yt(r);return yr(t,e)}function Dr(r,e,t,A){for(var n=t[0],a=0;a<t.length&&t[a]==n;a++);for(var o=a==t.length?1:0,i=0,g=0,a=0;a<256;a++)A[0][a]=0;for(var c=0,s=0,a=0;a<r.length;a++)s==0&&(s=e[c<e.length-1?c++:c]),A[0][r[a]]++,s--;for(var a=0;a<256;a++)A[0][a]&&(g<a&&(g=a),i++);var f=5,l=0;return i<=16&&(l=1,i<=2?f=1:i<=4?f=2:i<=8?f=3:f=4),[{qbits:8+(f>4),qshift:f,qloc:7,pbits:7,pshift:e[0]>128?1:0,ploc:0,dbits:f>4?0:1,dshift:3,dloc:15,sbits:0,sloc:15,do_stab:0,context:0,max_sym:g,nsym:i,do_qmap:l,do_dedup:0,fixed_len:e.length==1?1:0,do_sel:0,do_rev:0,do_pos:1,do_delta:f<=4?1:0,do_qtab:0,qbits:8+(f>4)-(o==0),sbits:1,sloc:15-(f<=4),do_stab:1,do_sel:1}]}function ve(r,e,t){for(var A=0,n=0,a=new Array(t*2),o=0;A<t;){for(var i=A;A<t&&e[A]==n;)A++;var g=A-i;do{var c=Math.min(255,g);a[o++]=c,g-=c}while(c==255);n++}var s=-1,f=new Array(t*2),l=0;for(A=0;A<o;){var d=a[A++];if(f[l++]=d,d==s){for(var i=A;A<o&&a[A]==s&&A-i<255;)A++;f[l++]=A-i}else s=d}r.WriteData(f,l)}function _r(r,e,t,A,n,a,o){for(var i=[0,1,1,1,2,2,2,2,2,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],g=0;g<e.length;g++)o[g]=g;for(;g<256;g++)o[g]=e.length-1;r.WriteByte(5);var c=(e.length>1?et:0)|(e[0].do_stab?tt:0);if(r.WriteByte(c),c&et&&r.WriteByte(e.length),c&tt){var s=1<<e[0].sbits;s>0&&s--,r.WriteByte(s),ve(r,o,256)}for(var f=0;f<e.length;f++){if(r.WriteUint16(e[f].context),r.WriteByte((e[f].do_qtab?je:0)|(e[f].do_delta?Ze:0)|(e[f].do_pos?Xe:0)|(e[f].do_qmap?Ve:0)|(e[f].do_sel?$t:0)|(e[f].fixed_len?zt:0)|(e[f].do_dedup?ft:0)),e[f].do_qmap?r.WriteByte(e[f].nsym):r.WriteByte(e[f].max_sym),r.WriteByte(e[f].qbits<<4|e[f].qshift),r.WriteByte(e[f].qloc<<4|e[f].sloc),r.WriteByte(e[f].ploc<<4|e[f].dloc),e[f].do_qmap){e[f].max_sym=e[f].nsym;for(var l=0,g=0;g<256;g++)t[f][g]&&(r.WriteByte(g),t[f][g]=l++);for(;l<e[f].nsym;l++)r.WriteByte(0)}else for(var g=0;g<256;g++)t[f][g]=g;if(e[f].qbits>0){for(var g=0;g<256;g++)A[f][g]=g;e[f].do_qtab&&ve(r,A[f],256)}if(e[f].pbits>0){for(var g=0;g<1024;g++)n[f][g]=Math.min((1<<e[f].pbits)-1,g>>e[f].pshift);ve(r,n[f],1024)}if(e[f].dbits>0){for(var g=0;g<256;g++)i[g]>(1<<e[f].dbits)-1&&(i[g]=(1<<e[f].dbits)-1);for(var g=0;g<256;g++)a[f][g]=i[Math.min(i.length-1,g>>e[f].dshift)];ve(r,a[f],256)}}return r}function Rr(r,e,t,A,n,a,o,i,g,c){var s=1<<n[0].sbits;s>0&&s--;for(var f=e.length,l=0,u=0;u<n.length;u++)l<n[u].max_sym&&(l=n[u].max_sym);for(var d=new Array(65536),B=0;B<65536;B++)d[B]=new G(l+1);for(var C=new Array(4),B=0;B<4;B++)C[B]=new G(256);new G(2),new G(2);for(var h=new G(s+1),I=new Kt(e),u=0,B=0,v=0;B<f;){if(u==0){var w=A[v];n[0].sbits>0&&h.ModelEncode(r,I,w);var Q=c[w],y=t[Math.min(t.length-1,v++)];n[Q].fixed_len?n[Q].fixed_len>0&&(C[0].ModelEncode(r,I,y&255),C[1].ModelEncode(r,I,y>>8&255),C[2].ModelEncode(r,I,y>>16&255),C[3].ModelEncode(r,I,y>>24&255),n[Q].fixed_len=-1):(C[0].ModelEncode(r,I,y&255),C[1].ModelEncode(r,I,y>>8&255),C[2].ModelEncode(r,I,y>>16&255),C[3].ModelEncode(r,I,y>>24&255)),n[Q].do_dedup&&process.exit(1),u=y;var k=0,_=n[Q].context,q=0,N=0}var O=e[B++],R=a[Q][O];d[_].ModelEncode(r,I,R),q=(q<<n[Q].qshift)+o[Q][R],_=n[Q].context,_+=(q&(1<<n[Q].qbits)-1)<<n[Q].qloc,n[Q].pbits>0&&(_+=i[Q][Math.min(u,1023)]<<n[Q].ploc),n[Q].dbits>0&&(_+=g[Q][Math.min(k,255)]<<n[Q].dloc,k+=N!=R?1:0,N=R),n[Q].do_sel&&(_+=w<<n[Q].sloc),_=_&65535,u--}return I.RangeFinishEncode(r),r.buf.slice(0,r.pos)}function Nr(r,e,t){for(var A=new Array(2),n=new Array(2),a=new Array(2),o=new Array(2),i=new Array(256),g=0;g<2;g++)A[g]=new Array(256),n[g]=new Array(256),a[g]=new Array(1024),o[g]=new Array(256);var s=new Yt("",0,r.length*1.1+100);s.WriteUint7(r.length);var c=Dr(r,e,t,A),s=_r(s,c,A,n,a,o,i);return Rr(s,r,e,t,c,A,n,a,o,i)}var kr={decode:Sr,encode:Nr};const te=ue,Vt=Ot,Fr=Tt;var Xt=new Fr;const ce=0,fe=1,le=2,Ae=3,Zt=4,oe=5,At=6,re=7,de=8,he=9,lt=10,Ie=12;function Mr(r,e,t,A){for(var n=-1,a=new Array(256);!r.EOF();){var o=r.ReadByte(),i=o&128,g=o&64,c=o&63;if(i&&(n++,a[n]=new Array(13)),c!=ce&&i){var s=new Array(A-1).fill(lt);a[n][ce]=new te(Buffer.from([c].concat(s)))}if(g){var f=r.ReadByte(),l=r.ReadByte();a[n][c]=new te(a[f][l].buf)}else{var d=r.ReadUint7(),C=r.ReadData(d);t?a[n][c]=Xt.decode(C):a[n][c]=Vt.decode(C),a[n][c]=new te(a[n][c])}}return a}function mt(r,e){for(var t=r+"";t.length<e;)t="0"+t;return t}function qr(r,e,t,A){var n=r[0][ce].ReadByte(),a=r[0][n].ReadUint32(),o=A-a;if(n==oe)return e[A]=e[o],t[A]=t[o],e[A];var i=1;e[A]="",t[A]=new Array(256);do{switch(n=r[i][ce].ReadByte(),n){case le:t[A][i]=r[i][le].ReadChar();break;case fe:t[A][i]=r[i][fe].ReadString();break;case re:t[A][i]=r[i][re].ReadUint32();break;case Ae:var g=r[i][Ae].ReadUint32(),c=r[i][Zt].ReadByte();t[A][i]=mt(g,c);break;case de:t[A][i]=(t[o][i]>>0)+r[i][de].ReadByte();break;case he:var g=(t[o][i]>>0)+r[i][he].ReadByte(),c=t[o][i].length;t[A][i]=mt(g,c);break;case lt:t[A][i]=t[o][i];break;default:t[A][i]="";break}e[A]+=t[A][i++]}while(n!=Ie);return e[A]}function br(A,e,t){var A=new te(A);A.ReadUint32();var n=A.ReadUint32(),a=A.ReadByte(),o=Mr(A,e,a,n),i=new Array(n),g=new Array(n),c="";typeof t>"u"&&(t=`
`);for(var s=0;s<n;s++)c+=qr(o,i,g,s)+t;return c}function xr(r,e){var t=r.toString();t[t.length-1]==`
`&&(t=t.substring(0,t.length-1));var A=t.split(`
`),n=new te("",0,t.length*2+1e4);n.WriteUint32(t.length),n.WriteUint32(A.length),n.WriteByte(e);for(var a=new Array(A.length),o={},i=new Array(256).fill(0),g=0,c=0,s=0;s<A.length;s++){var[f,l]=Pr(a,o,i,A[s],s);g<f&&(g=f),c<l&&(c=l)}for(var d=0;d<g;d++){for(var C=new Array(Ie+1),h=0;h<=Ie;h++)C[h]=new te("",0,A.length*c);Lr(C,a,d,A),Ur(C,d,e,n)}return n.buf.slice(0,n.pos)}function Lr(r,e,t,A,n,a){for(var o=0;o<A.length;o++)if(!(t>0&&e[o][0].type==oe)&&e[o][t])switch(r[ce].WriteByte(e[o][t].type),e[o][t].type){case At:r[At].WriteUint32(e[o][t].val);break;case oe:r[oe].WriteUint32(e[o][t].val);break;case fe:r[fe].WriteString(e[o][t].val);break;case le:r[le].WriteChar(e[o][t].val);break;case re:r[re].WriteUint32(e[o][t].val);break;case Ae:r[Ae].WriteUint32(e[o][t].val),r[Zt].WriteByte(e[o][t].val.length);break;case de:r[e[o][t].type].WriteByte(e[o][t].val);break;case he:r[e[o][t].type].WriteByte(e[o][t].val);break}}function Ur(r,e,t,A){for(var n=0;n<=Ie;n++)if(!(r[n].pos<=0)){A.WriteByte(n+(n==0?128:0)),r[n]=r[n].buf.slice(0,r[n].pos);var a=Hr(r[n],t);A.WriteUint7(a.length),A.WriteData(a,a.length)}}function Hr(r,e){var t=1073741824,A,n=[0,1,64,65,128,129,201];for(var a in n){var o=n[a];if(!(o&1&&r.length<100)&&!(o&8&&r.length%4!=0)){try{var i=e?Xt.encode(r,o):Vt.encode(r,o)}catch{var i=0}i&&t>i.length&&(t=i.length,A=i)}}return A}function Pr(r,e,t,A,n){var a=0,o=n-1;r[n]=new Array(256),e[A]?r[n][0]={type:oe,val:n-e[A]}:r[n][0]={type:At,val:n==0?0:1},e[A]=n;for(var i=A.match(/([a-zA-Z0-9]{1,9})|([^a-zA-Z0-9]+)/g),g=0;g<i.length;g++){var c=g+1,s=fe,f=i[g];if(i[g].match(/^0+[0-9]*$/g)?s=Ae:i[g].match(/^[0-9]+$/g)?s=re:i[g].length==1&&(s=le),o>=0&&r[o][c]){if(r[o][c].str==i[g])s=lt,f="";else if(r[o][c].type==re||r[o][c].type==de){var l=f-r[o][c].str;t[c]++,l>=0&&l<256&&t[c]>n/2&&(s=de,f=l)}else if((r[o][c].type==Ae||r[o][c].type==he)&&r[o][c].str.length==f.length){var l=f-r[o][c].str;t[c]++,l>=0&&l<256&&t[c]>n/2&&(s=he,f=l)}}r[n][c]={str:i[g],val:f,type:s},a<r[n][c].val.length+3&&(a=r[n][c].val.length+3)}return r[n][++c]={type:Ie},[c+1,a]}var Or={encode:xr,decode:br},Gr=zA,Jr=Ot,Wr=Tt,Tr=kr,Yr=Or;function Kr(r,e){Gr.decode(r).copy(e,0,0)}function zr(r,e){Jr.decode(r).copy(e,0,0)}function $r(r,e){Wr.decode(r).copy(e,0,0)}function Vr(r,e){var t=new Array;Tr.decode(r,t).copy(e,0,0)}function Xr(r,e){var t=Yr.decode(r,0,"\0");Buffer.from(t,"binary").copy(e,0,0)}var Zr={r4x8_uncompress:Kr,r4x16_uncompress:zr,arith_uncompress:$r,fqzcomp_uncompress:Vr,tok3_uncompress:Xr};const me=it(Zr);var jt={exports:{}};/*!
 * Based on xzwasm (c) Steve Sanderson. License: MIT - https://github.com/SteveSanderson/xzwasm
 * Contains xz-embedded by Lasse Collin and Igor Pavlov. License: Public domain - https://tukaani.org/xz/embedded.html
 * and walloc (c) 2020 Igalia, S.L. License: MIT - https://github.com/wingo/walloc
 */(function(r,e){(function(A,n){r.exports=n(DA)})(uA,t=>(()=>{var A=[,i=>{i.exports="data:application/wasm;base64,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IgENAAsLIAJCf4UL1RACDH8CfgJAAkAgACgCJEUNACAAKAIAIQIMAQtBACECIABBADoAKCAAQgA3AwAgAEIANwMYIABByABqQQBB5AAQhoCAgAAaIABBrAFqQQw2AgALIAAgASgCBCIDNgIQIABBsAFqIQQgAEHgAGohBSAAQcgAaiEGIABBtgFqIQcgAEGoAWohCCABKAIQIQkCQAJAAkACQANAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAIAIOCgECAAQFBgcICQoPCyABKAIAIQogACgCqAEhAiAAKAKsASELIAEoAgQhDCABKAIIIQ0MAgsgCCAAKAKoASIMakEIaiABKAIAIAEoAgQiAmogASgCCCACayICIAAoAqwBIAxrIgwgAiAMSRsiAhCHgICAABogASABKAIEIAJqNgIEQQAhDCAAQQAgACgCqAEgAmoiAiACIAAoAqwBIgtGGzYCqAEgAiALRw0RIABBATYCAAJAIARBqIiAgABBBhCEgICAAEUNAEEFIQwMEgsgB0ECQQAQjYCAgAAgACgAuAFHDRBBBiEMIActAAANESAAIAAtALcBIgI2AiAgAkEESw0RQQEgAnRBE3FFDRELIAEoAgQiDCABKAIIIg1GDQ4CQCABKAIAIgogDGotAAAiCw0AIAAgDDYCECABIAxBAWo2AgRBBiECDAwLQQAhAiAAQQA2AqgBIABBAjYCACAAIAtBAnRBBGoiCzYCrAEgACALNgJACyAIIAJqQQhqIAogDGogDSAMayIMIAsgAmsiAiAMIAJJGyICEIeAgIAAGiABIAIgASgCBGo2AgRBACEMIABBACAAKAKoASACaiICIAIgACgCrAEiC0YbNgKoASACIAtHDQ8gACACQXxqIgI2AqwBQQchDCAEIAJBABCNgICAACAAIAAoAqwBIgtqQbABaigAAEcNDyAAQQI2AqgBIAAtALEBIgJBP3ENDAJAAkAgAkHAAHFFDQAgACAEIAggCxCRgICAAEEBRw0RIAAgACkDCDcDMCAALQCxASECDAELIABCfzcDMAtCfyEOAkAgAkEYdEEYdUF/Sg0AIAAgBCAIIAAoAqwBEJGAgIAAQQFHDRAgACkDCCEOCyAAIA43AzggACgCrAEiDSAAKAKoASICa0ECSQ0PIAAgAkEBaiIKNgKoASAIIAJqQQhq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IgM2AhAgACAOQQh0IAAoAgwgCWotAAByIg42AgQgAyEJCwJAAkAgDiALQQt2IA8vAQAiCmwiA08iEg0AIAAgAzYCACAKQYAQIAprQQV2aiEKDAELIAAgDiADayIONgIEIAAgCyADayIDNgIAIAogCkEFdmshCkEAIQ0LIA8gCjsBACANIBFzIQ0gBEEBdCASciIEQYACSQ0ACwsgACACQQFqNgIgIAAoAhggAmogBDoAAAJAIAAoAiQgACgCICICTw0AIAAgAjYCJAtBACEDAkAgACgCZCIEQQRJDQACQCAEQQlLDQAgBEF9aiEDDAELIARBemohAwsgACADNgJkDAELIAAgDiADayIONgIEIAAgBCADayIDNgIAIA0gDyAPQQV2azsBACAAIApBAXRqIg9B+ANqIQQCQAJAIANB////B00NACAJIQoMAQsgACADQQh0IgM2AgAgACAJQQFqIgo2AhAgACAOQQh0IAAoAgwgCWotAAByIg42AgQLAkACQCAOIANBC3YgBC8BACINbCIJSQ0AIAAgDiAJayIONgIEIAAgAyAJayIDNgIAIAQgDSANQQV2azsBACAPQZAEaiENAkACQCADQf///wdNDQAgCiEQDAELIAAgA0EIdCIDNgIAIAAgCkEBaiIQNgIQIAAgDkEIdCAAKAIMIApqLQAAciIONgIECwJAAkAgDiADQQt2IA0vAQAiCWwiBE8NACANIAlBgBAgCWtBBXZqOwEAIAxB2ARqIQMCQCAEQf///wdLDQAgACAEQQh0IgQ2AgAgACAQQQFqNgIQIAAgDkEIdCAAKAIMIBBqLQAAciIONgIECwJAIA4gBEELdiADLwEAIg1sIglJDQAgACAOIAlrNgIEIAAgBCAJazYCACADIA0gDUEFdms7AQAMAgsgAyANQYAQIA1rQQV2ajsBACAAIAk2AgAgAEEBNgJoIABBCUELIAAoAmRBB0kbNgJkDAMLIAAgDiAEayIONgIEIA0gCSAJQQV2azsBACAPQagEaiENAkACQCADIARrIgNB////B00NACAQIQoMAQsgACADQQh0IgM2AgAgACAQQQFqIgo2AhAgACAOQQh0IAAoAgwgEGotAAByIg42AgQLAkACQCAOIANBC3YgDS8BACIEbCIJTw0AIAAgCTYCACANIARBgBAgBGtBBXZqOwEAIAAoAlghAwwBCyAAIA4gCWsiDjYCBCANIAQgBEEFdms7AQAgD0HABGohBAJAIAMgCWsiA0H///8HSw0AIAAgA0EIdCIDNgIAIAAgCkEBajYCECAAIA5BCHQgACgCDCAKai0AAHIiDjYCBAsCQAJAIA4gA0ELdiAELwEAIg1sIglPDQAgACAJNgIAIAQgDUGAECANa0EFdmo7AQAgACgCXCEDDAELIAAgDiAJazYCBCAAIAMgCWs2AgAgACgCYCEDIAAgACgCXDYCYCAEIA0gDUEFdms7AQALIAAgACgCWDYCXAsgACAAKAJUNgJYIAAgAzYCVAsgAEEIQQsgACgCZEEHSRs2AmQgACAHIAsQn4CAgAAMAQsgBCANQYAQIA1rQQV2ajsBACAAIAk2AgAgACAAKAJcNgJgIAAgACkCVDcCWCAAQQdBCiAAKAJkQQdJGzYCZCAAIAUgCxCfgICAACAAKAJoIgNBfmpBAyADQQZJGyEKIAAoAgAhA0EBIQ4DQCAAIApBB3RqIA5BAXQiDmpB2AdqIQ0CQAJAIANBgICACEkNACAAKAIEIQQMAQsgACADQQh0IgM2AgAgACAAKAIQIgRBAWo2AhAgACAAKAIEQQh0IAQgACgCDGotAAByIgQ2AgQLAkACQCAEIANBC3YgDS8BACIJbCIPSQ0AIAAgBCAPayIENgIEIAAgAyAPayIDNgIAIA0gCSAJQQV2azsBACAOQQFyIQ4MAQsgACAPNgIAIA0gCUGAECAJa0EFdmo7AQAgDyEDCyAOQcAASQ0ACwJAIA5BQGoiCUEDSw0AIAAgCTYCVAwBCyAAIA5BAXFBAnIiDTYCVCAJQQF2IQ8CQCAJQQ1LDQAgACANIA9Bf2oiDHQiCzYCVEEBIQ0gCCALQQF0akGEC2ohEEE/IA5rIRFBACEPA0AgECARIA1qQQF0aiEOAkACQCADQf///wdNDQAgAyEKDAELIAAgA0EIdCIKNgIAIAAgACgCECIDQQFqNgIQIAAgBEEIdCADIAAoAgxqLQAAciIENgIECwJAAkAgBCAKQQt2IA4vAQAiCWwiA0kNACAAIAQgA2siBDYCBCAAIAogA2siAzYCACAOIAkgCUEFdms7AQAgAEEBIA90IAtqIgs2AlQgDUEBdEEBciENDAELIAAgAzYCACAOIAlBgBAgCWtBBXZqOwEAIA1BAXQhDQsgDCAPQQFqIg9HDQAMAgsLIA9Be2ohDgNAAkAgA0H///8HSw0AIAAgA0EIdCIDNgIAIAAgACgCECIJQQFqNgIQIARBCHQgCSAAKAIMai0AAHIhBAsgACADQQF2IgM2AgAgACAEIANrIgRBH3UiCSANQQF0akEBaiINNgJUIAAgCSADcSAEaiIENgIEIA5Bf2oiDg0ACyAAIA1BBHQiCzYCVEEAIQ9BASEOA0AgACAOQQF0Ig5qQbwNaiENAkACQCADQf///wdNDQAgAyEKDAELIAAgA0EIdCIKNgIAIAAgACgCECIDQQFqNgIQIAAgBEEIdCADIAAoAgxqLQAAciIENgIECwJAAkAgBCAKQQt2IA0vAQAiCWwiA0kNACAAIAQgA2siBDYCBCAAIAogA2siAzYCACANIAkgCUEFdms7AQAgAEEBIA90IAtqIgs2AlQgDkEBciEODAELIAAgAzYCACANIAlBgBAgCWtBBXZqOwEACyAPQQFqIg9BBEcNAAsLAkAgASAGIAAoAlQQnoCAgAANAEEADwsgACgCICECCyACIAAoAihJDQALC0EBIQMCQCAAKAIAIgRB////B0sNACAAIARBCHQ2AgBBASEDIAAgACgCECIEQQFqNgIQIAAgACgCBEEIdCAEIAAoAgxqLQAAcjYCBAsgAwtwAQF/AkBBqN4BEICAgIAAIgJFDQAgAkE0aiABNgIAIAJBPGogADYCAAJAAkACQCAAQX9qDgIAAQILIAIgARCAgICAACIANgIYIAANASACEIKAgIAADAILIAJBADYCGCACQThqQQA2AgALIAIPC0EAC9IBAQJ/QQYhAgJAIAFBJ0sNACAAQTBqIAFBAXFBAnIgAUEBdkELanQiATYCAAJAAkAgAEE8aigCACIDRQ0AQQQhAiABIABBNGooAgBLDQIgAEEsaiABNgIAIANBAkcNACAAQThqIgMoAgAgAU8NACAAIAE2AjggACgCGBCCgICAACAAIAAoAjAQgICAgAAiATYCGCABDQBBAyECDAELQQAhAiAAQQA2AkAgAEHQAGpBAToAACAAQegAakEANgIAIABB5N0BaiEDCyADQQA2AgALIAILIwACQCAAQTxqKAIARQ0AIAAoAhgQgoCAgAALIAAQgoCAgAAL9QEBBH9BACEDAkAgACgCDCACTQ0AIAAoAhggAk0NACABIAEoAgAiBCAAKAIQIAAoAggiBWsiBiAEIAYgBEkbIgRrNgIAIAUgAkF/c2ohAQJAIAUgAksNACAAKAIUIAFqIQELIAAoAgAiAiABai0AACEGQQEhAyAAIAVBAWo2AgggAiAFaiAGOgAAAkAgBEF/aiICRQ0AA0AgACgCACIFQQAgAUEBaiIBIAEgACgCFEYbIgFqLQAAIQQgACAAKAIIIgZBAWo2AgggBSAGaiAEOgAAIAJBf2oiAg0ACwsgACgCDCAAKAIIIgFPDQAgACABNgIMCyADC8gEAQd/AkACQCAAKAIAIgNBgICACEkNACAAKAIEIQQMAQsgACADQQh0IgM2AgAgACAAKAIQIgVBAWo2AhAgACAAKAIEQQh0IAUgACgCDGotAAByIgQ2AgQLAkACQCAEIANBC3YgAS8BACIGbCIFTw0AIAEgBkGAECAGa0EFdmo7AQAgASACQQR0akEEaiEHQQghCEECIQkMAQsgACAEIAVrIgQ2AgQgASAGIAZBBXZrOwEAAkAgAyAFayIDQf///wdLDQAgACADQQh0IgM2AgAgACAAKAIQIgVBAWo2AhAgACAEQQh0IAUgACgCDGotAAByIgQ2AgQLAkAgBCADQQt2IAEvAQIiBmwiBU8NACABIAZBgBAgBmtBBXZqOwECIAEgAkEEdGpBhAJqIQdBCCEIQQohCQwBCyAAIAQgBWsiBDYCBCABIAYgBkEFdms7AQIgAUGEBGohByADIAVrIQVBgAIhCEESIQkLIABB6ABqIAk2AgBBASEBA0AgByABQQF0IgFqIQMCQAJAIAVB////B00NACAFIQIMAQsgACAFQQh0IgI2AgAgACAAKAIQIgVBAWo2AhAgACAEQQh0IAUgACgCDGotAAByIgQ2AgQLAkACQCAEIAJBC3YgAy8BACIGbCIFSQ0AIAAgBCAFayIENgIEIAAgAiAFayIFNgIAIAMgBiAGQQV2azsBACABQQFyIQEMAQsgACAFNgIAIAMgBkGAECAGa0EFdmo7AQALIAEgCEkNAAsgAEHoAGogASAIayAJajYCAAsLNQEAQYAICy4IAAAAEAAAABgAAAAgAAAAKAAAADAAAABAAAAAUAAAAIAAAAAAAQAA/Td6WFoA"},i=>{i.exports=t}],n={};function a(i){var g=n[i];if(g!==void 0)return g.exports;var c=n[i]={exports:{}};return A[i](c,c.exports,a),c.exports}a.d=(i,g)=>{for(var c in g)a.o(g,c)&&!a.o(i,c)&&Object.defineProperty(i,c,{enumerable:!0,get:g[c]})},a.o=(i,g)=>Object.prototype.hasOwnProperty.call(i,g),a.r=i=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})};var o={};return(()=>{a.r(o),a.d(o,{XzReadableStream:()=>l});var i=a(1);const g=globalThis.ReadableStream||a(2).ReadableStream,c=0,s=1;class f{constructor(h){this.exports=h.exports,this.memory=this.exports.memory,this.ptr=this.exports.create_context(),this._refresh(),this.bufSize=this.mem32[0],this.inStart=this.mem32[1]-this.ptr,this.inEnd=this.inStart+this.bufSize,this.outStart=this.mem32[4]-this.ptr}supplyInput(h){this._refresh(),this.mem8.subarray(this.inStart,this.inEnd).set(h,0),this.exports.supply_input(this.ptr,h.byteLength),this._refresh()}getNextOutput(){const h=this.exports.get_next_output(this.ptr);if(this._refresh(),h!==c&&h!==s)throw new Error(`get_next_output failed with error code ${h}`);return{outChunk:this.mem8.slice(this.outStart,this.outStart+this.mem32[5]),finished:h===s}}needsMoreInput(){return this.mem32[2]===this.mem32[3]}outputBufferIsFull(){return this.mem32[5]===this.bufSize}resetOutputBuffer(){this.outPos=this.mem32[5]=0}dispose(){this.exports.destroy_context(this.ptr),this.exports=null}_refresh(){var h;this.memory.buffer!==((h=this.mem8)==null?void 0:h.buffer)&&(this.mem8=new Uint8Array(this.memory.buffer,this.ptr),this.mem32=new Uint32Array(this.memory.buffer,this.ptr))}}const d=class d extends g{static async _getModuleInstance(){const h=i.replace("data:application/wasm;base64,",""),I=Uint8Array.from(atob(h),v=>v.charCodeAt(0)).buffer,u={},B=await WebAssembly.instantiate(I,u);d._moduleInstance=B.instance}constructor(h){let I,u=null;const B=h.getReader();super({async start(v){d._moduleInstance||await(d._moduleInstancePromise||(d._moduleInstancePromise=d._getModuleInstance())),I=new f(d._moduleInstance)},async pull(v){if(I.needsMoreInput()){if(u===null||u.byteLength===0){const{done:y,value:k}=await B.read();y||(u=k)}const Q=Math.min(I.bufSize,u.byteLength);I.supplyInput(u.subarray(0,Q)),u=u.subarray(Q)}const w=I.getNextOutput();v.enqueue(w.outChunk),I.resetOutputBuffer(),w.finished&&(I.dispose(),v.close())},cancel(){return I.dispose(),B.cancel()}})}};Le(d,"_moduleInstancePromise"),Le(d,"_moduleInstance");let l=d})(),o})())})(jt);var jr=jt.exports;class eA extends Error{}class Y extends Error{}class D extends eA{}class en extends eA{}function tA(r){return P.Buffer.from(BA.inflate(r))}const S=12,se=1<<S,De=1<<23;class AA{constructor(){this.F=void 0,this.C=void 0}}class tn{constructor(){this.fc=new Array(256);for(let e=0;e<this.fc.length;e+=1)this.fc[e]=new AA;this.R=null}}class An{constructor(){this.start=void 0,this.freq=void 0}}function rn(r,e,t){if(!(e<=65536))throw new D("assertion failed: start <= 1<<16");if(!(t<=65536-e))throw new D("assertion failed: freq <= 1<<16");r.start=e,r.freq=t}function rA(r,e,t,A){const n=(1<<A)-1;return t*(r>>A)+(r&n)-e}function nn(r,e,t){return rA(r,e.start,e.freq,t)}function an(r,e){return r&(1<<e)-1}function on(r,e,t,A,n){const a=(1<<n)-1;if(r=A*(r>>n)+(r&a)-t,r<De)do{const o=255&e.get();r=r<<8|o}while(r<De);return r}function sn(r,e,t,A){return on(r,e,t.start,t.freq,A)}function gn(r,e){if(r<De)do r=r<<8|255&e.get();while(r<De);return r}const m={FC:AA,AriDecoder:tn,DecodingSymbol:An,symbolInit:rn,advanceStep:rA,advanceSymbolStep:nn,get:an,advanceSymbol:sn,renormalize:gn};function nA(r){if(!r)throw new D("assertion failed")}function cn(r,e,t){let A=0,n=0,a=r.get()&255;do e.fc[a]==null&&(e.fc[a]=new m.FC),e.fc[a].F=r.get()&255,e.fc[a].F>=128&&(e.fc[a].F&=-129,e.fc[a].F=(e.fc[a].F&127)<<8|r.get()&255),e.fc[a].C=n,m.symbolInit(t[a],e.fc[a].C,e.fc[a].F),e.R||(e.R=new Array(se)),e.R.fill(a,n,n+e.fc[a].F),n+=e.fc[a].F,A===0&&a+1===(255&r.getByteAt(r.position()))?(a=r.get()&255,A=r.get()&255):A!==0?(A-=1,a+=1):a=r.get()&255;while(a!==0);nA(n<se)}function fn(r,e,t){let A=0,n=255&r.get();do{let a=0,o=0,i=255&r.get();e[n]==null&&(e[n]=new m.AriDecoder);do e[n].fc[i]==null&&(e[n].fc[i]=new m.FC),e[n].fc[i].F=255&r.get(),e[n].fc[i].F>=128&&(e[n].fc[i].F&=-129,e[n].fc[i].F=(e[n].fc[i].F&127)<<8|255&r.get()),e[n].fc[i].C=o,e[n].fc[i].F===0&&(e[n].fc[i].F=se),t[n][i]==null&&(t[n][i]=new m.RansDecSymbol),m.symbolInit(t[n][i],e[n].fc[i].C,e[n].fc[i].F),e[n].R==null&&(e[n].R=new Array(se)),e[n].R.fill(i,o,o+e[n].fc[i].F),o+=e[n].fc[i].F,nA(o<=se),a===0&&i+1===(255&r.getByteAt(r.position()))?(i=255&r.get(),a=255&r.get()):a!==0?(a-=1,i+=1):i=255&r.get();while(i!==0);A===0&&n+1===(255&r.getByteAt(r.position()))?(n=255&r.get(),A=255&r.get()):A!==0?(A-=1,n+=1):n=255&r.get()}while(n!==0)}function ln(r,e,t,A){let n=r.getInt(),a=r.getInt(),o=r.getInt(),i=r.getInt();const g=A.remaining(),c=g&-4;for(let f=0;f<c;f+=4){const l=e.R[m.get(n,S)],d=e.R[m.get(a,S)],C=e.R[m.get(o,S)],h=e.R[m.get(i,S)];A.putAt(f,l),A.putAt(f+1,d),A.putAt(f+2,C),A.putAt(f+3,h),n=m.advanceSymbolStep(n,t[255&l],S),a=m.advanceSymbolStep(a,t[255&d],S),o=m.advanceSymbolStep(o,t[255&C],S),i=m.advanceSymbolStep(i,t[255&h],S),n=m.renormalize(n,r),a=m.renormalize(a,r),o=m.renormalize(o,r),i=m.renormalize(i,r)}A.setPosition(c);let s;switch(g&3){case 0:break;case 1:s=e.R[m.get(n,S)],m.advanceSymbol(n,r,t[255&s],S),A.put(s);break;case 2:s=e.R[m.get(n,S)],m.advanceSymbol(n,r,t[255&s],S),A.put(s),s=e.R[m.get(a,S)],m.advanceSymbol(a,r,t[255&s],S),A.put(s);break;case 3:s=e.R[m.get(n,S)],m.advanceSymbol(n,r,t[255&s],S),A.put(s),s=e.R[m.get(a,S)],m.advanceSymbol(a,r,t[255&s],S),A.put(s),s=e.R[m.get(o,S)],m.advanceSymbol(o,r,t[255&s],S),A.put(s);break;default:throw new D("invalid output size encountered during rANS decoding")}A.setPosition(0)}function dn(r,e,t,A){const n=e.remaining();let a=r.getInt(),o=r.getInt(),i=r.getInt(),g=r.getInt();const c=n>>2;let s=0,f=c,l=2*c,d=3*c,C=0,h=0,I=0,u=0;for(;s<c;s+=1,f+=1,l+=1,d+=1){const B=255&t[C].R[m.get(a,S)],v=255&t[h].R[m.get(o,S)],w=255&t[I].R[m.get(i,S)],Q=255&t[u].R[m.get(g,S)];e.putAt(s,B),e.putAt(f,v),e.putAt(l,w),e.putAt(d,Q),a=m.advanceSymbolStep(a,A[C][B],S),o=m.advanceSymbolStep(o,A[h][v],S),i=m.advanceSymbolStep(i,A[I][w],S),g=m.advanceSymbolStep(g,A[u][Q],S),a=m.renormalize(a,r),o=m.renormalize(o,r),i=m.renormalize(i,r),g=m.renormalize(g,r),C=B,h=v,I=w,u=Q}for(;d<n;d+=1){const B=255&t[u].R[m.get(g,S)];e.putAt(d,B),g=m.advanceSymbol(g,r,A[u][B],S),u=B}}const hn=4;function In(r,e){const t=new m.AriDecoder,A=new Array(256);for(let n=0;n<A.length;n+=1)A[n]=new m.DecodingSymbol;return cn(r,t,A),ln(r,t,A,e),e}function Cn(r,e){const t=new Array(256);for(let n=0;n<t.length;n+=1)t[n]=new m.AriDecoder;const A=new Array(256);for(let n=0;n<A.length;n+=1){A[n]=new Array(256);for(let a=0;a<A[n].length;a+=1)A[n][a]=new m.DecodingSymbol}return fn(r,t,A),dn(r,e,t,A),e}class yt{constructor(e,t=0){this._buffer=e,this._position=t,this.length=e.length}get(){const e=this._buffer[this._position];return this._position+=1,e}getByte(){return this.get()}getByteAt(e){return this._buffer[e]}position(){return this._position}put(e){return this._buffer[this._position]=e,this._position+=1,e}putAt(e,t){return this._buffer[e]=t,t}setPosition(e){return this._position=e,e}getInt(){const e=this._buffer.readInt32LE(this._position);return this._position+=4,e}remaining(){return this._buffer.length-this._position}}function un(r,e,t=0){if(r.length===0)return e.fill(0),e;const A=new yt(r,t),n=A.get();if(n!==0&&n!==1)throw new D(`Invalid rANS order ${n}`);if(A.getInt()!==A.remaining()-hn)throw new D("Incorrect input length.");const o=A.getInt(),i=new yt(e||P.Buffer.allocUnsafe(o));if(i.length<o)throw new D(`Output buffer too small to fit ${o} bytes.`);switch(n){case 0:return In(A,i);case 1:return Cn(A,i);default:throw new D(`Invalid rANS order: ${n}`)}}var aA={exports:{}},iA={exports:{}};(function(){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e={rotl:function(t,A){return t<<A|t>>>32-A},rotr:function(t,A){return t<<32-A|t>>>A},endian:function(t){if(t.constructor==Number)return e.rotl(t,8)&16711935|e.rotl(t,24)&4278255360;for(var A=0;A<t.length;A++)t[A]=e.endian(t[A]);return t},randomBytes:function(t){for(var A=[];t>0;t--)A.push(Math.floor(Math.random()*256));return A},bytesToWords:function(t){for(var A=[],n=0,a=0;n<t.length;n++,a+=8)A[a>>>5]|=t[n]<<24-a%32;return A},wordsToBytes:function(t){for(var A=[],n=0;n<t.length*32;n+=8)A.push(t[n>>>5]>>>24-n%32&255);return A},bytesToHex:function(t){for(var A=[],n=0;n<t.length;n++)A.push((t[n]>>>4).toString(16)),A.push((t[n]&15).toString(16));return A.join("")},hexToBytes:function(t){for(var A=[],n=0;n<t.length;n+=2)A.push(parseInt(t.substr(n,2),16));return A},bytesToBase64:function(t){for(var A=[],n=0;n<t.length;n+=3)for(var a=t[n]<<16|t[n+1]<<8|t[n+2],o=0;o<4;o++)n*8+o*6<=t.length*8?A.push(r.charAt(a>>>6*(3-o)&63)):A.push("=");return A.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/ig,"");for(var A=[],n=0,a=0;n<t.length;a=++n%4)a!=0&&A.push((r.indexOf(t.charAt(n-1))&Math.pow(2,-2*a+8)-1)<<a*2|r.indexOf(t.charAt(n))>>>6-a*2);return A}};iA.exports=e})();var Bn=iA.exports,rt={utf8:{stringToBytes:function(r){return rt.bin.stringToBytes(unescape(encodeURIComponent(r)))},bytesToString:function(r){return decodeURIComponent(escape(rt.bin.bytesToString(r)))}},bin:{stringToBytes:function(r){for(var e=[],t=0;t<r.length;t++)e.push(r.charCodeAt(t)&255);return e},bytesToString:function(r){for(var e=[],t=0;t<r.length;t++)e.push(String.fromCharCode(r[t]));return e.join("")}}},pt=rt;/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Qn=function(r){return r!=null&&(oA(r)||En(r)||!!r._isBuffer)};function oA(r){return!!r.constructor&&typeof r.constructor.isBuffer=="function"&&r.constructor.isBuffer(r)}function En(r){return typeof r.readFloatLE=="function"&&typeof r.slice=="function"&&oA(r.slice(0,0))}(function(){var r=Bn,e=pt.utf8,t=Qn,A=pt.bin,n=function(a,o){a.constructor==String?o&&o.encoding==="binary"?a=A.stringToBytes(a):a=e.stringToBytes(a):t(a)?a=Array.prototype.slice.call(a,0):!Array.isArray(a)&&a.constructor!==Uint8Array&&(a=a.toString());for(var i=r.bytesToWords(a),g=a.length*8,c=1732584193,s=-271733879,f=-1732584194,l=271733878,d=0;d<i.length;d++)i[d]=(i[d]<<8|i[d]>>>24)&16711935|(i[d]<<24|i[d]>>>8)&4278255360;i[g>>>5]|=128<<g%32,i[(g+64>>>9<<4)+14]=g;for(var C=n._ff,h=n._gg,I=n._hh,u=n._ii,d=0;d<i.length;d+=16){var B=c,v=s,w=f,Q=l;c=C(c,s,f,l,i[d+0],7,-680876936),l=C(l,c,s,f,i[d+1],12,-389564586),f=C(f,l,c,s,i[d+2],17,606105819),s=C(s,f,l,c,i[d+3],22,-1044525330),c=C(c,s,f,l,i[d+4],7,-176418897),l=C(l,c,s,f,i[d+5],12,1200080426),f=C(f,l,c,s,i[d+6],17,-1473231341),s=C(s,f,l,c,i[d+7],22,-45705983),c=C(c,s,f,l,i[d+8],7,1770035416),l=C(l,c,s,f,i[d+9],12,-1958414417),f=C(f,l,c,s,i[d+10],17,-42063),s=C(s,f,l,c,i[d+11],22,-1990404162),c=C(c,s,f,l,i[d+12],7,1804603682),l=C(l,c,s,f,i[d+13],12,-40341101),f=C(f,l,c,s,i[d+14],17,-1502002290),s=C(s,f,l,c,i[d+15],22,1236535329),c=h(c,s,f,l,i[d+1],5,-165796510),l=h(l,c,s,f,i[d+6],9,-1069501632),f=h(f,l,c,s,i[d+11],14,643717713),s=h(s,f,l,c,i[d+0],20,-373897302),c=h(c,s,f,l,i[d+5],5,-701558691),l=h(l,c,s,f,i[d+10],9,38016083),f=h(f,l,c,s,i[d+15],14,-660478335),s=h(s,f,l,c,i[d+4],20,-405537848),c=h(c,s,f,l,i[d+9],5,568446438),l=h(l,c,s,f,i[d+14],9,-1019803690),f=h(f,l,c,s,i[d+3],14,-187363961),s=h(s,f,l,c,i[d+8],20,1163531501),c=h(c,s,f,l,i[d+13],5,-1444681467),l=h(l,c,s,f,i[d+2],9,-51403784),f=h(f,l,c,s,i[d+7],14,1735328473),s=h(s,f,l,c,i[d+12],20,-1926607734),c=I(c,s,f,l,i[d+5],4,-378558),l=I(l,c,s,f,i[d+8],11,-2022574463),f=I(f,l,c,s,i[d+11],16,1839030562),s=I(s,f,l,c,i[d+14],23,-35309556),c=I(c,s,f,l,i[d+1],4,-1530992060),l=I(l,c,s,f,i[d+4],11,1272893353),f=I(f,l,c,s,i[d+7],16,-155497632),s=I(s,f,l,c,i[d+10],23,-1094730640),c=I(c,s,f,l,i[d+13],4,681279174),l=I(l,c,s,f,i[d+0],11,-358537222),f=I(f,l,c,s,i[d+3],16,-722521979),s=I(s,f,l,c,i[d+6],23,76029189),c=I(c,s,f,l,i[d+9],4,-640364487),l=I(l,c,s,f,i[d+12],11,-421815835),f=I(f,l,c,s,i[d+15],16,530742520),s=I(s,f,l,c,i[d+2],23,-995338651),c=u(c,s,f,l,i[d+0],6,-198630844),l=u(l,c,s,f,i[d+7],10,1126891415),f=u(f,l,c,s,i[d+14],15,-1416354905),s=u(s,f,l,c,i[d+5],21,-57434055),c=u(c,s,f,l,i[d+12],6,1700485571),l=u(l,c,s,f,i[d+3],10,-1894986606),f=u(f,l,c,s,i[d+10],15,-1051523),s=u(s,f,l,c,i[d+1],21,-2054922799),c=u(c,s,f,l,i[d+8],6,1873313359),l=u(l,c,s,f,i[d+15],10,-30611744),f=u(f,l,c,s,i[d+6],15,-1560198380),s=u(s,f,l,c,i[d+13],21,1309151649),c=u(c,s,f,l,i[d+4],6,-145523070),l=u(l,c,s,f,i[d+11],10,-1120210379),f=u(f,l,c,s,i[d+2],15,718787259),s=u(s,f,l,c,i[d+9],21,-343485551),c=c+B>>>0,s=s+v>>>0,f=f+w>>>0,l=l+Q>>>0}return r.endian([c,s,f,l])};n._ff=function(a,o,i,g,c,s,f){var l=a+(o&i|~o&g)+(c>>>0)+f;return(l<<s|l>>>32-s)+o},n._gg=function(a,o,i,g,c,s,f){var l=a+(o&g|i&~g)+(c>>>0)+f;return(l<<s|l>>>32-s)+o},n._hh=function(a,o,i,g,c,s,f){var l=a+(o^i^g)+(c>>>0)+f;return(l<<s|l>>>32-s)+o},n._ii=function(a,o,i,g,c,s,f){var l=a+(i^(o|~g))+(c>>>0)+f;return(l<<s|l>>>32-s)+o},n._blocksize=16,n._digestsize=16,aA.exports=function(a,o){if(a==null)throw new Error("Illegal argument "+a);var i=r.wordsToBytes(n(a,o));return o&&o.asBytes?i:o&&o.asString?A.bytesToString(i):r.bytesToHex(i)}})();var wn=aA.exports;const vn=it(wn);class Be extends Error{}function X(r,e,t){let A=0;if(e.bytePosition+(7-e.bitPosition+t)/8>r.length)throw new Be("read error during decoding. the file seems to be truncated.");for(let n=t;n;n--)A<<=1,A|=r[e.bytePosition]>>e.bitPosition&1,e.bitPosition-=1,e.bitPosition<0&&(e.bytePosition+=1),e.bitPosition&=7;return A}function mn(r){return r&-128?r&-16384?r&-2097152?r&-268435456?5:4:3:2:1}function E(r,e){let t=e;const A=r[t];let n;if(A<128?(n=A,t=t+1):A<192?(n=(A<<8|r[t+1])&16383,t=t+2):A<224?(n=(A<<16|r[t+1]<<8|r[t+2])&2097151,t=t+3):A<240?(n=(A<<24|r[t+1]<<16|r[t+2]<<8|r[t+3])&268435455,t=t+4):(n=(A&15)<<28|r[t+1]<<20|r[t+2]<<12|r[t+3]<<4|r[t+4]&15,t=t+5),t>r.length)throw new Be("Attempted to read beyond end of buffer; this file seems truncated.");return[n,t-e]}function _e(r,e){let t=e;const A=r[t];let n;if(A<128)n=A,t+=1;else if(A<192)n=(r[t]<<8|r[t+1])&16383,t+=2;else if(A<224)n=(r[t]<<16|r[t+1]<<8|r[t+2])&2097151,n=(A&63)<<16|r.readUInt16LE(t+1),t+=3;else if(A<240)n=(r[t]<<24|r[t+1]<<16|r[t+2]<<8|r[t+3])&268435455,t+=4;else if(A<248)n=(r[t]&15)*2**32+(r[t+1]<<24)|(r[t+2]<<16|r[t+3]<<8|r[t+4]),t+=5;else if(A<252)n=((r[t]&7)<<8|r[t+1])*2**32+(r[t+2]<<24)|(r[t+3]<<16|r[t+4]<<8|r[t+5]),t+=6;else if(A<254)n=((r[t]&3)<<16|r[t+1]<<8|r[t+2])*2**32+(r[t+3]<<24)|(r[t+4]<<16|r[t+5]<<8|r[t+6]),t+=7;else if(A<255){if(n=It.fromBytesBE(r.slice(t+1,t+8)),n.greaterThan(Number.MAX_SAFE_INTEGER)||n.lessThan(Number.MIN_SAFE_INTEGER))throw new Error("integer overflow");n=n.toNumber(),t+=8}else{if(n=It.fromBytesBE(r.slice(t+1,t+9)),n.greaterThan(Number.MAX_SAFE_INTEGER)||n.lessThan(Number.MIN_SAFE_INTEGER))throw new Error("integer overflow");n=n.toNumber(),t+=9}return[n,t-e]}function Z(r,e,t=0,A=0){const{offset:n,value:a}=e(r,t);return{...a,_endPosition:n+A,_size:n-t}}function Ne(r,e){const t=r.prototype[e],A=`_memo_${e}`;r.prototype[e]=function(){if(!(A in this)){const a=t.call(this);this[A]=a,Promise.resolve(a).catch(()=>{delete this[A]})}return this[A]}}function yn(r){return vn(r.toUpperCase().replaceAll(/[^\u0021-\u007e]/g,""))}function sA(){return{parser:(r,e=0)=>{const t=r,A=new DataView(t.buffer,t.byteOffset,t.length);let n=0;const a=r.subarray(n,n+4).toString();n+=4;const o=A.getUint8(n);n+=1;const i=A.getUint8(n);n+=1;const g=t.subarray(n,n+20).toString().replaceAll("\0","");return n+=20,{value:{magic:a,majorVersion:o,minorVersion:i,fileId:g},offset:n}},maxLength:26}}function pn(){return{parser:(e,t=0)=>{const A=e,n=new DataView(A.buffer,A.byteOffset,A.length);let a=0;const o=n.getUint8(a),i=["raw","gzip","bzip2","lzma","rans","rans4x16","arith","fqzcomp","tok3"][o];if(!i)throw new Error(`compression method number ${o} not implemented`);a+=1;const g=n.getUint8(a),c=["FILE_HEADER","COMPRESSION_HEADER","MAPPED_SLICE_HEADER","UNMAPPED_SLICE_HEADER","EXTERNAL_DATA","CORE_DATA"][g];if(!c)throw new Error(`invalid block content type id ${g}`);a+=1;const[s,f]=E(e,a);a+=f;const[l,d]=E(e,a);a+=d;const[C,h]=E(e,a);return a+=h,{offset:a,value:{uncompressedSize:C,compressedSize:l,contentId:s,contentType:c,compressionMethod:i}}},maxLength:17}}function Sn(){return{parser:(r,e)=>{const t=r,n=new DataView(t.buffer,t.byteOffset,t.length).getUint32(e,!0);return e+=4,{offset:e,value:{crc32:n}}},maxLength:4}}function St(r,e,t){const A=r.toString("utf8",e,t),n=[];for(let a=0;a<A.length;a+=3)n.push(A.slice(a,a+3));return n}function Dn(){return{parser:(r,e)=>{const[t,A]=E(r,e);e+=A;const n=r.subarray(e,e+t);e+=t;const a=[];let o=0,i=0;for(;i<n.length;i++)n[i]||(a.push(St(n,o,i)),o=i+1);return i>o&&a.push(St(n,o,i)),{value:{size:t,ents:a},offset:e}}}}function _n(){return{parser:(r,e)=>{const t=r,A=new DataView(t.buffer,t.byteOffset,t.length),[n,a]=E(r,e);e+=a;const[o,i]=E(r,e);e+=i;const g=[];for(let c=0;c<o;c++){const s=String.fromCharCode(r[e])+String.fromCharCode(r[e+1]);if(e+=2,s==="MI"||s==="UI"||s==="PI"||s==="RN"||s==="AP"||s==="RR")g.push({key:s,value:!!A.getUint8(e)}),e+=1;else if(s==="SM")g.push({key:s,value:[A.getUint8(e),A.getUint8(e+1),A.getUint8(e+2),A.getUint8(e+3),A.getUint8(e+4)]}),e+=5;else if(s==="TD"){const{offset:f,value:l}=Dn().parser(r,e);g.push({key:s,value:l.ents}),e=f}else throw new Error(`unknown key ${s}`)}return{value:{mapSize:n,mapCount:o,ents:g},offset:e}}}}function Oe(r){const e={};for(const{key:t,value:A}of r.ents)e[t]&&console.warn(`duplicate key ${t} in map`),e[t]=A;return e}function ie(r){return typeof r.refSeqId=="number"}function Rn(r){let e=0;return e+=5,e+=9,e+=5*2,e+=16,{parser:(A,n)=>{const[a,o]=E(A,n);n+=o;let i=0;if(r>=3){const[C,h]=_e(A,n);n+=h,i=C}else if(r===2){const[C,h]=E(A,n);n+=h,i=C}else console.warn("recordCounter=0");const[g,c]=E(A,n);n+=c;const[s,f]=E(A,n);n+=f;const l=[];for(let C=0;C<s;C++){const[h,I]=E(A,n);n+=I,l.push(h)}let d;return r>=2&&(d=[...A.subarray(n,n+16)],n+=16),{value:{recordCounter:i,md5:d,contentIds:l,numContentIds:s,numBlocks:g,numRecords:a},offset:n}},maxLength:A=>e+A*5}}function Nn(r){let e=0;return e+=5*4,e+=9,e+=5*3,e+=16,{parser:(t,A)=>{const[n,a]=E(t,A);A+=a;const[o,i]=E(t,A);A+=i;const[g,c]=E(t,A);A+=c;const[s,f]=E(t,A);A+=f;let l=0;if(r>=3){const[Q,y]=_e(t,A);A+=y,l=Q}else if(r===2){const[Q,y]=E(t,A);A+=y,l=Q}else console.warn("majorVersion is <2, recordCounter set to 0");const[d,C]=E(t,A);A+=C;const[h,I]=E(t,A);A+=I;const u=[];for(let Q=0;Q<h;Q++){const[y,k]=E(t,A);A+=k,u.push(y)}const[B,v]=E(t,A);A+=v;let w;return r>=2&&(w=[...t.subarray(A,A+16)],A+=16),{value:{md5:w,numBlocks:d,numRecords:s,numContentIds:h,refSeqSpan:g,refSeqId:n,refSeqStart:o,recordCounter:l,refBaseBlockId:B,contentIds:u},offset:A}},maxLength:t=>e+t*5}}function kn(){return{parser:(r,e)=>Ce(r,e)}}function Ce(r,e){const t=r,A=new DataView(t.buffer,t.byteOffset,t.length),[n,a]=E(r,e);e+=a;const[o,i]=E(r,e);e+=i;const g={};if(n!==0)if(n===1){const[c,s]=E(r,e);g.blockContentId=c,e+=s}else if(n===2){const[c,s]=E(r,e);g.offset=c,e+=s;const[f,l]=E(r,e);g.M=f,e+=l}else if(n===3){const c=E(r,e),s=c[0];e+=c[1];const f=[];for(let h=0;h<s;h++){const I=E(r,e);f.push(I[0]),e+=I[1]}g.symbols=f;const l=E(r,e),d=c[0];g.numLengths=d,g.numCodes=s,g.numLengths=d,e+=l[1];const C=[];for(let h=0;h<d;h++){const I=E(r,e);e+=I[1],C.push(I[0])}g.bitLengths=C}else if(n===4){const{value:c,offset:s}=Ce(r,e);g.lengthsEncoding=c,e=s;const{value:f,offset:l}=Ce(r,e);g.valuesEncoding=f,e=l}else if(n===5){g.stopByte=A.getUint8(e),e+=1;const[c,s]=E(r,e);g.blockContentId=c,e+=s}else if(n===6){const[c,s]=E(r,e);g.offset=c,e+=s;const[f,l]=E(r,e);g.length=f,e+=l}else if(n===7){const[c,s]=E(r,e);g.offset=c,e+=s;const[f,l]=E(r,e);g.K=f,e+=l}else if(n===8){const[c,s]=E(r,e);g.offset=c,e+=s;const[f,l]=E(r,e);g.log2m=f,e+=l}else if(n===9){const[c,s]=E(r,e);g.offset=c,e+=s}else throw new Error(`unknown codecId ${n}`);return{value:{codecId:n,parametersBytes:o,parameters:g},offset:e}}function gA(){return{parser:(r,e)=>{const[t,A]=E(r,e);e+=A;const[n,a]=E(r,e);e+=a;const o=[];for(let i=0;i<n;i++){const g=String.fromCharCode(r[e])+String.fromCharCode(r[e+1]);e+=2;const{value:c,offset:s}=Ce(r,e);e=s,o.push({key:g,value:c})}return{value:{mapSize:t,ents:o,mapCount:n},offset:e}}}}function cA(){return{parser:(r,e)=>{const[t,A]=E(r,e);e+=A;const[n,a]=E(r,e);e+=a;const o=[];for(let i=0;i<n;i++){const[g,c]=E(r,e);e+=c;const s=String.fromCharCode(g>>16&255)+String.fromCharCode(g>>8&255)+String.fromCharCode(g&255),{value:f,offset:l}=Ce(r,e);e=l,o.push({key:s,value:f})}return{value:{mapSize:t,ents:o,mapCount:n},offset:e}}}}function Fn(){return{parser:(r,e)=>{const{value:t,offset:A}=_n().parser(r,e);e=A;const{value:n,offset:a}=gA().parser(r,e);e=a;const{value:o,offset:i}=cA().parser(r,e);return e=i,{value:{dataSeriesEncoding:Oe(n),preservation:Oe(t),tagEncoding:Oe(o)},offset:e}}}}function Mn(r){let e=4;return e+=5*4,e+=9,e+=9,e+=10,{maxLength:e,parser:(t,A)=>{const n=t,o=new DataView(n.buffer,n.byteOffset,n.length).getInt32(A,!0);A+=4;const[i,g]=E(t,A);A+=g;const[c,s]=E(t,A);A+=s;const[f,l]=E(t,A);A+=l;const[d,C]=E(t,A);A+=C;let h=0;if(r>=3){const[Q,y]=_e(t,A);h=Q,A+=y}else if(r===2){const[Q,y]=E(t,A);h=Q,A+=y}else console.warn("setting recordCounter=0");let I;if(r>1){const[Q,y]=_e(t,A);I=Q,A+=y}const[u,B]=E(t,A);A+=B;const[v,w]=E(t,A);return A+=w,{value:{length:o,refSeqId:i,refSeqStart:c,alignmentSpan:f,numBlocks:u,numLandmarks:v,numBases:I,recordCounter:h,numRecords:d},offset:A}}}}function qn(r){return{parser:(e,t)=>{const A=e,n=new DataView(A.buffer,A.byteOffset,A.length),[a,o]=E(e,t);t+=o;const i=[];for(let c=0;c<a;c++){const[s,f]=E(e,t);t+=f,i.push(s)}let g;return r>=3&&(g=n.getUint32(t,!0),t+=4),{value:{...g===void 0?{}:{crc32:g},numLandmarks:a,landmarks:i},offset:t}},maxLength:e=>5+5*e+4}}function $(r){return{cramFileDefinition:sA(),cramBlockHeader:pn(),cramBlockCrc32:Sn(),cramDataSeriesEncodingMap:gA(),cramTagEncodingMap:cA(),cramCompressionHeader:Fn(),cramEncoding:kn(),cramUnmappedSliceHeader:Rn(r),cramMappedSliceHeader:Nn(r),cramContainerHeader1:Mn(r),cramContainerHeader2:qn(r)}}function Re(r){let e="";for(let t=0;t<r.length&&r[t]!==0;t++)e+=String.fromCharCode(r[t]);return e}function bn(r){const e=String.fromCharCode(r[0]),n=new DataView(r.buffer).getUint32(1,!0),a=new Array(n);if(r=r.slice(5),e==="c"){const o=new Int8Array(r.buffer);for(let i=0;i<n;i+=1)a[i]=o[i]}else if(e==="C"){const o=new Uint8Array(r.buffer);for(let i=0;i<n;i+=1)a[i]=o[i]}else if(e==="s"){const o=new Int16Array(r.buffer);for(let i=0;i<n;i+=1)a[i]=o[i]}else if(e==="S"){const o=new Uint16Array(r.buffer);for(let i=0;i<n;i+=1)a[i]=o[i]}else if(e==="i"){const o=new Int32Array(r.buffer);for(let i=0;i<n;i+=1)a[i]=o[i]}else if(e==="I"){const o=new Uint32Array(r.buffer);for(let i=0;i<n;i+=1)a[i]=o[i]}else if(e==="f"){const o=new Float32Array(r.buffer);for(let i=0;i<n;i+=1)a[i]=o[i]}else throw new Error(`unknown type: ${e}`);return a}function xn(r,e){if(r==="Z")return Re(e);if(r==="A")return String.fromCharCode(e[0]);if(r==="I")return new Uint32Array(e.buffer)[0];if(r==="i")return new Int32Array(e.buffer)[0];if(r==="s")return new Int16Array(e.buffer)[0];if(r==="S")return new Uint16Array(e.buffer)[0];if(r==="c")return new Int8Array(e.buffer)[0];if(r==="C")return e[0];if(r==="f")return new Float32Array(e.buffer)[0];if(r==="H")return Number.parseInt(Re(e).replace(/^0x/,""),16);if(r==="B")return bn(e);throw new D(`Unrecognized tag type ${r}`)}function Ln(r,e,t,A,n){let a=0,o=r-1;const i=new Array(e);function g([c,s]){const f=t(s);if(c==="character")return String.fromCharCode(f);if(c==="string"){let l="";for(let d=0;d<f.byteLength;d++)l+=String.fromCharCode(f[d]);return l}return c==="numArray"?f.toArray():f}for(let c=0;c<e;c+=1){const s=String.fromCharCode(t("FC")),f=t("FP"),l={B:["character","BA"],S:["string",n>1?"SC":"IN"],X:["number","BS"],D:["number","DL"],I:["string","IN"],i:["character","BA"],b:["string","BB"],q:["numArray","QQ"],Q:["number","QS"],H:["number","HC"],P:["number","PD"],N:["number","RS"]}[s];if(!l)throw new D(`invalid read feature code "${s}"`);let d=g(l);const C={B:["number","QS"]}[s];C&&(d=[d,g(C)]),a+=f;const h=a;o+=f;const I=o;s==="D"||s==="N"?o+=d:s==="I"||s==="S"?o-=d.length:s==="i"&&(o-=1),i[c]={code:s,pos:h,refPos:I,data:d}}return i}function Un(r,e,t,A,n,a,o,i,g){let c=e("BF");const s=e("CF");if(!ie(A.parsedContent))throw new Error("slice header not mapped");const f=i>1&&A.parsedContent.refSeqId===-2?e("RI"):A.parsedContent.refSeqId,l=e("RL");let d=e("AP");t.APdelta&&(d=d+o.lastAlignmentStart),o.lastAlignmentStart=d;const C=e("RG");let h;t.readNamesIncluded&&(h=Re(e("RN")));let I,u,B;if(ae.isDetached(s)){const R=e("MF");let p;t.readNamesIncluded||(p=Re(e("RN")),h=p);const L=e("NS"),U=e("NP");(R||L>-1)&&(I={mateFlags:R,mateSequenceId:L,mateAlignmentStart:U,mateReadName:p}),u=e("TS"),ut.isUnmapped(R)&&(c=Ue.setMateUnmapped(c)),ut.isOnNegativeStrand(R)&&(c=Ue.setMateReverseComplemented(c))}else ae.isWithMateDownstream(s)&&(B=e("NF")+g+1);const v=e("TL");if(v<0)throw new D("invalid TL index");const w={},Q=t.getTagNames(v),y=Q.length;for(let R=0;R<y;R+=1){const p=Q[R],L=p.slice(0,2),U=p.slice(2,3),b=t.getCodecForTag(p).decode(r,n,a,o);w[L]=typeof b=="number"?b:xn(U,b)}let k,_,q,N,O;if(Ue.isSegmentUnmapped(c))if(ae.isDecodeSequenceAsStar(s))O=null,N=null;else{const R=new Array(l);for(let p=0;p<R.length;p+=1)R[p]=e("BA");if(O=String.fromCharCode(...R),ae.isPreservingQualityScores(s)){N=new Array(l);for(let p=0;p<R.length;p+=1)N[p]=e("QS")}}else{const R=e("FN");if(R&&(k=Ln(d,R,e,t,i)),_=l,k)for(const{code:p,data:L}of k)p==="D"||p==="N"?_+=L:p==="I"||p==="S"?_=_-L.length:p==="i"&&(_=_-1);if(Number.isNaN(_)&&(console.warn(`${h||`${f}:${d}`} record has invalid read features`),_=l),q=e("MQ"),ae.isPreservingQualityScores(s)){N=new Array(l);for(let p=0;p<N.length;p++)N[p]=e("QS")}}return{readLength:l,sequenceId:f,cramFlags:s,flags:c,alignmentStart:d,readGroupId:C,readName:h,mateToUse:I,templateSize:u,mateRecordNumber:B,readFeatures:k,lengthOnRef:_,mappingQuality:q,qualityScores:N,readBases:O,tags:w}}function Hn(r,e,t){function A(g){const c=[g];if(g.mateRecordNumber!==void 0&&g.mateRecordNumber>=0){const s=r[g.mateRecordNumber];if(!s)throw new D("intra-slice mate record not found, this file seems malformed");c.push(...A(s))}return c}const n=A(t),a=n.map(g=>g.alignmentStart),o=n.map(g=>g.alignmentStart+g.readLength-1),i=Math.max(...o)-Math.min(...a)+1;i>=0&&n.forEach(g=>{if(g.templateLength!==void 0)throw new D("mate pair group has some members that have template lengths already, this file seems malformed");g.templateLength=i})}function Pn(r,e){const t=Math.min(r.alignmentStart,e.alignmentStart),n=Math.max(r.alignmentStart+r.readLength-1,e.alignmentStart+e.readLength-1)-t+1;r.templateLength=n,e.templateLength=n}function On(r,e,t,A){const n=!!(A.mate||A.mateRecordNumber!==void 0&&A.mateRecordNumber!==e);t.readName||(t.readName=String(t.uniqueId),A.readName=t.readName),t.mate={sequenceId:A.sequenceId,alignmentStart:A.alignmentStart,uniqueId:A.uniqueId},A.readName&&(t.mate.readName=A.readName),!A.mate&&A.mateRecordNumber===void 0&&(A.mate={sequenceId:t.sequenceId,alignmentStart:t.alignmentStart,uniqueId:t.uniqueId},t.readName&&(A.mate.readName=t.readName)),t.flags|=M.BAM_FPAIRED,A.flags&M.BAM_FUNMAP&&(t.flags|=M.BAM_FMUNMAP),t.flags&M.BAM_FUNMAP&&(A.flags|=M.BAM_FMUNMAP),A.flags&M.BAM_FREVERSE&&(t.flags|=M.BAM_FMREVERSE),t.flags&M.BAM_FREVERSE&&(A.flags|=M.BAM_FMREVERSE),t.templateLength===void 0&&(n?Hn(r,e,t):Pn(t,A)),t.mateRecordNumber=void 0}class fA{constructor(e,t,A){this.container=e,this.containerPosition=t,this.sliceSize=A,this.file=e.file}async getHeader(){const{majorVersion:e}=await this.file.getDefinition(),t=$(e),A=await this.container.getHeader();if(!A)throw new Error("no container header detected");const n=await this.file.readBlock(A._endPosition+this.containerPosition);if(n===void 0)throw new Error("block header undefined");if(n.contentType==="MAPPED_SLICE_HEADER"){const a=Z(n.content,t.cramMappedSliceHeader.parser,0,A._endPosition);return{...n,parsedContent:a}}else if(n.contentType==="UNMAPPED_SLICE_HEADER"){const a=Z(n.content,t.cramUnmappedSliceHeader.parser,0,A._endPosition);return{...n,parsedContent:a}}else throw new D(`error reading slice header block, invalid content type ${n.contentType}`)}async getBlocks(){const e=await this.getHeader();let t=e._endPosition;const A=new Array(e.parsedContent.numBlocks);for(let n=0;n<A.length;n++){const a=await this.file.readBlock(t);if(a===void 0)throw new Error("block undefined");A[n]=a,t=A[n]._endPosition}return A}async getCoreDataBlock(){return(await this.getBlocks())[0]}async _getBlocksContentIdIndex(){const e=await this.getBlocks(),t={};return e.forEach(A=>{A.contentType==="EXTERNAL_DATA"&&(t[A.contentId]=A)}),t}async getBlockByContentId(e){return(await this._getBlocksContentIdIndex())[e]}async getReferenceRegion(){const e=(await this.getHeader()).parsedContent;if(!ie(e))throw new Error("slice header not mapped");if(e.refSeqId<0)return;const t=await this.container.getCompressionScheme();if(t===void 0)throw new Error("compression scheme undefined");if(e.refBaseBlockId>=0){const A=await this.getBlockByContentId(e.refBaseBlockId);if(!A)throw new D("embedded reference specified, but reference block does not exist");return{seq:A.data.toString("utf8"),start:e.refSeqStart,end:e.refSeqStart+e.refSeqSpan-1,span:e.refSeqSpan}}if(t.referenceRequired||this.file.fetchReferenceSequenceCallback){if(!this.file.fetchReferenceSequenceCallback)throw new Error("reference sequence not embedded, and seqFetch callback not provided, cannot fetch reference sequence");const A=await this.file.fetchReferenceSequenceCallback(e.refSeqId,e.refSeqStart,e.refSeqStart+e.refSeqSpan-1);if(A.length!==e.refSeqSpan)throw new en("seqFetch callback returned a reference sequence of the wrong length");return{seq:A,start:e.refSeqStart,end:e.refSeqStart+e.refSeqSpan-1,span:e.refSeqSpan}}}getAllRecords(){return this.getRecords(()=>!0)}async _fetchRecords(){var e,t;const{majorVersion:A}=await this.file.getDefinition(),n=await this.container.getCompressionScheme();if(n===void 0)throw new Error("compression scheme undefined");const a=await this.getHeader(),o=await this._getBlocksContentIdIndex();if(A>1&&this.file.options.checkSequenceMD5&&ie(a.parsedContent)&&a.parsedContent.refSeqId>=0&&((e=a.parsedContent.md5)===null||e===void 0?void 0:e.join(""))!=="0000000000000000"){const f=await this.getReferenceRegion();if(f){const{seq:l,start:d,end:C}=f,h=yn(l),I=(t=a.parsedContent.md5)===null||t===void 0?void 0:t.map(u=>(u<16?"0":"")+u.toString(16)).join("");if(h!==I)throw new D(`MD5 checksum reference mismatch for ref ${a.parsedContent.refSeqId} pos ${d}..${C}. recorded MD5: ${I}, calculated MD5: ${h}`)}}const i=await this.getCoreDataBlock(),g={lastAlignmentStart:ie(a.parsedContent)?a.parsedContent.refSeqStart:0,coreBlock:{bitPosition:7,bytePosition:0},externalBlocks:{map:new Map,getCursor(f){let l=this.map.get(f);return l===void 0&&(l={bitPosition:7,bytePosition:0},this.map.set(f,l)),l}}},c=f=>{const l=n.getCodecForDataSeries(f);if(!l)throw new D(`no codec defined for ${f} data series`);return l.decode(this,i,o,g)},s=new Array(a.parsedContent.numRecords);for(let f=0;f<s.length;f+=1)try{const l=Un(this,c,n,a,i,o,g,A,f);s[f]=new qA({...l,uniqueId:a.contentPosition+a.parsedContent.recordCounter+f+1})}catch(l){if(l instanceof Be){console.warn("read attempted beyond end of buffer, file seems truncated.");break}else throw l}for(let f=0;f<s.length;f+=1){const{mateRecordNumber:l}=s[f];l!==void 0&&l>=0&&On(s,f,s[f],s[l])}return s}async getRecords(e){const t=this.container.filePosition+this.containerPosition;let A=this.file.featureCache.get(t.toString());A||(A=this._fetchRecords(),this.file.featureCache.set(t.toString(),A));const a=(await A).filter(e);if(a.length&&this.file.fetchReferenceSequenceCallback){const o=await this.getHeader();if(ie(o.parsedContent)&&(o.parsedContent.refSeqId>=0||o.parsedContent.refSeqId===-2)){const i=o.parsedContent.refSeqId>=0?o.parsedContent.refSeqId:void 0,g=await this.container.getCompressionScheme();if(g===void 0)throw new Error("compression scheme undefined");const c={};for(const s of a){const f=i!==void 0?i:s.sequenceId;let l=c[f];l||(l={id:f,start:s.alignmentStart,end:Number.NEGATIVE_INFINITY,seq:null},c[f]=l);const d=s.alignmentStart+(s.lengthOnRef||s.readLength)-1;d>l.end&&(l.end=d),s.alignmentStart<l.start&&(l.start=s.alignmentStart)}await Promise.all(Object.values(c).map(async s=>{s.id!==-1&&s.start<=s.end&&this.file.fetchReferenceSequenceCallback&&(s.seq=await this.file.fetchReferenceSequenceCallback(s.id,s.start,s.end))}));for(const s of a){const f=i!==void 0?i:s.sequenceId,l=c[f];if(l!=null&&l.seq){const d=l.seq;s.addReferenceSequence({...l,seq:d},g)}}}}return a}}"getHeader getBlocks _getBlocksContentIdIndex".split(" ").forEach(r=>{Ne(fA,r)});class j{constructor(e,t){this.parameters=e,this.dataType=t}}function Gn(r){let e=r-(r>>1)&1431655765;return e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>24}class Jn extends j{constructor(e,t){if(super(e,t),this.codes={},this.codeBook={},this.sortedCodes=[],this.sortedValuesByBitCode=[],this.sortedBitCodes=[],this.sortedBitLengthsByBitCode=[],this.bitCodeToValue=[],!["byte","int"].includes(this.dataType))throw new TypeError(`${this.dataType} decoding not yet implemented by HUFFMAN_INT codec`);this.buildCodeBook(),this.buildCodes(),this.buildCaches(),this.sortedCodes[0].bitLength===0&&(this._decode=this._decodeZeroLengthCode)}buildCodeBook(){let e=new Array(this.parameters.numCodes);for(let t=0;t<this.parameters.numCodes;t++)e[t]={symbol:this.parameters.symbols[t],bitLength:this.parameters.bitLengths[t]};e=e.sort((t,A)=>t.bitLength-A.bitLength||t.symbol-A.symbol),this.codeBook={},e.forEach(t=>{this.codeBook[t.bitLength]||(this.codeBook[t.bitLength]=[]),this.codeBook[t.bitLength].push(t.symbol)})}buildCodes(){this.codes={};let e=0,t=-1;Object.entries(this.codeBook).forEach(([A,n])=>{const a=Number.parseInt(A,10);n.forEach(o=>{const i={bitLength:a,value:o,bitCode:0};t=t+1;const g=a-e;if(t=t<<g,i.bitCode=t,e=e+g,Gn(t)>a)throw new D("Symbol out of range");this.codes[o]=i})})}buildCaches(){this.sortedCodes=Object.values(this.codes).sort((t,A)=>t.bitLength-A.bitLength||t.bitCode-A.bitCode),this.sortedValuesByBitCode=this.sortedCodes.map(t=>t.value),this.sortedBitCodes=this.sortedCodes.map(t=>t.bitCode),this.sortedBitLengthsByBitCode=this.sortedCodes.map(t=>t.bitLength);const e=Math.max(...this.sortedBitCodes);this.bitCodeToValue=new Array(e+1).fill(-1);for(let t=0;t<this.sortedBitCodes.length;t+=1)this.bitCodeToValue[this.sortedCodes[t].bitCode]=t}decode(e,t,A,n){return this._decode(e,t,n.coreBlock)}_decodeZeroLengthCode(){return this.sortedCodes[0].value}_decode(e,t,A){const n=t.content;let a=0,o=0;for(let i=0;i<this.sortedCodes.length;i+=1){const g=this.sortedCodes[i].bitLength;o<<=g-a,o|=X(n,A,g-a),a=g;{const c=this.bitCodeToValue[o];if(c>-1&&this.sortedBitLengthsByBitCode[c]===g)return this.sortedValuesByBitCode[c];for(let s=i;this.sortedCodes[s+1].bitLength===g&&s<this.sortedCodes.length;s+=1)i+=1}}throw new D("Huffman symbol not found.")}}class Wn extends j{constructor(e,t){if(super(e,t),this.dataType==="int")this._decodeData=this._decodeInt;else if(this.dataType==="byte")this._decodeData=this._decodeByte;else throw new Y(`${this.dataType} decoding not yet implemented by EXTERNAL codec`)}decode(e,t,A,n){const{blockContentId:a}=this.parameters,o=A[a];if(!o)throw new D(`no block found with content ID ${a}}`);const i=n.externalBlocks.getCursor(a);return this._decodeData(o,i)}_decodeInt(e,t){const[A,n]=E(e.content,t.bytePosition);return t.bytePosition=t.bytePosition+n,A}_decodeByte(e,t){if(t.bytePosition>=e.content.length)throw new Be("attempted to read beyond end of block. this file seems truncated.");return e.content[t.bytePosition++]}}let Tn=class extends j{decode(e,t,A,n){const{blockContentId:a}=this.parameters,o=A[a];if(!o)throw new D(`no block found with content ID ${a}`);const i=n.externalBlocks.getCursor(a);return this._decodeByteArray(o,i)}_decodeByteArray(e,t){const A=e.content,{stopByte:n}=this.parameters,a=t.bytePosition;let o=t.bytePosition;for(;A[o]!==n&&o<A.length;){if(o===A.length)throw new Be("byteArrayStop reading beyond length of data buffer?");o=o+1}return t.bytePosition=o+1,A.subarray(a,o)}};class lA extends j{constructor(e,t,A){super(e,t),this.instantiateCodec=A}decode(e,t,A,n){const o=this._getLengthCodec().decode(e,t,A,n),i=this._getDataCodec(),g=new Uint8Array(o);for(let c=0;c<o;c+=1)g[c]=i.decode(e,t,A,n);return g}_getLengthCodec(){const e=this.parameters.lengthsEncoding;return this.instantiateCodec(e,"int")}_getDataCodec(){const e=this.parameters.valuesEncoding;return this.instantiateCodec(e,"byte")}}"_getLengthCodec _getDataCodec".split(" ").forEach(r=>{Ne(lA,r)});class Yn extends j{constructor(e,t){if(super(e,t),this.dataType!=="int")throw new Y(`${this.dataType} decoding not yet implemented by BETA codec`)}decode(e,t,A,n){return X(t.content,n.coreBlock,this.parameters.length)-this.parameters.offset}}class Kn extends j{constructor(e,t){if(super(e,t),this.dataType!=="int")throw new Y(`${this.dataType} decoding not yet implemented by GAMMA codec`)}decode(e,t,A,n){let a=1;for(;X(t.content,n.coreBlock,1)===0;)a=a+1;return(X(t.content,n.coreBlock,a-1)|1<<a-1)-this.parameters.offset}}class zn extends j{constructor(e,t){if(super(e,t),this.dataType!=="int")throw new Y(`${this.dataType} decoding not yet implemented by SUBEXP codec`)}decode(e,t,A,n){let a=0;for(;X(t.content,n.coreBlock,1);)a=a+1;let o,i;if(a===0)o=this.parameters.K,i=X(t.content,n.coreBlock,o);else{o=a+this.parameters.K-1;const g=X(t.content,n.coreBlock,o);i=1<<o|g}return i-this.parameters.offset}}const $n={1:Wn,3:Jn,4:lA,5:Tn,6:Yn,7:zn,9:Kn};function Vn(r){return $n[r]}function nt(r,e){const t=Vn(e==="ignore"?0:r.codecId);if(!t)throw new Y(`no codec implemented for codec ID ${r.codecId}`);return new t(r.parameters,e,nt)}const Xn={BF:"int",CF:"int",RI:"int",RL:"int",AP:"int",RG:"int",MF:"int",NS:"int",NP:"int",TS:"int",NF:"int",TC:"byte",TN:"int",FN:"int",FC:"byte",FP:"int",BS:"byte",IN:"byteArray",SC:"byteArray",DL:"int",BA:"byte",BB:"byteArray",RS:"int",PD:"int",HC:"int",MQ:"int",RN:"byteArray",QS:"byte",QQ:"byteArray",TL:"int"};function Zn(r){const e=new Array(5);for(let t=0;t<5;t+=1)e[t]=new Array(4);return e[0][r[0]>>6&3]="C",e[0][r[0]>>4&3]="G",e[0][r[0]>>2&3]="T",e[0][r[0]>>0&3]="N",e[1][r[1]>>6&3]="A",e[1][r[1]>>4&3]="G",e[1][r[1]>>2&3]="T",e[1][r[1]>>0&3]="N",e[2][r[2]>>6&3]="A",e[2][r[2]>>4&3]="C",e[2][r[2]>>2&3]="T",e[2][r[2]>>0&3]="N",e[3][r[3]>>6&3]="A",e[3][r[3]>>4&3]="C",e[3][r[3]>>2&3]="G",e[3][r[3]>>0&3]="N",e[4][r[4]>>6&3]="A",e[4][r[4]>>4&3]="C",e[4][r[4]>>2&3]="G",e[4][r[4]>>0&3]="T",e}class jn{constructor(e){this.dataSeriesCodecCache={},this.tagCodecCache={},this.tagEncoding={},this.readNamesIncluded=e.preservation.RN,this.APdelta=e.preservation.AP,this.referenceRequired=!!e.preservation.RR,this.tagIdsDictionary=e.preservation.TD,this.substitutionMatrix=Zn(e.preservation.SM),this.dataSeriesEncoding=e.dataSeriesEncoding,this.tagEncoding=e.tagEncoding}getCodecForTag(e){const t=this.tagCodecCache[e];if(t)return t;{const A=this.tagEncoding[e];if(!A)throw new Error("Error, no tag encoding");const n=nt(A,"byteArray");return this.tagCodecCache[e]=n,n}}getTagNames(e){return this.tagIdsDictionary[e]}getCodecForDataSeries(e){let t=this.dataSeriesCodecCache[e];if(t===void 0){const A=this.dataSeriesEncoding[e];if(A){const n=Xn[e];if(!n)throw new D(`data series name ${e} not defined in file compression header`);t=nt(A,n),this.dataSeriesCodecCache[e]=t}}return t}toJSON(){const e={};return Object.keys(this).forEach(t=>{t.endsWith("Cache")||(e[t]=this[t])}),e}}class dA{constructor(e,t){this.file=e,this.filePosition=t}getHeader(){return this._readContainerHeader(this.filePosition)}async getCompressionHeaderBlock(){const e=await this.getHeader();if(!(e!=null&&e.numRecords))return null;const{majorVersion:t}=await this.file.getDefinition(),A=$(t),n=await this.getFirstBlock();if(n===void 0)return;if(n.contentType!=="COMPRESSION_HEADER")throw new D(`invalid content type ${n.contentType} in compression header block`);const a=Z(n.content,A.cramCompressionHeader.parser,0,n.contentPosition);return{...n,parsedContent:a}}async getFirstBlock(){const e=await this.getHeader();if(e)return this.file.readBlock(e._endPosition)}async getCompressionScheme(){const e=await this.getCompressionHeaderBlock();if(e)return new jn(e.parsedContent)}getSlice(e,t){return new fA(this,e,t)}async _readContainerHeader(e){const{majorVersion:t}=await this.file.getDefinition(),A=$(t),{cramContainerHeader1:n,cramContainerHeader2:a}=A,{size:o}=await this.file.stat();if(e>=o){console.warn(`pos:${e}>=fileSize:${o} in cram container`);return}const i=P.Buffer.allocUnsafe(n.maxLength);await this.file.read(i,0,n.maxLength,e);const g=Z(i,n.parser),c=mn(g.numLandmarks);if(e+g.length>=o){console.warn(`container at ${e} is beyond fileSize:${o}, skipping`);return}const s=P.Buffer.allocUnsafe(a.maxLength(g.numLandmarks));await this.file.read(s,0,a.maxLength(g.numLandmarks),e+g._size-c);const f=Z(s,a.parser);return this.file.validateChecksums&&f.crc32!==void 0&&await this.file.checkCrc32(e,g._size+f._size-c-4,f.crc32,`container header beginning at position ${e}`),Object.assign(g,f,{_size:g._size+f._size-c,_endPosition:g._size+f._size-c+e})}}"getHeader getCompressionHeaderBlock getCompressionScheme".split(" ").forEach(r=>{Ne(dA,r)});function hA(r,e,t){if(t)return t;if(r)return new QA(r);if(e)return new EA(e);throw new Error("no url, path, or filehandle provided, cannot open")}function Dt(r){const e=r.split(/\r?\n/),t=[];for(const A of e){const[n,...a]=A.split(/\t/);n&&t.push({tag:n.slice(1),data:a.map(o=>{const i=o.indexOf(":");return i!==-1?{tag:o.slice(0,i),value:o.slice(i+1)}:{tag:o,value:""}})})}return t}function ea(r){return new ReadableStream({start(e){e.enqueue(r),e.close()}})}function ta(){const r=new Uint32Array([287454020]),e=new Uint8Array(r.buffer);return e[0]===68?0:e[0]===17?1:2}class at{constructor(e){var t;if(this.file=hA(e.url,e.path,e.filehandle),this.validateChecksums=!0,this.fetchReferenceSequenceCallback=e.seqFetch,this.options={checkSequenceMD5:e.checkSequenceMD5,cacheSize:(t=e.cacheSize)!==null&&t!==void 0?t:2e4},this.featureCache=new wA({maxSize:this.options.cacheSize}),ta()>0)throw new Error("Detected big-endian machine, may be unable to run")}read(e,t,A,n){return this.file.read(e,t,A,n)}stat(){return this.file.stat()}async getDefinition(){const{maxLength:e,parser:t}=sA(),A=P.Buffer.allocUnsafe(e);await this.file.read(A,0,e,0);const n=t(A).value;if(n.majorVersion!==2&&n.majorVersion!==3)throw new Y(`CRAM version ${n.majorVersion} not supported`);return n}async getSamHeader(){const e=await this.getContainerById(0);if(!e)throw new D("file contains no containers");const t=await e.getFirstBlock();if(t===void 0)return Dt("");const A=t.content,n=A.readInt32LE(0),a=4,o=A.toString("utf8",a,a+n);return this.header=o,Dt(o)}async getHeaderText(){return await this.getSamHeader(),this.header}async getContainerById(e){const{majorVersion:t}=await this.getDefinition(),A=$(t);let n=A.cramFileDefinition.maxLength;const{size:a}=await this.file.stat(),{cramContainerHeader1:o}=A;let i;for(let g=0;g<=e;g++){if(n+o.maxLength+8>=a)return;i=this.getContainerAtPosition(n);const c=await i.getHeader();if(!c)throw new D(`container ${e} not found in file`);if(g===0){n=c._endPosition;for(let s=0;s<c.numBlocks;s++){const f=await this.readBlock(n);if(f===void 0)return;n=f._endPosition}}else n+=c._size+c.length}return i}async checkCrc32(e,t,A,n){const a=P.Buffer.allocUnsafe(t);await this.file.read(a,0,t,e);const o=SA.unsigned(a);if(o!==A)throw new D(`crc mismatch in ${n}: recorded CRC32 = ${A}, but calculated CRC32 = ${o}`)}async containerCount(){const{majorVersion:e}=await this.getDefinition(),t=$(e),{size:A}=await this.file.stat(),{cramContainerHeader1:n}=t;let a=0,o=t.cramFileDefinition.maxLength;for(;o+n.maxLength+8<A;){const i=await this.getContainerAtPosition(o).getHeader();if(!i)break;if(a===0){o=i._endPosition;for(let g=0;g<i.numBlocks;g++){const c=await this.readBlock(o);if(c===void 0)return;o=c._endPosition}}else o+=i._size+i.length;a+=1}return a}getContainerAtPosition(e){return new dA(this,e)}async readBlockHeader(e){const{majorVersion:t}=await this.getDefinition(),A=$(t),{cramBlockHeader:n}=A,{size:a}=await this.file.stat();if(e+n.maxLength>=a)return;const o=P.Buffer.allocUnsafe(n.maxLength);return await this.file.read(o,0,n.maxLength,e),Z(o,n.parser,0,e)}async _parseSection(e,t,A=e.maxLength,n){let a;if(n)a=n;else{const{size:i}=await this.file.stat();if(t+A>=i)return;a=P.Buffer.allocUnsafe(A),await this.file.read(a,0,A,t)}const o=Z(a,e.parser,0,t);if(o._size!==A)throw new D(`section read error: requested size ${A} does not equal parsed size ${o._size}`);return o}async _uncompress(e,t,A){if(e==="gzip")tA(t).copy(A);else if(e==="bzip2"){const n=He.array(t);let a=He.header(n),o=0,i;do i=He.decompress(n,a),i!==-1&&(P.Buffer.from(i).copy(A,o),o+=i.length,a-=i.length);while(i!==-1)}else if(e==="lzma"){const n=new Response(new jr.XzReadableStream(ea(t)));P.Buffer.from(await n.arrayBuffer()).copy(A)}else if(e==="rans")un(t,A);else if(e==="rans4x16")me.r4x16_uncompress(t,A);else if(e==="arith")me.arith_uncompress(t,A);else if(e==="fqzcomp")me.fqzcomp_uncompress(t,A);else if(e==="tok3")me.tok3_uncompress(t,A);else throw new Y(`${e} decompression not yet implemented`)}async readBlock(e){const{majorVersion:t}=await this.getDefinition(),A=$(t),n=await this.readBlockHeader(e);if(n===void 0)return;const a=n._endPosition,o=P.Buffer.allocUnsafe(n.uncompressedSize),i={...n,_endPosition:a,contentPosition:a,content:o};if(n.compressionMethod!=="raw"){const g=P.Buffer.allocUnsafe(n.compressedSize);await this.read(g,0,n.compressedSize,a),await this._uncompress(n.compressionMethod,g,o)}else await this.read(o,0,n.uncompressedSize,a);if(t>=3){const g=await this._parseSection(A.cramBlockCrc32,a+n.compressedSize);if(g===void 0)return;i.crc32=g.crc32,this.validateChecksums&&await this.checkCrc32(e,n._size+n.compressedSize,g.crc32,"block data"),i._endPosition=g._endPosition,i._size=i.compressedSize+A.cramBlockCrc32.maxLength}else i._endPosition=a+i.compressedSize,i._size=i.compressedSize;return i}}"getDefinition getSectionParsers getSamHeader".split(" ").forEach(r=>{Ne(at,r)});const Aa=21578050;function _t(r,e){const[t,A,n,a,o,i]=e,g=t;r[g]||(r[g]=[]),r[g].push({start:A,span:n,containerStart:a,sliceStart:o,sliceBytes:i})}function ra(r){return r[0]===31&&r[1]===139?tA(r):r}class na{constructor(e){this.filehandle=hA(e.url,e.path,e.filehandle)}async parseIndex(){const e={},t=ra(await this.filehandle.readFile());if(t.length>4&&t.readUInt32LE(0)===Aa)throw new D("invalid .crai index file. note: file appears to be a .bai index. this is technically legal but please open a github issue if you need support");let A=[],n="";for(const a of t)if(a>=48&&a<=57||!n&&a===45)n+=String.fromCharCode(a);else if(a===9)A.push(Number.parseInt(n,10)),n="";else if(a===10)A.push(Number.parseInt(n,10)),n="",_t(e,A),A=[];else if(a!==13&&a!==32)throw new D("invalid .crai index file");return n&&A.push(Number.parseInt(n,10)),A.length===6&&_t(e,A),Object.entries(e).forEach(([a,o])=>{const i=o;e[a]=i.sort((g,c)=>g.start-c.start||g.span-c.span)}),e}getIndex(){return this.parseIndexP||(this.parseIndexP=this.parseIndex().catch(e=>{throw this.parseIndexP=void 0,e})),this.parseIndexP}async hasDataForReferenceSequence(e){return!!(await this.getIndex())[e]}async getEntriesForRange(e,t,A){const n=(await this.getIndex())[e];if(!n)return[];const a=i=>{const g=i.start,c=i.start+i.span;return g>A?-1:c<=t?1:0},o=[];for(const i of n)a(i)===0&&o.push(i);return o}}class aa{constructor(e){var t;if(this.cram=(t=e.cram)!==null&&t!==void 0?t:new at({url:e.cramUrl,path:e.cramPath,filehandle:e.cramFilehandle,seqFetch:e.seqFetch,checkSequenceMD5:e.checkSequenceMD5,cacheSize:e.cacheSize}),!(this.cram instanceof at))throw new Error("invalid arguments: no cramfile");this.index=e.index}async getRecordsForRange(e,t,A,n={}){if(n.viewAsPairs=n.viewAsPairs||!1,n.pairAcrossChr=n.pairAcrossChr||!1,n.maxInsertSize=n.maxInsertSize||2e5,typeof e=="string")throw new Y("string sequence names not yet supported");const a=e,o=await this.index.getEntriesForRange(a,t,A),i=s=>s.sequenceId===e&&s.alignmentStart<=A&&s.lengthOnRef!==void 0&&s.alignmentStart+s.lengthOnRef-1>=t,g=await Promise.all(o.map(s=>this.getRecordsInSlice(s,i)));let c=Array.prototype.concat(...g);if(n.viewAsPairs){const s={},f={};for(const B of c){const v=B.readName;if(v===void 0)throw new Error("readName undefined");const w=B.uniqueId;s[v]||(s[v]=0),s[v]+=1,f[w]=1}const l={};Object.entries(s).forEach(([B,v])=>{v===1&&(l[B]=!0)});const d=[];for(const B of c){const v=B.readName;if(v===void 0)throw new Error("readName undefined");if(l[v]&&B.mate&&(B.mate.sequenceId===a||n.pairAcrossChr)&&Math.abs(B.alignmentStart-B.mate.alignmentStart)<n.maxInsertSize){const w=this.index.getEntriesForRange(B.mate.sequenceId,B.mate.alignmentStart,B.mate.alignmentStart+1);d.push(w)}}const C=await Promise.all(d);let h=[];for(const B of C)h.push(...B);h=h.sort((B,v)=>B.toString().localeCompare(v.toString())).filter((B,v,w)=>!v||B.toString()!==w[v-1].toString());const I=[];for(const B of h){let v=this.cram.featureCache.get(B.toString());v||(v=this.getRecordsInSlice(B,()=>!0),this.cram.featureCache.set(B.toString(),v));const w=v.then(Q=>{const y=[];for(const k of Q){if(k.readName===void 0)throw new Error("readName undefined");l[k.readName]&&!f[k.uniqueId]&&y.push(k)}return y});I.push(w)}const u=await Promise.all(I);if(u.length){const B=u.reduce((v,w)=>v.concat(w));c=c.concat(B)}}return c}getRecordsInSlice({containerStart:e,sliceStart:t,sliceBytes:A},n){return this.cram.getContainerAtPosition(e).getSlice(t,A).getRecords(n)}hasDataForReferenceSequence(e){return this.index.hasDataForReferenceSequence(e)}}function ia(r,e,t){if(!r)return[];const A=new Array(r.length);let n=0,a=0,o=0,i=0,g=e;for(const{refPos:c,code:s,pos:f,data:l,sub:d,ref:C}of r)if(i=o-g,g=o,i&&a>0&&(A[n++]={start:o,type:"insertion",base:`${a}`,length:0},a=0),o=c-1-e,s==="X")A[n++]={start:o,length:1,base:d,qual:t==null?void 0:t[f-1],altbase:C==null?void 0:C.toUpperCase(),type:"mismatch"};else if(s==="I")A[n++]={start:o,type:"insertion",base:`${l.length}`,length:0};else if(s==="N")A[n++]={type:"skip",length:l,start:o,base:"N"};else if(s==="S"){const h=l.length;A[n++]={start:o,type:"softclip",base:`S${h}`,cliplen:h,length:1}}else if(s!=="P")if(s==="H"){const h=l;A[n++]={start:o,type:"hardclip",base:`H${h}`,cliplen:h,length:1}}else s==="D"?A[n++]={type:"deletion",length:l,start:o,base:"*"}:s==="b"||s==="q"||s==="B"||s==="i"&&a++;return i&&a>0&&(A[n++]={start:o,type:"insertion",base:`${a}`,length:0},a=0),A.slice(0,n)}function oa(r,e,t,A){let n="",a="",o="M",i=0;if(!A)return"";const g=A.seq,c=A.start;let s=e,f=0,l=0;if(r!==void 0)for(const{code:d,refPos:C,sub:h,data:I}of r)if(f=C-s,n+=g.slice(s-c,C-c),s=C,l>0&&f&&(a+=`${l}I`,l=0),i&&o!=="M"&&(a+=`${i}${o}`,i=0),f&&(o="M",i+=f),d==="b"){const u=I.split(","),B=String.fromCharCode(...u);n+=B,s+=B.length,i+=B.length}else d==="B"||d==="X"?(n+=h,s++,i++):d==="D"||d==="N"?(s+=I,i&&(a+=`${i}${o}`),a+=I+d,i=0):d==="I"||d==="S"?(n+=I,i&&(a+=`${i}${o}`),a+=I.length+d,i=0):d==="i"?(i&&(a+=`${i}${o}`),l++,n+=I,i=0):d==="P"?(i&&(a+=`${i}${o}`),a+=`${I}P`):d==="H"&&(i&&(a+=`${i}${o}`),a+=`${I}H`,i=0);else f=t-n.length;return n.length!==t&&(f=t-n.length,n+=g.slice(s-c,s-c+f),i&&o!=="M"&&(a+=`${i}${o}`,i=0),o="M",i+=f),f&&l>0&&(a+=`${l}I`),i&&(a+=`${i}${o}`),a}class dt{constructor(e,t){this.record=e,this._store=t}_get_name(){return this.record.readName}_get_start(){return this.record.alignmentStart-1}_get_end(){var e;return this.record.alignmentStart+((e=this.record.lengthOnRef)!==null&&e!==void 0?e:1)-1}_get_cram_read_features(){return this.record.readFeatures}_get_type(){return"match"}_get_score(){return this.record.mappingQuality}_get_flags(){return this.record.flags}_get_strand(){return this.record.isReverseComplemented()?-1:1}_read_group_id(){var e;return(e=this._store.samHeader.readGroups)===null||e===void 0?void 0:e[this.record.readGroupId]}_get_qual(){return(this.record.qualityScores||[]).join(" ")}qualRaw(){return this.record.qualityScores}_get_refName(){return this._store.refIdToName(this.record.sequenceId)}_get_is_paired(){return!!this.record.mate}_get_pair_orientation(){return this.record.isPaired()?this.record.getPairOrientation():void 0}_get_template_length(){return this.record.templateLength||this.record.templateSize}_get_next_ref(){return this.record.mate?this._store.refIdToName(this.record.mate.sequenceId):void 0}_get_next_segment_position(){return this.record.mate?`${this._store.refIdToName(this.record.mate.sequenceId)}:${this.record.mate.alignmentStart}`:void 0}_get_next_pos(){var e;return(e=this.record.mate)===null||e===void 0?void 0:e.alignmentStart}_get_tags(){const e=this._read_group_id(),{tags:t}=this.record;return e!==void 0?{...t,RG:e}:t}_get_seq(){return this.record.getReadBases()}_get_CIGAR(){return oa(this.record.readFeatures,this.record.alignmentStart,this.record.readLength,this.record._refRegion)}tags(){return Object.getOwnPropertyNames(dt.prototype).filter(e=>e.startsWith("_get_")&&e!=="_get_mismatches"&&e!=="_get_cram_read_features").map(e=>e.replace("_get_",""))}id(){return`${this._store.id}-${this.record.uniqueId}`}get(e){const t=`_get_${e}`;if(this[t])return this[t]()}parent(){}children(){}set(){}pairedFeature(){return!1}_get_clipPos(){const e=this.get("mismatches");if(e.length){const t=this.get("strand")===-1?e.at(-1):e[0],{type:A,cliplen:n}=t;if(A==="softclip"||A==="hardclip")return n}return 0}toJSON(){return{...Object.fromEntries(this.tags().map(e=>[e,this.get(e)]).filter(e=>e[1]!==void 0)),uniqueId:this.id()}}_get_mismatches(){const e=this.record.readFeatures,t=this.qualRaw(),A=this.get("start");return ia(e,A,t)}}class ua extends vA.BaseFeatureDataAdapter{constructor(){super(...arguments),this.samHeader={},this.seqIdToOriginalRefName=[]}async configurePre(){const e=this.getConf("cramLocation"),t=this.getConf("craiLocation"),A=this.pluginManager,n=new aa({cramFilehandle:Ct.openLocation(e,A),index:new na({filehandle:Ct.openLocation(t,A)}),seqFetch:(...i)=>this.seqFetch(...i),checkSequenceMD5:!1});if(!this.getSubAdapter)throw new Error("Error getting subadapter");const a=this.getConf("sequenceAdapter");if(!a)throw new Error("no sequenceAdapter supplied to CramAdapter config");const o=await this.getSubAdapter(a);return{cram:n,sequenceAdapter:o.dataAdapter}}async configure(){return this.configureP||(this.configureP=this.configurePre().catch(e=>{throw this.configureP=void 0,e})),this.configureP}async getHeader(e){const{cram:t}=await this.configure();return t.cram.getHeaderText()}async seqFetch(e,t,A){t-=1;const{sequenceAdapter:n}=await this.configure(),a=this.refIdToOriginalName(e)||this.refIdToName(e);if(!a)throw new Error("unknown");const i=(await mA(n.getFeatures({refName:a,start:t,end:A,assemblyName:""}).pipe(yA()))).sort((c,s)=>c.get("start")-s.get("start")).map(c=>{const s=c.get("start"),f=c.get("end"),l=Math.max(t-s,0),C=Math.min(A-s,f-s)-l;return(c.get("seq")||c.get("residues")).slice(l,l+C)}).join(""),g=A-t;if(i.length!==g)throw new Error(`fetching ${a}:${W.toLocale(t-1)}-${W.toLocale(A)} returned ${W.toLocale(i.length)} bases, should have returned ${W.toLocale(g)}`);return i}async setupPre(e){const{statusCallback:t=()=>{}}=e||{};return W.updateStatus("Downloading index",t,async()=>{const A=await this.configure(),{cram:n}=A,a=await n.cram.getSamHeader(),o=[],i={};a.filter(s=>s.tag==="SQ").forEach((s,f)=>{const l=s.data.find(d=>d.tag==="SN");if(l){const d=l.value;i[d]=f,o[f]=d}});const g=a.filter(s=>s.tag==="RG").map(s=>{var f;return(f=s.data.find(l=>l.tag==="ID"))===null||f===void 0?void 0:f.value}),c={idToName:o,nameToId:i,readGroups:g};return this.samHeader=c,{samHeader:c,...A}})}async setup(e){return this.setupP||(this.setupP=this.setupPre(e).catch(t=>{throw this.setupP=void 0,t})),this.setupP}async getRefNames(e){const{samHeader:t}=await this.setup(e);if(!t.idToName)throw new Error("CRAM file has no header lines");return t.idToName}refNameToId(e){if(this.samHeader.nameToId)return this.samHeader.nameToId[e];if(this.seqIdToRefName)return this.seqIdToRefName.indexOf(e)}refIdToName(e){var t,A;return((t=this.samHeader.idToName)===null||t===void 0?void 0:t[e])||((A=this.seqIdToRefName)===null||A===void 0?void 0:A[e])}refIdToOriginalName(e){return this.seqIdToOriginalRefName[e]}getFeatures(e,t){const{signal:A,filterBy:n,statusCallback:a=()=>{}}=t||{},{refName:o,start:i,end:g,originalRefName:c}=e;return pA(async s=>{const{cram:f,samHeader:l}=await this.setup(t),d=this.refNameToId(o);if(d===void 0){console.warn("Unknown refName",o),s.complete();return}c&&(this.seqIdToOriginalRefName[d]=c);const C=await W.updateStatus("Downloading alignments",a,()=>f.getRecordsForRange(d,i,g));W.checkAbortSignal(A),await W.updateStatus("Processing alignments",a,()=>{var h;const{flagInclude:I=0,flagExclude:u=0,tagFilter:B,readName:v}=n||{};for(const w of C){const Q=w.flags;if(!((Q&I)!==I&&!(Q&u))){if(B){const y=B.tag==="RG"?(h=l.readGroups)===null||h===void 0?void 0:h[w.readGroupId]:w.tags[B.tag],k=B.value;if(k==="*"?y!==void 0:`${y}`!=`${k}`)continue}v&&w.readName!==v||s.next(this.cramRecordToFeature(w))}}s.complete()})},A)}freeResources(){}cramRecordToFeature(e){return new dt(e,this)}async getMultiRegionFeatureDensityStats(e,t){const A=await this.bytesForRegions(e,t),n=this.getConf("fetchSizeLimit");return{bytes:A,fetchSizeLimit:n}}async bytesForRegions(e,t){const{cram:A}=await this.configure();return(await Promise.all(e.map(a=>{const{refName:o,start:i,end:g}=a,c=this.refNameToId(o);return c!==void 0?A.index.getEntriesForRange(c,i,g):[{sliceBytes:0}]}))).flat().reduce((a,o)=>a+o.sliceBytes,0)}}export{ua as default};
//# sourceMappingURL=CramAdapter-Cwx5CWwB.js.map
