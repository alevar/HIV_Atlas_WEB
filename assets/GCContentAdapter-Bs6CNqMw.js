import{I as S,O as v,K as x,N as F,u as q}from"./index-Cb9Tbun5.js";class y extends S.BaseFeatureDataAdapter{constructor(){super(...arguments),this.gcMode="content"}async configure(){var t;const n=await((t=this.getSubAdapter)===null||t===void 0?void 0:t.call(this,this.getConf("sequenceAdapter")));if(!n)throw new Error("Error getting subadapter");return n.dataAdapter}async getRefNames(){return(await this.configure()).getRefNames()}getFeatures(t,n){return v(async d=>{var l;const h=await this.configure(),u=this.getConf("windowSize"),g=this.getConf("windowDelta"),a=u===1?1:u/2,m=u===1;let{start:s,end:o}=t;if(s=Math.max(0,s-a),o+=a,o<0||s>o){d.complete();return}const A=h.getFeatures({...t,start:s,end:o},n),f=((l=(await x(A.pipe(F())))[0])===null||l===void 0?void 0:l.get("seq"))||"";for(let e=a;e<f.length-a;e+=g){const C=m?f[e]:f.slice(e-a,e+a);let i=0,c=0,w=0;for(const r of C)r==="c"||r==="C"?i++:(r==="g"||r==="G")&&c++,r!=="N"&&w++;const p=s,N=this.gcMode==="content"?(c+i)/(w||1):this.gcMode==="skew"?(c-i)/(c+i||1):0;d.next(new q.SimpleFeature({uniqueId:`${this.id}_${p+e}`,refName:t.refName,start:p+e,end:p+e+g,score:N}))}d.complete()})}freeResources(){}}y.capabilities=["hasLocalStats"];export{y as default};
//# sourceMappingURL=GCContentAdapter-Bs6CNqMw.js.map
