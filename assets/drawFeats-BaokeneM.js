import{u as B,Q as Y,S as q,U as G,X as H}from"./rpcWorker-CJ7cIcjW.js";import{h as J}from"./util-C5_pe8_J.js";function a(n){return Math.random()*2*n-n}function O(n,e,_,c){n.strokeStyle=c,n.beginPath(),n.moveTo(e,0),n.lineTo(e,_),n.stroke()}function k(n,e,_,c){const{chainData:y,colorBy:b,drawInter:L,drawLongRange:R,lineWidthSetting:V,jitterVal:i}=n;if(!y)return;const g=B.getContainingView(n),{assemblyManager:W}=B.getSession(n),{chains:X,stats:I}=y,p=J(y),P=W.get(g.assemblyNames[0]),f=(b==null?void 0:b.type)||"insertSizeAndOrientation";if(!P)return;e.lineWidth=V;function z(o,t,s,r){var l,u,N;const w=o.strand,A=t.strand,$=w===-1,j=A===-1,D=$?o.start:o.end,E=p?j?t.start:t.end:j?t.end:t.start,F=s.getCanonicalRefName(o.refName)||o.refName,Q=s.getCanonicalRefName(t.refName)||t.refName,S=(l=g.bpToPx({refName:F,coord:D}))===null||l===void 0?void 0:l.offsetPx,C=(u=g.bpToPx({refName:Q,coord:E}))===null||u===void 0?void 0:u.offsetPx;if(S!==void 0&&C!==void 0){const T=(C-S)/2,m=Math.abs(T),d=S-g.offsetPx,U=C-g.offsetPx,M=m>1e4;r&&M?(e.moveTo(d,0),e.beginPath()):(e.beginPath(),e.moveTo(d,0)),r&&M?e.strokeStyle="red":p?f==="insertSizeAndOrientation"?e.strokeStyle=q(o,t,I)[0]:f==="orientation"?e.strokeStyle=G(o)[0]:f==="insertSize"?e.strokeStyle=((N=H(o,t,I))===null||N===void 0?void 0:N[0])||"grey":f==="gradient"&&(e.strokeStyle=`hsl(${Math.log10(m)*10},50%,50%)`):f==="orientation"||f==="insertSizeAndOrientation"?w===-1&&A===1?e.strokeStyle="navy":w===1&&A===-1?e.strokeStyle="green":e.strokeStyle="grey":f==="gradient"&&(e.strokeStyle=`hsl(${Math.log10(m)*10},50%,50%)`);const h=d+T*2,v=Math.min(c+a(i),m);r?m>1e5?(O(e,d+a(i),c,"red"),O(e,U+a(i),c,"red")):M?(e.arc(d+T+a(i),0,m,0,Math.PI),e.stroke()):(e.bezierCurveTo(d+a(i),v,h,v,h+a(i),0),e.stroke()):(e.bezierCurveTo(d+a(i),v,h,v,h+a(i),0),e.stroke())}else S&&L&&O(e,S-g.offsetPx,c,"purple")}for(const o of X)if(o.length===1&&R){const t=o[0];if(p&&!(t.flags&8)){const s={refName:t.next_ref||"",start:t.next_pos||0,end:t.next_pos||0,strand:t.strand};z(t,s,P,!0)}else{const s=[t,...Y(t.SA,t.id,t.strand,t.name)].sort((r,l)=>r.clipPos-l.clipPos);for(let r=0;r<s.length-1;r++){const l=s[r],u=s[r+1];z(l,u,P,!0)}}}else{const t=p?o.filter(s=>!(s.flags&2048)&&!(s.flags&8)):o.sort((s,r)=>s.clipPos-r.clipPos).filter(s=>!(s.flags&256));for(let s=0;s<t.length-1;s++)z(t[s],t[s+1],P,!1)}}export{k as drawFeats};
//# sourceMappingURL=drawFeats-BaokeneM.js.map
