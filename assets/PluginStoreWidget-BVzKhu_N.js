const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DeletePluginDialog-DQz-MNit.js","assets/index-Cb9Tbun5.js","assets/index-TdmWrRGH.css","assets/AddCustomPluginDialog-C891zGC6.js","assets/ExpandMore-yh05mL93.js"])))=>i.map(i=>d[i]);
import{ao as E,ap as v,aq as p,a as d,_ as $,m as P,o as _,u as g,bM as h,R as e,ad as F,aa as j,ae as q,T as u,$ as B,ac as z,bN as W,bw as V,bx as H,L as Y,bO as Q,B as M,bn as U,bP as G,d as J,bj as K,bQ as I,bR as C,c as X}from"./index-Cb9Tbun5.js";import{E as k}from"./ExpandMore-yh05mL93.js";import{d as Z}from"./Clear-DHzeK7Q8.js";var x={},ee=v;Object.defineProperty(x,"__esModule",{value:!0});var R=x.default=void 0,te=ee(E()),ne=p;R=x.default=(0,te.default)((0,ne.jsx)("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"InfoOutlined");var y={},ae=v;Object.defineProperty(y,"__esModule",{value:!0});var L=y.default=void 0,le=ae(E()),se=p;L=y.default=(0,le.default)((0,se.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1z"}),"Lock");const re=d.lazy(()=>$(()=>import("./DeletePluginDialog-DQz-MNit.js"),__vite__mapDeps([0,1,2]))),oe=P()(()=>({lockedPluginTooltip:{marginRight:"0.5rem"}}));function ie(){const{classes:t}=oe();return e.createElement(B,{className:t.lockedPluginTooltip,title:"This plugin was installed by an administrator, you cannot remove it."},e.createElement(L,null))}const ce=_(function({plugin:t,model:n}){const[r,i]=d.useState(),{pluginManager:a}=g.getEnv(n),l=g.getSession(n),{jbrowse:s,adminMode:c}=l,o=h.isSessionWithSessionPlugins(l)?l.sessionPlugins.some(f=>{var m;return((m=a.pluginMetadata[t.name])===null||m===void 0?void 0:m.url)===f.url}):!1;return e.createElement(e.Fragment,null,r?e.createElement(d.Suspense,{fallback:null},e.createElement(re,{plugin:r,onClose:f=>{if(f){const m=a.pluginMetadata[t.name];c?s.removePlugin(m):h.isSessionWithSessionPlugins(l)&&l.removeSessionPlugin(m)}i(void 0)}})):null,e.createElement(F,{key:t.name},c||o?e.createElement(j,{"data-testid":`removePlugin-${t.name}`,onClick:()=>{i(t.name)}},e.createElement(q,null)):e.createElement(ie,null),e.createElement(u,null,t.name)))}),ue=_(function({pluginManager:n,model:r}){const{plugins:i}=n,{filterText:a}=r,l=i.filter(s=>{var c;return!(!((c=n.pluginMetadata[s.name])===null||c===void 0)&&c.isCore)});return e.createElement(z,null,l.length>0?l.filter(s=>s.name.toLowerCase().includes(a.toLowerCase())).map(s=>e.createElement(ce,{key:s.name,plugin:s,model:r})):e.createElement(u,null,"No plugins currently installed"))});var b={},de=v;Object.defineProperty(b,"__esModule",{value:!0});var T=b.default=void 0,me=de(E()),ge=p;T=b.default=(0,me.default)((0,ge.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person");var S={},fe=v;Object.defineProperty(S,"__esModule",{value:!0});var w=S.default=void 0,Ee=fe(E()),ve=p;w=S.default=(0,Ee.default)((0,ve.jsx)("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check");const pe=P()({card:{margin:"0.5em"},icon:{marginLeft:"0.5em",marginRight:"0.5em"},bold:{fontWeight:600},dataField:{display:"flex",alignItems:"center"}}),_e=_(function({plugin:n,model:r,adminMode:i}){const{classes:a}=pe(),l=g.getSession(r),{pluginManager:s}=g.getEnv(r),{runtimePluginDefinitions:c}=s,o=c.some(O=>O.url===n.url),[f,m]=d.useState(!1),D=o||f,A=W(r,3),{jbrowse:N}=A;return e.createElement(V,{variant:"outlined",key:n.name,className:a.card},e.createElement(H,null,e.createElement(u,{variant:"h5"},e.createElement(Y,{href:`${n.location}#readme`,target:"_blank",rel:"noopener"},n.name)),e.createElement("div",{className:a.dataField},e.createElement(T,{style:{marginRight:"0.5em"}}),e.createElement(u,null,n.authors.join(", "))),e.createElement(u,{className:a.bold},"Description:"),e.createElement(u,null,n.description)),e.createElement(Q,null,e.createElement(M,{variant:"contained",disabled:D,startIcon:o?e.createElement(w,null):e.createElement(U,null),onClick:()=>{i?N.addPlugin({name:n.name,url:n.url}):h.isSessionWithSessionPlugins(l)&&l.addSessionPlugin(n),m(!0)}},o?"Installed":"Install")))});function he(){const[t,n]=d.useState(),[r,i]=d.useState();return d.useEffect(()=>{(async()=>{try{const a=await fetch("https://jbrowse.org/plugin-store/plugins.json");if(!a.ok){const s=await a.text();throw new Error(`HTTP ${a.status} fetching plugins: ${s}`)}const l=await a.json();n(l.plugins)}catch(a){console.error(a),i(a)}})()},[]),{plugins:t,error:r}}const Pe=d.lazy(()=>$(()=>import("./AddCustomPluginDialog-C891zGC6.js"),__vite__mapDeps([3,1,2,4]))),xe=P()(t=>({expandIcon:{color:t.palette.tertiary.contrastText},adminBadge:{borderRadius:3,backgroundColor:t.palette.quaternary.main,padding:"1em",display:"flex",alignContent:"center"},customPluginButton:{margin:"1em auto",display:"flex"}})),Ie=_(function({model:t}){const{classes:n}=xe(),{plugins:r,error:i}=he(),[a,l]=d.useState(!1),{adminMode:s}=g.getSession(t),{pluginManager:c}=G(t);return e.createElement("div",null,s&&e.createElement(e.Fragment,null,!g.isElectron&&e.createElement("div",{className:n.adminBadge},e.createElement(R,{style:{marginRight:"0.3em"}}),e.createElement(u,null,"You are using the ",e.createElement("code",null,"admin-server"),". Any changes you make will be saved to your configuration file. You also have the ability to add custom plugins that are not in the store.")),e.createElement(M,{className:n.customPluginButton,variant:"contained",onClick:()=>{l(!0)}},"Add custom plugin"),a?e.createElement(d.Suspense,{fallback:null},e.createElement(Pe,{onClose:()=>{l(!1)},model:t})):null),e.createElement(J,{label:"Filter plugins",value:t.filterText,onChange:o=>{t.setFilterText(o.target.value)},fullWidth:!0,InputProps:{endAdornment:e.createElement(K,{position:"end"},e.createElement(j,{onClick:()=>{t.clearFilterText()}},e.createElement(Z,null)))}}),e.createElement(I,{defaultExpanded:!0},e.createElement(C,{expandIcon:e.createElement(k,{className:n.expandIcon})},e.createElement(u,{variant:"h5"},"Installed plugins")),e.createElement("div",{style:{margin:"1em"}},e.createElement(ue,{pluginManager:c,model:t}))),e.createElement(I,{defaultExpanded:!0},e.createElement(C,{expandIcon:e.createElement(k,{className:n.expandIcon})},e.createElement(u,{variant:"h5"},"Available plugins")),i?e.createElement(u,{color:"error"},`${i}`):r?r.filter(o=>!(g.isElectron&&o.cjsUrl)&&o.name.toLowerCase().includes(t.filterText.toLowerCase())).map(o=>e.createElement(_e,{key:o.name,plugin:o,model:t,adminMode:!!s})):e.createElement(X.LoadingEllipses,null)))});export{Ie as default};
//# sourceMappingURL=PluginStoreWidget-BVzKhu_N.js.map
