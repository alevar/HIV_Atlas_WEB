import{u as j,U as Z,X as q,Z as G,$ as H}from"./rpcWorker-CL9qhe4-.js";import{h as J}from"./util-C5_pe8_J.js";function a(n){return Math.random()*2*n-n}function O(n,e,_,c){n.strokeStyle=c,n.beginPath(),n.moveTo(e,0),n.lineTo(e,_),n.stroke()}function k(n,e,_,c){const{chainData:y,colorBy:b,drawInter:B,drawLongRange:L,lineWidthSetting:R,jitterVal:i}=n;if(!y)return;const g=j.getContainingView(n),{assemblyManager:V}=j.getSession(n),{chains:W,stats:I}=y,P=J(y),S=V.get(g.assemblyNames[0]),f=(b==null?void 0:b.type)||"insertSizeAndOrientation";if(!S)return;e.lineWidth=R;function z(o,t,s,r){var l,u,N;const w=o.strand,A=t.strand,X=w===-1,$=A===-1,D=X?o.start:o.end,E=P?$?t.start:t.end:$?t.end:t.start,F=s.getCanonicalRefName(o.refName)||o.refName,U=s.getCanonicalRefName(t.refName)||t.refName,p=(l=g.bpToPx({refName:F,coord:D}))===null||l===void 0?void 0:l.offsetPx,C=(u=g.bpToPx({refName:U,coord:E}))===null||u===void 0?void 0:u.offsetPx;if(p!==void 0&&C!==void 0){const T=(C-p)/2,m=Math.abs(T),d=p-g.offsetPx,Y=C-g.offsetPx,M=m>1e4;r&&M?(e.moveTo(d,0),e.beginPath()):(e.beginPath(),e.moveTo(d,0)),r&&M?e.strokeStyle="red":P?f==="insertSizeAndOrientation"?e.strokeStyle=q(o,t,I)[0]:f==="orientation"?e.strokeStyle=G(o)[0]:f==="insertSize"?e.strokeStyle=((N=H(o,t,I))===null||N===void 0?void 0:N[0])||"grey":f==="gradient"&&(e.strokeStyle=`hsl(${Math.log10(m)*10},50%,50%)`):f==="orientation"||f==="insertSizeAndOrientation"?w===-1&&A===1?e.strokeStyle="navy":w===1&&A===-1?e.strokeStyle="green":e.strokeStyle="grey":f==="gradient"&&(e.strokeStyle=`hsl(${Math.log10(m)*10},50%,50%)`);const h=d+T*2,v=Math.min(c+a(i),m);r?m>1e5?(O(e,d+a(i),c,"red"),O(e,Y+a(i),c,"red")):M?(e.arc(d+T+a(i),0,m,0,Math.PI),e.stroke()):(e.bezierCurveTo(d+a(i),v,h,v,h+a(i),0),e.stroke()):(e.bezierCurveTo(d+a(i),v,h,v,h+a(i),0),e.stroke())}else p&&B&&O(e,p-g.offsetPx,c,"purple")}for(const o of W)if(o.length===1&&L){const t=o[0];if(P&&!(t.flags&8)){const s={refName:t.next_ref||"",start:t.next_pos||0,end:t.next_pos||0,strand:t.strand};z(t,s,S,!0)}else{const s=[t,...Z(t.SA,t.id,t.strand,t.name)].sort((r,l)=>r.clipPos-l.clipPos);for(let r=0;r<s.length-1;r++){const l=s[r],u=s[r+1];z(l,u,S,!0)}}}else{const t=P?o.filter(s=>!(s.flags&2048)&&!(s.flags&8)):o.sort((s,r)=>s.clipPos-r.clipPos).filter(s=>!(s.flags&256));for(let s=0;s<t.length-1;s++)z(t[s],t[s+1],S,!1)}}export{k as drawFeats};
//# sourceMappingURL=drawFeats-Cds7YFMk.js.map
