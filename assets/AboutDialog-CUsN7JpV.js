import{b8 as D,z as R,a as i,u as E,l as f,R as t,c as C,m as x,o as y,a7 as N,D as O,B as A,b5 as v,b9 as P}from"./index-DvmOrY9r.js";import{D as j}from"./Dialog-DHOAe_28.js";import{B as S}from"./BaseCard-BymLbhjD.js";var I=D();const k=R(I);function U({config:e}){const[s,n]=i.useState(),[a,r]=i.useState(),c=E.getSession(e),{rpcManager:p}=c;i.useEffect(()=>{(async()=>{try{const l=f.readConfObject(e,"adapter"),u=await p.call(e.trackId,"CoreGetInfo",{adapterConfig:l});r(u)}catch(l){console.error(l),n(l)}})()},[e,p]);const d=typeof a=="string"?{header:`<pre>${a.replaceAll("<","&lt;").replaceAll(">","&gt;")}</pre>`}:a||{};return t.createElement(S,{title:"File info"},s?t.createElement(C.ErrorMessage,{error:s}):a===void 0?t.createElement(C.LoadingEllipses,{message:"Loading file data"}):t.createElement(k,{attributes:d}))}const h=1e4,F=x()(e=>({container:{minWidth:800},refNames:{maxHeight:300,overflow:"auto",flexGrow:1,background:e.palette.background.default}})),$=y(function({config:e,onClose:s}){const{classes:n}=F(),[a,r]=i.useState(),[c,p]=i.useState(),[d,l]=i.useState(!1),{rpcManager:u}=E.getSession(e);i.useEffect(()=>{(async()=>{try{const o=await Promise.all([...new Set(N.getConfAssemblyNames(e))].map(async m=>{const M=f.readConfObject(e,"adapter");return[m,await u.call(e.trackId,"CoreGetRefNames",{adapterConfig:M,regions:[{assemblyName:m}]})]}));p(Object.fromEntries(o))}catch(o){console.error(o),r(o)}})()},[e,u]);const b=c?Object.entries(c):[],g=b.flatMap(([o,m])=>[`--- ${o} ---`,...m.slice(0,h),m.length>h?`
Too many refNames to show in browser for ${o}, use "Copy ref names" button to copy to clipboard`:""]).filter(o=>!!o).join(`
`);return t.createElement(C.Dialog,{open:!0,title:"Reference sequence names used in track",onClose:s,maxWidth:"xl"},t.createElement(O,{className:n.container},a?t.createElement(C.ErrorMessage,{error:a}):c===void 0?t.createElement(C.LoadingEllipses,{message:"Loading refNames"}):t.createElement(t.Fragment,null,t.createElement(A,{variant:"contained",onClick:()=>{v(b.flatMap(([o,m])=>[`--- ${o} ---`,...m]).filter(o=>!!o).join(`
`)),l(!0),setTimeout(()=>{l(!1)},1e3)}},d?"Copied to clipboard!":"Copy ref names"),t.createElement("pre",{className:n.refNames},g))))}),B=x()({content:{minWidth:800},button:{float:"right"}});function w(e,s){for(const n in e)n===s?delete e[n]:typeof e[n]=="object"&&w(e[n],s);return e}const L=y(function({config:e}){const[s,n]=i.useState(!1),a=f.readConfObject(e),r=E.getSession(e),{classes:c}=B(),[p,d]=i.useState(!1),l=f.getConf(r,["formatAbout","hideUris"])||f.readConfObject(e,["formatAbout","hideUris"]),{pluginManager:u}=E.getEnv(r),b=u.evaluateExtensionPoint("Core-customizeAbout",{config:{...a,...f.getConf(r,["formatAbout","config"],{config:a}),...f.readConfObject(e,["formatAbout","config"],{config:a})}},{session:r,config:e}),g=u.evaluateExtensionPoint("Core-extraAboutPanel",null,{session:r,config:e});return t.createElement("div",{className:c.content},t.createElement(S,{title:"Configuration"},l?null:t.createElement("span",{className:c.button},t.createElement(A,{variant:"contained",color:"secondary",onClick:()=>{d(!0)}},"Show ref names"),t.createElement(A,{variant:"contained",onClick:()=>{const o=w(P(a),"baseUri");v(JSON.stringify(o,null,2)),n(!0),setTimeout(()=>{n(!1)},1e3)}},s?"Copied to clipboard!":"Copy config")),t.createElement(k,{attributes:b,omit:["displays","baseUri","refNames","formatAbout"],hideUris:l})),g?t.createElement(S,{title:g.name},t.createElement(g.Component,{config:e})):null,t.createElement(U,{config:e}),p?t.createElement($,{config:e,onClose:()=>{d(!1)}}):null)});function q({config:e,handleClose:s}){const n=E.getSession(e),a=N.getTrackName(e,n),{pluginManager:r}=E.getEnv(n),c=r.evaluateExtensionPoint("Core-replaceAbout",L,{session:n,config:e});return t.createElement(j,{open:!0,onClose:s,title:a,maxWidth:"xl"},t.createElement(c,{config:e}))}export{q as default};
//# sourceMappingURL=AboutDialog-CUsN7JpV.js.map
