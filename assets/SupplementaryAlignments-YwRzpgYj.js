import{R as s,s as w,b0 as N,S as h,u as p,al as $,b1 as k,U as A,b2 as R,r as E,b as C,ab as D}from"./rpcWorker-CL9qhe4-.js";import{n as M}from"./AlignmentsFeatureDetail-BeP0LdO4.js";import"./FeatureDetails-DMfanhiz.js";function B({tag:e,model:a}){return s.createElement("div",null,s.createElement(w,null,"List of supplementary alignment locations"),s.createElement("ul",null,e.split(";").filter(o=>!!o).map((o,c)=>{const[m,l,i,u]=o.split(","),g=N(u),y=Math.floor(g/5),t=+l,f=+l+g,n=t-y,r=f+y,S=`${m}:${Math.max(1,n)}-${r}`,d=t.toLocaleString("en-US"),v=f.toLocaleString("en-US"),b=`${m}:${d}-${v} (${i}) [${g}bp]`;return s.createElement("li",{key:`${S}-${c}`},s.createElement(h,{href:"#",onClick:async L=>{L.preventDefault(),M(S,a)}},b))})))}async function F({view:e,feature:a}){const{assemblyManager:o}=p.getSession(e),c=a.get("CIGAR"),m=a.get("strand"),l=$(a,"SA")||"",i=a.get("name"),u=k(c,1),g=await o.waitForAssembly(e.assemblyNames[0]);if(!g)throw new Error("assembly not found");const y=A(l,a.id(),m,i,!0),t=a.toJSON();t.clipPos=u,t.strand=1,t.mate={refName:i,start:u,end:u+R(c)};const f=[t,...y];return f.forEach((n,r)=>{n.refName=g.getCanonicalRefName(n.refName)||n.refName,n.syntenyId=r,n.mate.syntenyId=r,n.mate.uniqueId=`${n.uniqueId}_mate`}),f.sort((n,r)=>n.clipPos-r.clipPos),f}const I=E.lazy(()=>import("./BreakendSingleLevelOptionDialog-B-1yO3hg.js").then(function(e){return e.B})),O=E.lazy(()=>import("./BreakendSingleLevelOptionDialog-B-1yO3hg.js").then(function(e){return e.a}));function P({model:e,feature:a,viewType:o}){const c=p.getSession(e),{view:m}=e,[l,i]=E.useState(),[u,g]=E.useState();E.useEffect(()=>{(async()=>{try{const t=await F({view:m,feature:new p.SimpleFeature(a)});i(t)}catch(t){g(t),console.error(t)}})()},[a,m]);const y=[];if(l)for(let t=0;t<l.length-1;t++)y.push([l[t],l[t+1]]);return y.length?s.createElement("div",null,s.createElement(w,null,"Launch split view"),u?s.createElement(C.ErrorMessage,{error:u}):null,s.createElement("ul",null,y.map((t,f)=>{const[n,r]=t;return s.createElement("li",{key:`${JSON.stringify(t)}-${f}`},n.refName,":",p.toLocale(n.strand===1?n.end:n.start)," ->"," ",r.refName,":",p.toLocale(r.strand===1?r.start:r.end)," ",s.createElement(h,{href:"#",onClick:S=>{S.preventDefault(),c.queueDialog(d=>[I,{handleClose:d,model:e,feature:new p.SimpleFeature({...n,mate:r}),viewType:o,view:e.view,assemblyName:e.view.displayedRegions[0].assemblyName}])}},"(top/bottom)")," ",s.createElement(h,{href:"#",onClick:S=>{S.preventDefault(),c.queueDialog(d=>[O,{handleClose:d,model:e,feature:new p.SimpleFeature({...n,mate:r}),viewType:o,view:e.view,assemblyName:e.view.displayedRegions[0].assemblyName}])}},"(single row)"))}))):null}function z(e){const{model:a,tag:o,feature:c}=e,m=p.getSession(a),{pluginManager:l}=p.getEnv(m);let i;try{i=l.getViewType("BreakpointSplitView")}catch{}return s.createElement(D,{...e,title:"Supplementary alignments"},s.createElement(B,{model:a,tag:o}),i?s.createElement(P,{viewType:i,model:a,feature:c}):null)}export{z as default};
//# sourceMappingURL=SupplementaryAlignments-YwRzpgYj.js.map
