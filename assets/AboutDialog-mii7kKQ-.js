import{b9 as D,z as R,a as i,u as E,l as f,R as t,c as C,m as x,o as y,a7 as N,D as O,B as A,b6 as v,ba as P}from"./index-ClFcCqS6.js";import{D as j}from"./Dialog-BSaZ5E8l.js";import{B as S}from"./BaseCard-C_gvKKba.js";var I=D();const k=R(I);function U({config:e}){const[s,a]=i.useState(),[o,r]=i.useState(),c=E.getSession(e),{rpcManager:p}=c;i.useEffect(()=>{(async()=>{try{const l=f.readConfObject(e,"adapter"),u=await p.call(e.trackId,"CoreGetInfo",{adapterConfig:l});r(u)}catch(l){console.error(l),a(l)}})()},[e,p]);const d=typeof o=="string"?{header:`<pre>${o.replaceAll("<","&lt;").replaceAll(">","&gt;")}</pre>`}:o||{};return t.createElement(S,{title:"File info"},s?t.createElement(C.ErrorMessage,{error:s}):o===void 0?t.createElement(C.LoadingEllipses,{message:"Loading file data"}):t.createElement(k,{attributes:d}))}const h=1e4,F=x()(e=>({container:{minWidth:800},refNames:{maxHeight:300,overflow:"auto",flexGrow:1,background:e.palette.background.default}})),$=y(function({config:e,onClose:s}){const{classes:a}=F(),[o,r]=i.useState(),[c,p]=i.useState(),[d,l]=i.useState(!1),{rpcManager:u}=E.getSession(e);i.useEffect(()=>{(async()=>{try{const n=await Promise.all([...new Set(N.getConfAssemblyNames(e))].map(async m=>{const M=f.readConfObject(e,"adapter");return[m,await u.call(e.trackId,"CoreGetRefNames",{adapterConfig:M,regions:[{assemblyName:m}]})]}));p(Object.fromEntries(n))}catch(n){console.error(n),r(n)}})()},[e,u]);const b=c?Object.entries(c):[],g=b.flatMap(([n,m])=>[`--- ${n} ---`,...m.slice(0,h),m.length>h?`
Too many refNames to show in browser for ${n}, use "Copy ref names" button to copy to clipboard`:""]).filter(n=>!!n).join(`
`);return t.createElement(C.Dialog,{open:!0,title:"Reference sequence names used in track",onClose:s,maxWidth:"xl"},t.createElement(O,{className:a.container},o?t.createElement(C.ErrorMessage,{error:o}):c===void 0?t.createElement(C.LoadingEllipses,{message:"Loading refNames"}):t.createElement(t.Fragment,null,t.createElement(A,{variant:"contained",onClick:()=>{v(b.flatMap(([n,m])=>[`--- ${n} ---`,...m]).filter(n=>!!n).join(`
`)),l(!0),setTimeout(()=>{l(!1)},1e3)}},d?"Copied to clipboard!":"Copy ref names"),t.createElement("pre",{className:a.refNames},g))))}),B=x()({content:{minWidth:800},button:{float:"right"}});function w(e,s){for(const a in e)a===s?delete e[a]:typeof e[a]=="object"&&w(e[a],s);return e}const L=y(function({config:e}){const[s,a]=i.useState(!1),o=f.readConfObject(e),r=E.getSession(e),{classes:c}=B(),[p,d]=i.useState(!1),l=f.getConf(r,["formatAbout","hideUris"])||f.readConfObject(e,["formatAbout","hideUris"]),{pluginManager:u}=E.getEnv(r),b=u.evaluateExtensionPoint("Core-customizeAbout",{config:{...o,...f.getConf(r,["formatAbout","config"],{config:o}),...f.readConfObject(e,["formatAbout","config"],{config:o})}},{session:r,config:e}),g=u.evaluateExtensionPoint("Core-extraAboutPanel",null,{session:r,config:e});return t.createElement("div",{className:c.content},t.createElement(S,{title:"Configuration"},l?null:t.createElement("span",{className:c.button},t.createElement(A,{variant:"contained",color:"secondary",onClick:()=>{d(!0)}},"Show ref names"),t.createElement(A,{variant:"contained",onClick:()=>{const n=w(P(o),"baseUri");v(JSON.stringify(n,null,2)),a(!0),setTimeout(()=>{a(!1)},1e3)}},s?"Copied to clipboard!":"Copy config")),t.createElement(k,{attributes:b,omit:["displays","baseUri","refNames","formatAbout"],hideUris:l})),g?t.createElement(S,{title:g.name},t.createElement(g.Component,{config:e})):null,t.createElement(U,{config:e}),p?t.createElement($,{config:e,onClose:()=>{d(!1)}}):null)});function q({config:e,handleClose:s}){const a=E.getSession(e),o=N.getTrackName(e,a),{pluginManager:r}=E.getEnv(a),c=r.evaluateExtensionPoint("Core-replaceAbout",L,{session:a,config:e});return t.createElement(j,{open:!0,onClose:s,title:o,maxWidth:"xl"},t.createElement(c,{config:e}))}export{q as default};
//# sourceMappingURL=AboutDialog-mii7kKQ-.js.map
