import{R as s,p as w,b0 as L,N as h,u as p,aj as $,b1 as k,Q as A,b2 as C,r as E,b as R}from"./rpcWorker-CJ7cIcjW.js";import{B}from"./FeatureDetails-BbTCO9hC.js";import{n as D}from"./AlignmentsFeatureDetail-v436NKu_.js";function M({tag:e,model:a}){return s.createElement("div",null,s.createElement(w,null,"List of supplementary alignment locations"),s.createElement("ul",null,e.split(";").filter(l=>!!l).map((l,c)=>{const[m,o,i,u]=l.split(","),g=L(u),y=Math.floor(g/5),t=+o,f=+o+g,n=t-y,r=f+y,S=`${m}:${Math.max(1,n)}-${r}`,d=t.toLocaleString("en-US"),v=f.toLocaleString("en-US"),N=`${m}:${d}-${v} (${i}) [${g}bp]`;return s.createElement("li",{key:`${S}-${c}`},s.createElement(h,{href:"#",onClick:async b=>{b.preventDefault(),D(S,a)}},N))})))}async function F({view:e,feature:a}){const{assemblyManager:l}=p.getSession(e),c=a.get("CIGAR"),m=a.get("strand"),o=$(a,"SA")||"",i=a.get("name"),u=k(c,1),g=await l.waitForAssembly(e.assemblyNames[0]);if(!g)throw new Error("assembly not found");const y=A(o,a.id(),m,i,!0),t=a.toJSON();t.clipPos=u,t.strand=1,t.mate={refName:i,start:u,end:u+C(c)};const f=[t,...y];return f.forEach((n,r)=>{n.refName=g.getCanonicalRefName(n.refName)||n.refName,n.syntenyId=r,n.mate.syntenyId=r,n.mate.uniqueId=`${n.uniqueId}_mate`}),f.sort((n,r)=>n.clipPos-r.clipPos),f}const I=E.lazy(()=>import("./BreakendSingleLevelOptionDialog-Drnl-fK9.js").then(function(e){return e.B})),O=E.lazy(()=>import("./BreakendSingleLevelOptionDialog-Drnl-fK9.js").then(function(e){return e.a}));function P({model:e,feature:a,viewType:l}){const c=p.getSession(e),{view:m}=e,[o,i]=E.useState(),[u,g]=E.useState();E.useEffect(()=>{(async()=>{try{const t=await F({view:m,feature:new p.SimpleFeature(a)});i(t)}catch(t){g(t),console.error(t)}})()},[a,m]);const y=[];if(o)for(let t=0;t<o.length-1;t++)y.push([o[t],o[t+1]]);return y.length?s.createElement("div",null,s.createElement(w,null,"Launch split view"),u?s.createElement(R.ErrorMessage,{error:u}):null,s.createElement("ul",null,y.map((t,f)=>{const[n,r]=t;return s.createElement("li",{key:`${JSON.stringify(t)}-${f}`},n.refName,":",p.toLocale(n.strand===1?n.end:n.start)," ->"," ",r.refName,":",p.toLocale(r.strand===1?r.start:r.end)," ",s.createElement(h,{href:"#",onClick:S=>{S.preventDefault(),c.queueDialog(d=>[I,{handleClose:d,model:e,feature:new p.SimpleFeature({...n,mate:r}),viewType:l,view:e.view,assemblyName:e.view.displayedRegions[0].assemblyName}])}},"(top/bottom)")," ",s.createElement(h,{href:"#",onClick:S=>{S.preventDefault(),c.queueDialog(d=>[O,{handleClose:d,model:e,feature:new p.SimpleFeature({...n,mate:r}),viewType:l,view:e.view,assemblyName:e.view.displayedRegions[0].assemblyName}])}},"(single row)"))}))):null}function z(e){const{model:a,tag:l,feature:c}=e,m=p.getSession(a),{pluginManager:o}=p.getEnv(m);let i;try{i=o.getViewType("BreakpointSplitView")}catch{}return s.createElement(B,{...e,title:"Supplementary alignments"},s.createElement(M,{model:a,tag:l}),i?s.createElement(P,{viewType:i,model:a,feature:c}):null)}export{z as default};
//# sourceMappingURL=SupplementaryAlignments-CfqNRYHo.js.map
